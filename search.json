[{"title":"SOLID","url":"/2025/06/26/Csharp-Solid/","content":"<p>å›é¡§æ•´ç†è¤‡ç¿’ä¸€ä¸‹åŸºæœ¬è§€å¿µ</p>\n<h2 id=\"ğŸŒŸ-SOLID-æ˜¯ä»€éº¼ï¼Ÿ\">ğŸŒŸ SOLID æ˜¯ä»€éº¼ï¼Ÿ</h2>\n<p>SOLID æ˜¯ç‰©ä»¶å°å‘è¨­è¨ˆçš„äº”å¤§åŸå‰‡ï¼Œæœ‰åŠ©æ–¼æé«˜ç³»çµ±çš„å¯è®€æ€§ã€å¯ç¶­è­·æ€§èˆ‡æ“´å……æ€§ã€‚</p>\n<p>S â€“ Single Responsibility Principle<br>\nO â€“ Open/Closed Principle<br>\nL â€“ Liskov Substitution Principle<br>\nI â€“ Interface Segregation Principle<br>\nD â€“ Dependency Inversion Principle</p>\n<h2 id=\"ğŸ§±-å–®ä¸€è·è²¬åŸå‰‡ï¼ˆSRPï¼‰\">ğŸ§± å–®ä¸€è·è²¬åŸå‰‡ï¼ˆSRPï¼‰</h2>\n<p>å®šç¾© : ä¸€å€‹æ¨¡çµ„æ‡‰æœ‰ä¸”åªæœ‰ä¸€å€‹ç†ç”±æœƒä½¿å…¶æ”¹è®Šã€‚ä¸€å€‹é¡åˆ¥åªè² è²¬ä¸€å€‹è·è²¬(åŠŸèƒ½)ã€‚<br>\nç›®çš„ : è®“é¡åˆ¥æ›´å°ˆæ³¨åŒ–ã€æ¨¡çµ„åŒ–ï¼Œä¾¿æ–¼ç¶­è­·èˆ‡æ¸¬è©¦<br>\nç¯„ä¾‹ :</p>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// âŒ éŒ¯èª¤ç¤ºç¯„ï¼šReport åŒæ™‚è² è²¬ç”¢ç”Ÿå ±å‘Šèˆ‡å„²å­˜å ±å‘Š</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Report</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Generate</span>()</span> &#123;\n        <span class=\"comment\">// ç”¢ç”Ÿå ±å‘Šé‚è¼¯</span>\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SaveToFile</span>()</span> &#123;\n        <span class=\"comment\">// å„²å­˜å ±å‘Šåˆ°æª”æ¡ˆçš„é‚è¼¯</span>\n    &#125;\n&#125;\n\n<span class=\"comment\">// âœ… æ­£ç¢ºç¤ºç¯„ï¼šæ‹†åˆ†è²¬ä»»ï¼Œè®“æ¯å€‹é¡åˆ¥åªè™•ç†ä¸€ä»¶äº‹</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ReportGenerator</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> Report <span class=\"title\">Generate</span>()</span> &#123;\n        <span class=\"comment\">// åªè² è²¬ç”¢ç”Ÿå ±å‘Š</span>\n        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Report();\n    &#125;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ReportSaver</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SaveToFile</span>(<span class=\"params\">Report report</span>)</span> &#123;\n        <span class=\"comment\">// åªè² è²¬å„²å­˜å ±å‘Š</span>\n    &#125;\n&#125;\n</code></pre>\n<blockquote>\n<p>æ³¨æ„ä¸è¦ç‚ºäº†æ‹†åˆ†è€Œæ‹†åˆ† =&gt; éåº¦æ‹†åˆ†åè€Œé€ æˆç¶­è­·å›°é›£ã€çµæ§‹éç¢ã€å¢åŠ é–‹ç™¼è² æ“”ã€‚</p>\n</blockquote>\n<h2 id=\"ğŸ”“-é–‹æ”¾å°é–‰åŸå‰‡ï¼ˆOCPï¼‰\">ğŸ”“ é–‹æ”¾å°é–‰åŸå‰‡ï¼ˆOCPï¼‰</h2>\n<p>å®šç¾© : ä¸€å€‹è»Ÿé«”è£½å“æ‡‰è©²å°æ–¼æ“´å±•æ˜¯é–‹æ”¾çš„ï¼Œä½†å°æ–¼ä¿®æ”¹æ˜¯å°é–‰çš„<br>\nç›®çš„ : ç•¶éœ€æ±‚è®Šæ›´æ™‚ï¼Œä¸ç”¨ä¿®æ”¹åŸæœ‰çš„ä»£ç¢¼ï¼Œåªéœ€æ“´å±•å³å¯<br>\nç¯„ä¾‹ : ç­–ç•¥æ¨¡å¼</p>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// å®šç¾©ä¸€å€‹æŠ½è±¡çš„æŠ˜æ‰£ç­–ç•¥ä»‹é¢</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IDiscountStrategy</span> &#123;\n    <span class=\"function\"><span class=\"built_in\">decimal</span> <span class=\"title\">GetDiscount</span>(<span class=\"params\"><span class=\"built_in\">decimal</span> price</span>)</span>;\n&#125;\n\n<span class=\"comment\">// æ²’æœ‰æŠ˜æ‰£çš„ç­–ç•¥</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">NoDiscount</span> : <span class=\"title\">IDiscountStrategy</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">decimal</span> <span class=\"title\">GetDiscount</span>(<span class=\"params\"><span class=\"built_in\">decimal</span> price</span>)</span> =&gt; price;\n&#125;\n\n<span class=\"comment\">// å­£ç¯€æ€§æŠ˜æ‰£ç­–ç•¥</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SeasonalDiscount</span> : <span class=\"title\">IDiscountStrategy</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">decimal</span> <span class=\"title\">GetDiscount</span>(<span class=\"params\"><span class=\"built_in\">decimal</span> price</span>)</span> =&gt; price * <span class=\"number\">0.9</span>m;\n&#125;\n\n<span class=\"comment\">// çµå¸³é¡åˆ¥ä¾è³´æŠ½è±¡æŠ˜æ‰£ç­–ç•¥</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Checkout</span> &#123;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IDiscountStrategy _discountStrategy;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Checkout</span>(<span class=\"params\">IDiscountStrategy discountStrategy</span>)</span> &#123;\n        _discountStrategy = discountStrategy;\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">decimal</span> <span class=\"title\">GetFinalPrice</span>(<span class=\"params\"><span class=\"built_in\">decimal</span> price</span>)</span> &#123;\n        <span class=\"keyword\">return</span> _discountStrategy.GetDiscount(price);\n    &#125;\n&#125;</code></pre>\n<p>è‹¥éœ€æ–°å¢å…¶ä»–æŠ˜æ‰£é‚è¼¯ï¼Œå¦‚æœƒå“¡æŠ˜æ‰£ï¼Œåªéœ€æ–°å¢ä¸€å€‹æ–°é¡åˆ¥å¯¦ä½œ <code>IDiscountStrategy</code>ï¼Œç„¡é ˆä¿®æ”¹ <code>Checkout</code> é¡åˆ¥ï¼Œç¬¦åˆ OCPã€‚</p>\n<h2 id=\"ğŸ§¬-é‡Œæ°æ›¿æ›åŸå‰‡ï¼ˆLSPï¼‰\">ğŸ§¬ é‡Œæ°æ›¿æ›åŸå‰‡ï¼ˆLSPï¼‰</h2>\n<p>å®šç¾© : å­é¡åˆ¥æ‡‰è©²èƒ½æ›¿æ›å…¶çˆ¶é¡åˆ¥ï¼Œä¸”ä¸å½±éŸ¿åŸæœ‰ç¨‹å¼çš„æ­£ç¢ºæ€§<br>\nç›®çš„ : ç¢ºä¿ç¹¼æ‰¿çš„åˆç†æ€§ï¼Œé¿å…é•åå¤šå‹åŸå‰‡<br>\nç¯„ä¾‹ :</p>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// åŸºç¤é¡åˆ¥</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Bird</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">virtual</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span>()</span> &#123; &#125;\n&#125;\n\n<span class=\"comment\">// è€é·¹å¯ä»¥é£›</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Eagle</span> : <span class=\"title\">Bird</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span>()</span> &#123; <span class=\"comment\">/* é£›è¡Œé‚è¼¯ */</span> &#125;\n&#125;\n\n<span class=\"comment\">// âŒ é´•é³¥ä¸èƒ½é£›ï¼Œå»ç¹¼æ‰¿ Birdï¼Œé•å LSP</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Ostrich</span> : <span class=\"title\">Bird</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span>()</span> &#123;\n        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NotSupportedException();\n    &#125;\n&#125;</code></pre>\n<p>ğŸ”§ è§£æ³•ï¼šå¯æ”¹ç‚ºå°‡ã€Œå¯é£›çš„é³¥ã€èˆ‡ã€Œä¸å¯é£›çš„é³¥ã€æŠ½è±¡åˆ†é–‹ã€‚</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">class</span> <span class=\"title\">Bird</span> &#123; &#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IFlyable</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Fly</span>()</span>;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Eagle</span> : <span class=\"title\">Bird</span>, <span class=\"title\">IFlyable</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span>()</span> &#123;\n        Console.WriteLine(<span class=\"string\">&quot;Eagle flies.&quot;</span>);\n    &#125;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Ostrich</span> : <span class=\"title\">Bird</span> &#123;\n    <span class=\"comment\">// æ²’æœ‰ Fly æ–¹æ³•ï¼Œç¬¦åˆå¯¦éš›è¡Œç‚º</span>\n&#125;\n</code></pre>\n<h2 id=\"ğŸ§©-ä»‹é¢åˆ†é›¢åŸå‰‡ï¼ˆISPï¼‰\">ğŸ§© ä»‹é¢åˆ†é›¢åŸå‰‡ï¼ˆISPï¼‰</h2>\n<p>å®šç¾© : ä¸è¦å¼·è¿«å®¢æˆ¶ç«¯ä¾è³´ä»–å€‘ä¸ä½¿ç”¨çš„ä»‹é¢ã€‚æ‡‰å°‡å¤§ä»‹é¢æ‹†åˆ†æˆå¤šå€‹å°è€Œå°ˆä¸€çš„ä»‹é¢ã€‚<br>\nç›®çš„ : æé«˜ç³»çµ±å½ˆæ€§ï¼Œé¿å…è‡ƒè…«çš„ä»‹é¢å½±éŸ¿ä½¿ç”¨ã€‚<br>\nç¯„ä¾‹ :</p>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// âŒ ä¸å¥½çš„è¨­è¨ˆï¼šä»‹é¢å¤ªå¤§</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IMachine</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Print</span>()</span>;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Scan</span>()</span>;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Fax</span>()</span>;\n&#125;\n\n<span class=\"comment\">// æœ‰äº›é¡åˆ¥åªéœ€è¦éƒ¨åˆ†åŠŸèƒ½</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SimplePrinter</span> : <span class=\"title\">IMachine</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Print</span>()</span> &#123; <span class=\"comment\">/* å¯¦ä½œ */</span> &#125;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Scan</span>()</span> &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NotImplementedException(); &#125; <span class=\"comment\">// ä¸éœ€è¦</span>\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Fax</span>()</span> &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NotImplementedException(); &#125;  <span class=\"comment\">// ä¸éœ€è¦</span>\n&#125;</code></pre>\n<p>âœ… æ”¹å–„æ–¹å¼ï¼šæ‹†åˆ†ç‚ºå°å‹ä»‹é¢</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IPrinter</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Print</span>()</span>;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IScanner</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Scan</span>()</span>;\n&#125;\n\n<span class=\"comment\">// ç°¡å–®å°è¡¨æ©Ÿåªå¯¦ä½œå°è¡¨åŠŸèƒ½</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SimplePrinter</span> : <span class=\"title\">IPrinter</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Print</span>()</span> &#123;\n        Console.WriteLine(<span class=\"string\">&quot;Printing...&quot;</span>);\n    &#125;\n&#125;\n\n<span class=\"comment\">// å¤šåŠŸèƒ½å°è¡¨æ©Ÿå¯ä»¥å¯¦ä½œå¤šå€‹ä»‹é¢</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">MultiFunctionMachine</span> : <span class=\"title\">IPrinter</span>, <span class=\"title\">IScanner</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Print</span>()</span> &#123; <span class=\"comment\">/*...*/</span> &#125;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Scan</span>()</span> &#123; <span class=\"comment\">/*...*/</span> &#125;\n&#125;\n</code></pre>\n<h2 id=\"ğŸ§²-ä¾è³´åè½‰åŸå‰‡ï¼ˆDIPï¼‰\">ğŸ§² ä¾è³´åè½‰åŸå‰‡ï¼ˆDIPï¼‰</h2>\n<p>å®šç¾© : 1. é«˜å±¤æ¨¡çµ„ä¸æ‡‰è©²ä¾è³´ä½å±¤æ¨¡çµ„ï¼Œå…©è€…éƒ½æ‡‰è©²ä¾è³´æŠ½è±¡ 2. æŠ½è±¡ä¸æ‡‰ä¾è³´ç´°ç¯€ï¼Œç´°ç¯€æ‡‰ä¾è³´æŠ½è±¡ã€‚<br>\nç›®çš„ : æ¸›å°‘æ¨¡çµ„ä¹‹é–“çš„è€¦åˆï¼Œæé«˜å¯é‡ç”¨æ€§èˆ‡å¯æ¸¬è©¦æ€§ã€‚<br>\nç¯„ä¾‹ : DI</p>\n<pre><code class=\"highlight C#\">\n<span class=\"comment\">// å®šç¾©ä¸€å€‹è¨Šæ¯å‚³é€çš„æŠ½è±¡</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IMessageSender</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Send</span>(<span class=\"params\"><span class=\"built_in\">string</span> message</span>)</span>;\n&#125;\n\n<span class=\"comment\">// å¯¦ä½œç´°ç¯€ï¼šEmail ç™¼é€</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">EmailSender</span> : <span class=\"title\">IMessageSender</span> &#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Send</span>(<span class=\"params\"><span class=\"built_in\">string</span> message</span>)</span> &#123;\n        Console.WriteLine(<span class=\"string\">&quot;Email sent: &quot;</span> + message);\n    &#125;\n&#125;\n\n<span class=\"comment\">// é«˜å±¤æ¨¡çµ„ä¾è³´æŠ½è±¡ï¼Œè€Œé EmailSender</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Notification</span> &#123;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IMessageSender _messageSender;\n\n    <span class=\"comment\">// å‚³å…¥æŠ½è±¡ä»‹é¢ï¼Œå¯¦ç¾æ³¨å…¥ï¼ˆä¾è³´åè½‰ï¼‰</span>\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Notification</span>(<span class=\"params\">IMessageSender messageSender</span>)</span> &#123;\n        _messageSender = messageSender;\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Notify</span>(<span class=\"params\"><span class=\"built_in\">string</span> message</span>)</span> &#123;\n        _messageSender.Send(message);\n    &#125;\n&#125;\n</code></pre>\n<p>ä½¿ç”¨å¦‚ IoC Container (ä¾‹å¦‚ <code>Microsoft.Extensions.DependencyInjection</code>) å¯ä»¥è‡ªå‹•æ³¨å…¥ IMessageSender çš„å¯¦ä½œã€‚</p>\n<h2 id=\"ğŸ“š-åƒè€ƒ\">ğŸ“š åƒè€ƒ</h2>\n<p><a href=\"https://medium.com/%E7%A8%8B%E5%BC%8F%E6%84%9B%E5%A5%BD%E8%80%85/%E4%BD%BF%E4%BA%BA%E7%98%8B%E7%8B%82%E7%9A%84-solid-%E5%8E%9F%E5%89%87-%E7%9B%AE%E9%8C%84-b33fdfc983ca\">ä½¿äººç˜‹ç‹‚çš„ SOLID åŸå‰‡</a></p>\n","categories":["å¾Œç«¯"],"tags":["C#"]},{"title":"è®“ASP.NET Coreæœå‹™è¨»å†Šæ›´å„ªé›…","url":"/2025/05/13/IServiceCollection/","content":"<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>éš¨è‘—æ‡‰ç”¨ç¨‹å¼è®Šå¾—è¶Šä¾†è¶Šé¾å¤§ï¼Œéœ€è¦è¨»å†Šçš„æœå‹™ä¹Ÿéš¨ä¹‹å¢åŠ ï¼Œ<code>Program.cs</code> ä¸­çš„ <code>builder.Services</code> å€å¡Šå¯èƒ½æœƒè®Šå¾—å†—é•·ä¸”é›£ä»¥ç¶­è­·ã€‚<br>\né€™æ™‚å€™ï¼Œ<code>IServiceCollection</code> çš„æ“´å……æ–¹æ³•ä¾¿èƒ½æ´¾ä¸Šç”¨å ´ï¼Œå¹«åŠ©æˆ‘å€‘æ•´ç†ç¨‹å¼ç¢¼ï¼Œä½¿å…¶æ›´åŠ æ¸…æ™°å’Œæ˜“æ–¼ç®¡ç†ã€‚</p>\n<blockquote>\n<p>æœ¬æ–‡ç¯„ä¾‹åŸºæ–¼ .NET 6 æˆ–æ›´æ–°ç‰ˆæœ¬ï¼ˆå¦‚ .NET 8ï¼‰</p>\n</blockquote>\n<h2 id=\"ä»€éº¼æ˜¯-IServiceCollection-æ“´å……æ–¹æ³•ï¼Ÿ\">ä»€éº¼æ˜¯ IServiceCollection æ“´å……æ–¹æ³•ï¼Ÿ</h2>\n<p>ç°¡å–®ä¾†èªªï¼Œæ“´å……æ–¹æ³•å…è¨±æˆ‘å€‘å‘ç¾æœ‰çš„å‹åˆ¥(<code>IServiceCollection</code>ä»‹é¢)æ·»åŠ æ–°çš„æ–¹æ³•ï¼Œè€Œç„¡éœ€ä¿®æ”¹åŸå§‹å‹åˆ¥çš„ç¨‹å¼ç¢¼ã€‚<br>\né€™æ˜¯ä¸€å€‹å¼·å¤§çš„ C#èªè¨€ç‰¹æ€§ï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘ç·¨å¯«æ›´å…·è¡¨é”åŠ›å’Œå¯é‡ç”¨çš„ç¨‹å¼ç¢¼ã€‚</p>\n<h2 id=\"ç‚ºä»€éº¼è¦ä½¿ç”¨-IServiceCollection-æ“´å……æ–¹æ³•ï¼Ÿ\">ç‚ºä»€éº¼è¦ä½¿ç”¨ IServiceCollection æ“´å……æ–¹æ³•ï¼Ÿ</h2>\n<p>ä½¿ç”¨<code>IServiceCollection</code>æ“´å……æ–¹æ³•å¸¶ä¾†äº†è«¸å¤šå¥½è™•</p>\n<ul>\n<li><strong>æå‡å¯è®€æ€§</strong>ï¼šå°‡ç‰¹å®šåŠŸèƒ½çš„æœå‹™è¨»å†Šé‚è¼¯å°è£åœ¨æ“´å……æ–¹æ³•ä¸­ï¼Œå¯ä½¿ <code>Program.cs</code> æ›´åŠ ç°¡æ½”ï¼Œä¸€çœ¼çœ‹å‡ºæ‡‰ç”¨ç¨‹å¼çš„æ ¸å¿ƒæœå‹™ã€‚</li>\n<li><strong>å¢åŠ å¯é‡ç”¨æ€§</strong>ï¼šè‹¥å¤šå€‹å°ˆæ¡ˆæˆ–æ¨¡çµ„éœ€è¨»å†Šç›¸åŒçš„æœå‹™é›†åˆï¼Œå¯å°‡é‚è¼¯æå–æˆæ“´å……æ–¹æ³•ï¼Œä¾¿æ–¼é‡è¤‡ä½¿ç”¨ã€‚</li>\n<li><strong>æ›´å¥½çš„çµ„ç¹”çµæ§‹</strong>ï¼šå¯ä¾ç…§æ¨¡çµ„æˆ–é¡å‹ï¼Œå°‡è¨»å†Šé‚è¼¯çµ„ç¹”åˆ°ä¸åŒæ“´å……é¡åˆ¥ä¸­ã€‚</li>\n<li><strong>ç°¡åŒ–è¤‡é›œçš„è¨»å†Šé‚è¼¯</strong>ï¼šå°è£éœ€é¡å¤–é…ç½®æˆ–æ¢ä»¶è¨»å†Šçš„æœå‹™ï¼Œè®“ä¸»è¦è¨»å†Šå€å¡Šæ›´ä¹¾æ·¨ã€‚</li>\n</ul>\n<h2 id=\"å¦‚ä½•å»ºç«‹å’Œä½¿ç”¨-IServiceCollection-æ“´å……æ–¹æ³•ï¼Ÿ\">å¦‚ä½•å»ºç«‹å’Œä½¿ç”¨ IServiceCollection æ“´å……æ–¹æ³•ï¼Ÿ</h2>\n<p>å»ºç«‹æ“´å……æ–¹æ³•å¾ˆç°¡å–®ï¼Œåªéœ€å®šç¾©ä¸€å€‹éœæ…‹é¡åˆ¥ï¼Œä¸¦æ’°å¯«éœæ…‹æ–¹æ³•ï¼Œç¬¬ä¸€å€‹åƒæ•¸ç”¨ <code>this</code> ä¿®é£¾ <code>IServiceCollection</code>ã€‚</p>\n<h3 id=\"1ï¸âƒ£-è¨»å†Šè‡ªå®šç¾©æœå‹™\">1ï¸âƒ£ è¨»å†Šè‡ªå®šç¾©æœå‹™</h3>\n<p>å‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹ <code>MyAwesomeService</code> å¯¦ä½œ <code>IMyAwesomeService</code>ï¼Œæˆ‘å€‘å¸Œæœ›è¨»å†Šç‚ºå–®ä¾‹ï¼š</p>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// Extensions/ServiceCollectionExtensions.cs</span>\n<span class=\"keyword\">using</span> Microsoft.Extensions.DependencyInjection;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title\">ServiceCollectionExtensions</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceCollection <span class=\"title\">AddMyAwesomeService</span>(<span class=\"params\"><span class=\"keyword\">this</span> IServiceCollection services</span>)</span>\n    &#123;\n        <span class=\"keyword\">return</span> services.AddSingleton&lt;IMyAwesomeService, MyAwesomeService&gt;();\n    &#125;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IMyAwesomeService</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">DoSomethingAwesome</span>()</span>;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">MyAwesomeService</span> : <span class=\"title\">IMyAwesomeService</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">DoSomethingAwesome</span>()</span>\n    &#123;\n        Console.WriteLine(<span class=\"string\">&quot;åŸ·è¡Œä¸€äº›å¾ˆæ£’çš„æ“ä½œï¼&quot;</span>);\n    &#125;\n&#125;\n</code></pre>\n<p>ç„¶å¾Œåœ¨ <code>Program.cs</code> ä¸­ä½¿ç”¨</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">var</span> builder = WebApplication.CreateBuilder(args);\n\nbuilder.Services.AddMyAwesomeService();\n<span class=\"comment\">// å…¶ä»–æœå‹™è¨»å†Š...</span>\n\n<span class=\"keyword\">var</span> app = builder.Build();\napp.Run();</code></pre>\n<h3 id=\"2ï¸âƒ£-è¨»å†Šå¤šå€‹ç›¸é—œæœå‹™\">2ï¸âƒ£ è¨»å†Šå¤šå€‹ç›¸é—œæœå‹™</h3>\n<p>æˆ‘å€‘å¯ä»¥ä¸€æ¬¡è¨»å†Šä¸€çµ„è³‡æ–™å­˜å–æœå‹™ï¼š</p>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// Extensions/DataAccessServiceExtensions.cs</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title\">DataAccessServiceExtensions</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceCollection <span class=\"title\">AddDataAccessServices</span>(<span class=\"params\"><span class=\"keyword\">this</span> IServiceCollection services, <span class=\"built_in\">string</span> connectionString</span>)</span>\n    &#123;\n        services.AddScoped&lt;IDataContext&gt;(provider =&gt; <span class=\"keyword\">new</span> DataContext(connectionString));\n        services.AddScoped&lt;IUserRepository, UserRepository&gt;();\n        services.AddScoped&lt;IProductRepository, ProductRepository&gt;();\n        <span class=\"keyword\">return</span> services;\n    &#125;\n&#125;</code></pre>\n<p>åœ¨ <code>Program.cs</code> ä¸­ä½¿ç”¨ï¼š</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">var</span> builder = WebApplication.CreateBuilder(args);\n<span class=\"keyword\">var</span> connectionString = builder.Configuration.GetConnectionString(<span class=\"string\">&quot;DefaultConnection&quot;</span>);\n\nbuilder.Services.AddDataAccessServices(connectionString);\n\n<span class=\"keyword\">var</span> app = builder.Build();\napp.Run();\n</code></pre>\n<h3 id=\"3ï¸âƒ£-æ ¹æ“šç’°å¢ƒè¨»å†Šä¸åŒçš„æœå‹™\">3ï¸âƒ£ æ ¹æ“šç’°å¢ƒè¨»å†Šä¸åŒçš„æœå‹™</h3>\n<p>æ ¹æ“šé–‹ç™¼æˆ–ç”Ÿç”¢ç’°å¢ƒè¨»å†Šä¸åŒçš„å¯¦ä½œé¡åˆ¥ï¼š</p>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// Extensions/EnvironmentSpecificServiceExtensions.cs</span>\n<span class=\"keyword\">using</span> Microsoft.Extensions.Hosting;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title\">EnvironmentSpecificServiceExtensions</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceCollection <span class=\"title\">AddEnvironmentSpecificServices</span>(<span class=\"params\"><span class=\"keyword\">this</span> IServiceCollection services, IHostEnvironment environment</span>)</span>\n    &#123;\n        <span class=\"keyword\">if</span> (environment.IsDevelopment())\n        &#123;\n            services.AddTransient&lt;IEmailService, DevelopmentEmailService&gt;();\n        &#125;\n        <span class=\"keyword\">else</span>\n        &#123;\n            services.AddTransient&lt;IEmailService, ProductionEmailService&gt;();\n        &#125;\n        <span class=\"keyword\">return</span> services;\n    &#125;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IEmailService</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">SendEmail</span>(<span class=\"params\"><span class=\"built_in\">string</span> to, <span class=\"built_in\">string</span> subject, <span class=\"built_in\">string</span> body</span>)</span>;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">DevelopmentEmailService</span> : <span class=\"title\">IEmailService</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SendEmail</span>(<span class=\"params\"><span class=\"built_in\">string</span> to, <span class=\"built_in\">string</span> subject, <span class=\"built_in\">string</span> body</span>)</span>\n    &#123;\n        Console.WriteLine(<span class=\"string\">$&quot;[é–‹ç™¼ç’°å¢ƒ] ç™¼é€éƒµä»¶è‡³ <span class=\"subst\">&#123;to&#125;</span>ï¼Œæ¨™é¡Œï¼š<span class=\"subst\">&#123;subject&#125;</span>&quot;</span>);\n    &#125;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">ProductionEmailService</span> : <span class=\"title\">IEmailService</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">SendEmail</span>(<span class=\"params\"><span class=\"built_in\">string</span> to, <span class=\"built_in\">string</span> subject, <span class=\"built_in\">string</span> body</span>)</span>\n    &#123;\n        Console.WriteLine(<span class=\"string\">$&quot;[ç”Ÿç”¢ç’°å¢ƒ] æ­£åœ¨ç™¼é€éƒµä»¶è‡³ <span class=\"subst\">&#123;to&#125;</span>ï¼Œæ¨™é¡Œï¼š<span class=\"subst\">&#123;subject&#125;</span>...&quot;</span>);\n        <span class=\"comment\">// çœŸæ­£çš„ç™¼é€ç¨‹å¼ç¢¼</span>\n    &#125;\n&#125;</code></pre>\n<p>åœ¨ <code>Program.cs</code> ä¸­ä½¿ç”¨ï¼š</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">var</span> builder = WebApplication.CreateBuilder(args);\n\nbuilder.Services.AddEnvironmentSpecificServices(builder.Environment);\n\n<span class=\"keyword\">var</span> app = builder.Build();\napp.Run();</code></pre>\n<h2 id=\"çµèª\">çµèª</h2>\n<p><code>IServiceCollection</code> æ“´å……æ–¹æ³•æ˜¯ä¸€å€‹å¼·å¤§ä¸”å¯¦ç”¨çš„å·¥å…·ï¼Œèƒ½å¹«åŠ©æˆ‘å€‘æ›´å¥½åœ°çµ„ç¹”èˆ‡ç®¡ç† <a href=\"http://ASP.NET\">ASP.NET</a> Core ä¸­çš„æœå‹™è¨»å†Šé‚è¼¯ã€‚<br>\né€éå°è£æœå‹™è¨»å†Šè‡³æ“´å……æ–¹æ³•ï¼Œå¯è®“ <code>Program.cs</code> æ›´åŠ æ¸…æ™°ã€æ¨¡çµ„åŒ–ï¼Œä¸¦æå‡å¯ç¶­è­·æ€§èˆ‡é‡ç”¨æ€§ã€‚</p>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://learn.microsoft.com/zh-tw/dotnet/api/microsoft.extensions.dependencyinjection.iservicecollection?view=net-8.0\">IServiceCollection ä»‹é¢ (Microsoft Learn)</a></li>\n<li><a href=\"https://learn.microsoft.com/zh-tw/aspnet/core/fundamentals/?view=aspnetcore-8.0&amp;tabs=windows\">.NET Hosting æ¨¡å‹è®Šæ›´</a></li>\n<li><a href=\"https://gemini.google.com/app\">Gemini</a></li>\n<li><a href=\"https://chatgpt.com/?model=auto\">ChatGpt</a></li>\n</ul>\n","categories":["å¾Œç«¯"],"tags":["C#"]},{"title":"CryptoJS å‰ç«¯åŠ å¯†å·¥å…·ç­†è¨˜","url":"/2025/08/01/cryptojs/","content":"<p>ç°¡å–®è¨˜éŒ„ä¸€ä¸‹å‰ç«¯åŠ å¯†å¯¦ç”¨çš„å·¥å…· <strong>CryptoJS</strong>ã€‚<br>\né€™æ˜¯ä¸€å€‹åŠŸèƒ½é½Šå…¨çš„ JavaScript åŠ å¯†å¥—ä»¶ï¼Œæ”¯æ´å¤šç¨®åŠ å¯†èˆ‡é›œæ¹Šæ¼”ç®—æ³•ï¼Œä½¿ç”¨ä¸Šä¹Ÿéå¸¸ç›´è¦ºã€‚</p>\n<h2 id=\"ğŸ”§-å®‰è£\">ğŸ”§ å®‰è£</h2>\n<pre><code class=\"highlight bash\">npm i crypto-js</code></pre>\n<p>è‹¥ä½¿ç”¨ TypeScriptï¼Œå»ºè­°é¡å¤–å®‰è£å‹åˆ¥å®šç¾©</p>\n<pre><code class=\"highlight bash\">npm i @types/crypto-js</code></pre>\n<h2 id=\"ğŸ“¦-å¼•ç”¨æ–¹å¼\">ğŸ“¦ å¼•ç”¨æ–¹å¼</h2>\n<p>ä½ å¯ä»¥é¸æ“‡å¼•å…¥æ•´å€‹å¥—ä»¶ï¼Œæˆ–æ˜¯åªå¼•å…¥ä½ éœ€è¦çš„æ¨¡çµ„ï¼š</p>\n<pre><code class=\"highlight ts\"><span class=\"comment\">// å¼•å…¥æ•´åŒ…</span>\n<span class=\"keyword\">import</span> <span class=\"title class_\">CryptoJS</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;crypto-js&quot;</span>;\n\n<span class=\"comment\">// åªå¼•å…¥ AES æ¨¡çµ„</span>\n<span class=\"keyword\">import</span> <span class=\"variable constant_\">AES</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;crypto-js/aes&quot;</span>;\n<span class=\"comment\">// åªå¼•å…¥ SHA256 æ¨¡çµ„</span>\n<span class=\"keyword\">import</span> <span class=\"title class_\">SHA256</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;crypto-js/sha256&quot;</span>;</code></pre>\n<p>å»ºè­°åªå¼•å…¥éœ€è¦çš„æ¨¡çµ„ä»¥æ¸›å°‘æ‰“åŒ…å¤§å°ã€‚</p>\n<h2 id=\"ğŸ”-å¸¸ç”¨åŠŸèƒ½èˆ‡ç¯„ä¾‹\">ğŸ” å¸¸ç”¨åŠŸèƒ½èˆ‡ç¯„ä¾‹</h2>\n<h3 id=\"AES-åŠ å¯†-è§£å¯†\">AES åŠ å¯† / è§£å¯†</h3>\n<pre><code class=\"highlight ts\"><span class=\"keyword\">import</span> <span class=\"variable constant_\">AES</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;crypto-js/aes&quot;</span>;\n<span class=\"keyword\">import</span> <span class=\"title class_\">Utf8</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;crypto-js/enc-utf8&quot;</span>;\n\n<span class=\"comment\">// ä½¿ç”¨å¯†é‘°</span>\n<span class=\"keyword\">const</span> secret = <span class=\"string\">&quot;my-secret-key&quot;</span>; <span class=\"comment\">// å¯†é‘°å»ºè­°ä½¿ç”¨ .env æª”æ¡ˆä¿å­˜</span>\n<span class=\"comment\">// const secret = import.meta.env.VITE_CRYPTO_SECRET;</span>\n<span class=\"keyword\">const</span> data = <span class=\"string\">&quot;Hello, CryptoJS!&quot;</span>;\n\n<span class=\"comment\">// åŠ å¯†</span>\n<span class=\"keyword\">const</span> encrypted = <span class=\"variable constant_\">AES</span>.<span class=\"title function_\">encrypt</span>(data, secret).<span class=\"title function_\">toString</span>();\n<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;Encrypted:&quot;</span>, encrypted);\n\n<span class=\"comment\">// è§£å¯†</span>\n<span class=\"keyword\">const</span> bytes = <span class=\"variable constant_\">AES</span>.<span class=\"title function_\">decrypt</span>(encrypted, secret);\n<span class=\"keyword\">const</span> decrypted = bytes.<span class=\"title function_\">toString</span>(<span class=\"title class_\">Utf8</span>);\n<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;Decrypted:&quot;</span>, decrypted);</code></pre>\n<h3 id=\"Base64-ç·¨ç¢¼-è§£ç¢¼\">Base64 ç·¨ç¢¼ / è§£ç¢¼</h3>\n<pre><code class=\"highlight ts\"><span class=\"keyword\">import</span> <span class=\"title class_\">Base64</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;crypto-js/enc-base64&quot;</span>;\n<span class=\"keyword\">import</span> <span class=\"title class_\">Utf8</span> <span class=\"keyword\">from</span> <span class=\"string\">&quot;crypto-js/enc-utf8&quot;</span>;\n\n<span class=\"keyword\">const</span> text = <span class=\"string\">&quot;Hello, world!&quot;</span>;\n<span class=\"keyword\">const</span> wordArray = <span class=\"title class_\">Utf8</span>.<span class=\"title function_\">parse</span>(text);\n<span class=\"keyword\">const</span> encoded = <span class=\"title class_\">Base64</span>.<span class=\"title function_\">stringify</span>(wordArray);\n<span class=\"keyword\">const</span> decoded = <span class=\"title class_\">Base64</span>.<span class=\"title function_\">parse</span>(encoded).<span class=\"title function_\">toString</span>(<span class=\"title class_\">Utf8</span>);\n\n<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;Encoded:&quot;</span>, encoded);\n<span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;Decoded:&quot;</span>, decoded);</code></pre>\n<h2 id=\"ğŸ“š-æ”¯æ´çš„åŠ å¯†èˆ‡é›œæ¹Šæ¼”ç®—æ³•\">ğŸ“š æ”¯æ´çš„åŠ å¯†èˆ‡é›œæ¹Šæ¼”ç®—æ³•</h2>\n<p>è©³æƒ…å¯æŸ¥çœ‹<a href=\"https://www.npmjs.com/package/crypto-js#list-of-modules\">List of modules</a></p>\n<ul>\n<li>é›œæ¹Šï¼šMD5ã€SHA1ã€SHA256ã€SHA512ã€RIPEMD160 ç­‰</li>\n<li>åŠ å¯†ï¼šAESã€DESã€TripleDESã€Rabbitã€RC4</li>\n<li>ç·¨ç¢¼ï¼šBase64ã€Hexã€Utf8ã€Latin1 ç­‰</li>\n</ul>\n<h2 id=\"ğŸ§¾-å‚™è¨»\">ğŸ§¾ å‚™è¨»</h2>\n<h3 id=\"ğŸ”-é©ç”¨æƒ…å¢ƒ\">ğŸ” é©ç”¨æƒ…å¢ƒ</h3>\n<ul>\n<li>åŠ å¯† localStorageã€cookieã€URL åƒæ•¸ç­‰</li>\n<li>ä½¿ç”¨ SHA256 ç­‰é›œæ¹Šæ¼”ç®—æ³•å‰è™•ç†è³‡æ–™</li>\n<li>å‰ç«¯å‚³é€åŠ å¯†è³‡è¨Šçµ¦å¾Œç«¯ï¼ˆå†ç”±å¾Œç«¯è§£å¯†é©—è­‰ï¼‰</li>\n</ul>\n<h3 id=\"âŒ-ä¸å»ºè­°ä½¿ç”¨æƒ…å¢ƒ\">âŒ ä¸å»ºè­°ä½¿ç”¨æƒ…å¢ƒ</h3>\n<ul>\n<li>é‡‘é‘°ç®¡ç†ï¼ˆå‰ç«¯ç„¡æ³•ä¿å¯†é‡‘é‘°ï¼‰</li>\n<li>åŠ å¯†æ¥µæ©Ÿå¯†è³‡æ–™ï¼ˆæ‡‰äº¤ç”±å¾Œç«¯ï¼‰</li>\n<li>æ•æ„Ÿèº«ä»½é©—è­‰èˆ‡æ¬Šé™æ§ç®¡</li>\n</ul>\n<h2 id=\"ğŸ“Œ-åƒè€ƒ\">ğŸ“Œ åƒè€ƒ</h2>\n<ul>\n<li><a href=\"https://github.com/brix/crypto-js\">CryptoJS GitHub</a></li>\n<li><a href=\"https://cryptojs.gitbook.io/docs\">CryptoJS å®˜æ–¹æ–‡ä»¶</a></li>\n<li><a href=\"https://www.letswrite.tw/crypto-js/\">CryptoJS ç”¨å‰ç«¯åŠ å¯†ã€è§£å¯†</a></li>\n</ul>\n","categories":["å‰ç«¯"],"tags":["åŠ å¯†"]},{"title":"Asp.Net Core è®€å–ç’°å¢ƒè®Šæ•¸é€£ç·šå­—ä¸²","url":"/2025/04/25/csharpenv/","content":"<h2 id=\"Program-cs-è¨­å®š\">Program.cs è¨­å®š</h2>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">var</span> builder = WebApplication.CreateBuilder(args);\n\nbuilder.Configuration\n    .AddUserSecrets&lt;Program&gt;() <span class=\"comment\">// ä½¿ç”¨ç§˜å¯†ç®¡ç†å“¡(æœ¬åœ°é–‹ç™¼ç”¨)</span>\n    .AddEnvironmentVariables(); <span class=\"comment\">// è®€å–ç’°å¢ƒè®Šæ•¸</span>\n    <span class=\"comment\">// .AddEnvironmentVariables(prefix:&#123;å‰å¢œ&#125;) é è¨­ASPNETCORE_æˆ–DOTNET_</span></code></pre>\n<h2 id=\"ç’°å¢ƒè®Šæ•¸è¨­å®šæ–¹å¼\">ç’°å¢ƒè®Šæ•¸è¨­å®šæ–¹å¼</h2>\n<ol>\n<li>åœ¨ä¸»æ©Ÿä¸Šé–‹å•Ÿï¼š</li>\n</ol>\n<ul>\n<li>Win + S æœå°‹ã€Œç’°å¢ƒè®Šæ•¸ã€æˆ–</li>\n<li>æ§åˆ¶å° â†’ ç³»çµ± â†’ é€²éšç³»çµ±è¨­å®š â†’ ç’°å¢ƒè®Šæ•¸</li>\n</ul>\n<ol start=\"2\">\n<li>åœ¨ã€Œç³»çµ±è®Šæ•¸ã€ä¸­æ–°å¢ï¼š</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>åç¨±</th>\n<th>å€¼</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ASPNETCORE_ConnectionStrings__DefaultConnection</td>\n<td>User Id=prod;Password=XXX;Data Source=oraclehost:1521/PRODDB;</td>\n</tr>\n</tbody>\n</table>\n<p>â˜… æ³¨æ„å‰å¢œé è¨­è¦ç‚º <code>ASPNETCORE_</code>æˆ– <code>DOTNET_</code><br>\nâ˜… <code>ConnectionStrings__DefaultConnection</code>æ˜¯é›™åº•ç·š<code>__</code></p>\n<h2 id=\"é è¨­ä¸»æ©Ÿè¨­å®šä¾†æº\">é è¨­ä¸»æ©Ÿè¨­å®šä¾†æº</h2>\n<p>WebApplicationBuilder(.NET6 å¾Œ) å„ªå…ˆç´šåˆ¥</p>\n<ol>\n<li>ä½¿ç”¨å‘½ä»¤åˆ—è¨­å®šæä¾›è€…çš„å‘½ä»¤åˆ—å¼•æ•¸</li>\n<li>ä½¿ç”¨ DOTNET_ä¸”å…·æœ‰ å‰ç½®è©çš„ç’°å¢ƒè®Šæ•¸</li>\n<li>ä½¿ç”¨ ASPNETCORE_ä¸”å…·æœ‰ å‰ç½®è©çš„ç’°å¢ƒè®Šæ•¸</li>\n</ol>\n<p>IHostedService (.NET5 å‰) å„ªå…ˆç´šåˆ¥</p>\n<ol>\n<li>ä½¿ç”¨ ASPNETCORE_ä¸”å…·æœ‰ å‰ç½®è©çš„ç’°å¢ƒè®Šæ•¸ã€‚</li>\n<li>ä½¿ç”¨å‘½ä»¤åˆ—è¨­å®šæä¾›è€…çš„å‘½ä»¤åˆ—å¼•æ•¸</li>\n<li>ä½¿ç”¨ DOTNET_ä¸”å…·æœ‰ å‰ç½®è©çš„ç’°å¢ƒè®Šæ•¸</li>\n</ol>\n<h2 id=\"æ¸¬è©¦\">æ¸¬è©¦</h2>\n<p>åœ¨ program.cs æ·»åŠ  debug endpoint</p>\n<pre><code class=\"highlight C#\">app.MapGet(<span class=\"string\">&quot;/env-check&quot;</span>, (IConfiguration config) =&gt;\n&#123;\n    <span class=\"keyword\">return</span> config.GetConnectionString(<span class=\"string\">&quot;DefaultConnection&quot;</span>) ?? <span class=\"string\">&quot;no conn string&quot;</span>;\n&#125;);</code></pre>\n<ol>\n<li>éƒ¨ç½²å¾Œå‘¼å« /env-check</li>\n<li>æª¢æŸ¥å›å‚³çš„é€£ç·šå­—ä¸²å…§å®¹æ˜¯å¦æ­£ç¢º</li>\n<li>çœ‹æœ‰æ²’æœ‰ç¼ºå°‘å†’è™Ÿã€æ–œç·šã€ç©ºæ ¼æˆ–æ‰“éŒ¯å­—</li>\n</ol>\n<h2 id=\"é€²éš\">é€²éš</h2>\n<p>å°±ç®—è¨­å®šç’°å¢ƒè®Šæ•¸ä¾†é¿å…å°‡æ•æ„Ÿè³‡æ–™å¯«å…¥ç¨‹å¼ï¼Œæ¯” appsettings.json å®‰å…¨ï¼Œä½†æ˜¯é‚„æ˜¯æœ‰ç›¸é—œé¢¨éšª<br>\næ‰€ä»¥å¯èƒ½æœƒé€²ä¸€æ­¥éœ€è¦<code>æ©Ÿå¯†ç®¡ç†æœå‹™ï¼ˆSecrets Management Servicesï¼‰</code>ä¾†å»ç®¡ç†æ•æ„Ÿè³‡è¨Š<br>\nä½†é€™é‚Šç”¨ä¸åˆ°å°±å¤§æ¦‚ç´€éŒ„ä¸€ä¸‹å¯èƒ½çš„æ›´å„ªè§£ï¼Œå› ç‚ºè¦ ğŸ’¸</p>\n<h3 id=\"ç’°å¢ƒè®Šæ•¸çš„ä¾·é™\">ç’°å¢ƒè®Šæ•¸çš„ä¾·é™</h3>\n<table>\n<thead>\n<tr>\n<th>å•é¡Œé»</th>\n<th>èªªæ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>è¢«èª¤è®€</td>\n<td>è¶³å¤ æ¬Šé™çš„ä½¿ç”¨è€…å¯é€éæŒ‡ä»¤æŸ¥çœ‹æ‰€æœ‰è®Šæ•¸</td>\n</tr>\n<tr>\n<td>é›£ç®¡ç†</td>\n<td>æ¯å°æ©Ÿå™¨éƒ½è¦å–®ç¨è¨­å®šï¼Œä¸é©åˆå¤§å‹æˆ–å¤šç’°å¢ƒéƒ¨ç½²</td>\n</tr>\n<tr>\n<td>ç„¡å¯©è¨ˆç´€éŒ„</td>\n<td>ç„¡æ³•è¿½è¹¤èª°æ”¹äº†å“ªå€‹è®Šæ•¸ã€ä½•æ™‚æ”¹çš„</td>\n</tr>\n<tr>\n<td>ç‰ˆæœ¬æ§ç®¡</td>\n<td>ç„¡æ³•è¿½è¹¤æ­·å²ç´€éŒ„æˆ–è‡ªå‹•å›å¾©èˆŠç‰ˆæœ¬</td>\n</tr>\n<tr>\n<td>è®Šæ›´é›£é€šçŸ¥</td>\n<td>æ”¹è®Šå€¼ï¼Œéœ€è¦äººç‚ºé€šçŸ¥é–‹ç™¼ / ç³»çµ±äººå“¡é‡å•Ÿæœå‹™</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Azure-Key-Vault-ç‚ºä¾‹çš„å„ªå‹¢\">Azure Key Vault ç‚ºä¾‹çš„å„ªå‹¢</h3>\n<table>\n<thead>\n<tr>\n<th>åŠŸèƒ½</th>\n<th>å¥½è™•</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>é›†ä¸­ç®¡ç†</td>\n<td>æ‰€æœ‰æ©Ÿå¯†é›†ä¸­å­˜æ–¼ä¸€å€‹ Vaultï¼Œæ¸›å°‘æ•£è½é¢¨éšª</td>\n</tr>\n<tr>\n<td>æ¬Šé™æ§ç®¡</td>\n<td>ä½¿ç”¨ Azure ADã€RBAC æ§åˆ¶èª°èƒ½å–ç”¨å“ªäº›æ©Ÿå¯†</td>\n</tr>\n<tr>\n<td>è‡ªå‹•è¼ªæ›å¯†é‘°</td>\n<td>å¯çµåˆè‡ªå‹•åŒ–å·¥å…·å®šæœŸæ›´æ–°é€£ç·šå¯†ç¢¼ã€æ†‘è­‰ç­‰</td>\n</tr>\n<tr>\n<td>åŠ å¯†å„²å­˜</td>\n<td>Vault æœ¬èº«ä»¥é«˜å¼·åº¦åŠ å¯†ä¿å­˜å…§å®¹</td>\n</tr>\n<tr>\n<td>ç¨½æ ¸èˆ‡æ—¥èªŒ</td>\n<td>æ¯æ¬¡å­˜å–éƒ½æœƒè¨˜éŒ„ï¼Œä¾¿æ–¼æ—¥å¾ŒæŸ¥è©¢èˆ‡èª¿æŸ¥</td>\n</tr>\n<tr>\n<td>ä¸ç”¨å†ç¢°å¯†ç¢¼</td>\n<td>ç¨‹å¼ç¢¼ç”¨ Identity å­˜å– Vaultï¼Œä¸éœ€è¦æ˜ç¢¼å­˜åœ¨ä»»ä½•åœ°æ–¹</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://learn.microsoft.com/zh-tw/aspnet/core/fundamentals/configuration/?view=aspnetcore-9.0\">ASP.NET Core çš„è¨­å®š</a></li>\n<li><a href=\"https://learn.microsoft.com/en-us/aspnet/core/fundamentals/environments?view=aspnetcore-9.0\">Use multiple environments in ASP.NET Core</a></li>\n<li>ChatGpt</li>\n<li><a href=\"https://azure.microsoft.com/en-us/products/key-vault\">Azure Key Vault</a></li>\n</ul>\n","categories":["å¾Œç«¯"],"tags":["C#"]},{"title":"Brotato + DLC é›£åº¦ 5 å»ºè­°(å…¨è§’è‰²) + æ–°æ§‹å»º(ä¸­ç¿»)","url":"/2024/11/26/brotato/","content":"<p><img src=\"/images/bratato.jpg\" alt=\"brotato.jpg\"><br>\n<a href=\"https://steamcommunity.com/sharedfiles/filedetails/?id=3018964960\">æ–‡ç« åŸæ–‡</a></p>\n<h2 id=\"ä¸€èˆ¬å»ºè­°\">ä¸€èˆ¬å»ºè­°</h2>\n<p>ä¸è¦å°çœ‹<code>é‹æ°£(Luck)</code>èˆ‡<code>æ”¶ç©«(Harvesting)</code><br>\nä½ è¶Šæ—©æ‹¿åˆ°é‹æ°£è·Ÿæ”¶ç©«ï¼Œå¾Œé¢çš„å›å ±è¶Šå¤š<br>\nä¸‹é¢æ˜¯å€‹ä¾‹å­<br>\n<img src=\"/images/harvestExample.jpg\" alt=\"harvestExample.jpg\"><br>\né€™ä¸¦éæ„å‘³è‘—æ¯æ¬¡éƒ½å¿…é ˆé¸æ“‡<code>æ”¶ç©«(Harvesting)</code>ä½†è¶Šæ—©æå‡æ”¶ç›Šè¶Šå¤§<br>\n<code>é‹æ°£(Luck)</code>ä¹Ÿæ˜¯åŒç†ï¼Œè¶Šæ—©æå‡å¯ä»¥æœ‰æ›´å¥½çš„å•†åº—é¸æ“‡èˆ‡å‡ç´šé¸é …<br>\næ‰€ä»¥å¦‚æœä½ åœ¨é›£åº¦ 5 ä¸‹æŸäº›è§’è‰²ç©å¾—å¾ˆåƒåŠ›ï¼Œå¯ä»¥å˜—è©¦åœ¨å‰æœŸæå‡<code>æ”¶ç©«(Harvesting)</code>å’Œ<code>é‹æ°£(Luck)</code><br>\næˆ–è¨±æœƒè®“ä½ ç©èµ·ä¾†è¼ƒèˆ’æœ<br>\nä¸‹åœ–èªªæ˜<code>é‹æ°£(Luck)</code>å¦‚ä½•å½±éŸ¿éŠæˆ²<br>\n<img src=\"/images/luck.png\" alt=\"lucky.png\"><br>\nç„¶å¾Œä¸‹åœ–èªªæ˜<code>é‹æ°£(Luck)</code>æ•¸å€¼å°å•†åº—çš„å½±éŸ¿ï¼Œä½†ä¸è¦å¿˜è¨˜å‡ç´šç•°å½¢ç´ ææ‰è½<br>\n<img src=\"/images/luckShop.jpg\" alt=\"luckShop.jpg\"><br>\nä¸€èˆ¬è€Œè¨€ï¼Œä½ ä¸éœ€è¦å¤ªå¤šå°±å¯ä»¥å®Œæˆé›£åº¦ 5ï¼Œåªéœ€è¦äº†è§£è§’è‰²è·Ÿç‰©å“çš„è¯å‹•</p>\n<h2 id=\"æ¶ˆè€—å“ã€æ²»ç™‚èˆ‡å¯¶ç®±-é‡è¦\">æ¶ˆè€—å“ã€æ²»ç™‚èˆ‡å¯¶ç®±(é‡è¦!!!)</h2>\n<p>ğŸ˜±<code>é™¤ééœ€è¦è£œè¡€ï¼Œè«‹ä¸è¦æ‹¾å–æ¶ˆè€—å“è·Ÿå¯¶ç®±</code>ğŸ˜±<br>\nå› ç‚ºå¦‚æœä½ æ»¿è¡€æ‹¾å–ï¼Œå°‡ä¸æœƒç²å¾—ä»»ä½•æ•ˆç›Š<br>\næ¶ˆè€—å“è·Ÿå¯¶ç®±åœ¨æ³¢æ•¸çµæŸçš„æ™‚å€™æœƒè‡ªå‹•æ‹¾å–<br>\n<img src=\"/images/healPick.jpg\" alt=\"healPick.jpg\"><br>\n<img src=\"/images/lootCrate.jpg\" alt=\"lootCrate.jpg\"><br>\né€™å€‹æŠ€å·§é©åˆç”¨æ–¼ä½ æƒ³è¦ç§’æ®ºèè‹±æ€ªï¼Œå› ç‚ºä»–æœƒæ‰è½ä¸€å€‹å‚³å¥‡å¯¶ç®±å¯ä»¥å›å¾© 100HP<br>\nå¦‚æœä½ æ»¿è¡€å°±ä¿ç•™åˆ°éœ€è¦çš„æ™‚å€™å†ç”¨<br>\né€™æ˜¯ä¸€å€‹å¾ˆæœ‰ç”¨çš„ç­–ç•¥ï¼Œä½†å¸¸å¸¸è¢«å¿½ç•¥<br>\næ‰€ä»¥æ»¿è¡€çš„æ™‚å€™ï¼Œå°±ä¸è¦æ’¿æ¶ˆè€—å“è·Ÿå¯¶ç®±</p>\n<p>é™¤éä½ çš„æ“ä½œå¾ˆç¥ï¼Œè¦ä¸ç„¶ä½ ä¸€å®šæœƒéœ€è¦è£œè¡€ï¼Œä»–æœƒåœ¨é—œéµæ™‚åˆ»æ•‘ä½ ä¸€å‘½ ğŸ¤¡<br>\n<img src=\"/images/healBuff.jpg\" alt=\"healBuff.jpg\"></p>\n<h2 id=\"é›£åº¦-5-æ¨è–¦ç‰©å“-I-got-you\">é›£åº¦ 5 æ¨è–¦ç‰©å“!!!(I got you)</h2>\n<p>æœ‰äº›ç‰©å“å¯ä»¥æ¥µå¤§çš„å¹«åŠ©ä½ é€šéé›£åº¦ 5<br>\né¦–é¸æ˜¯å¦–ç²¾(Fairy)å¹¾ä¹å¿…é¸ï¼Œå…¶é¤˜çš„å¯ä»¥åƒè€ƒä¸‹åœ–<br>\nå»ºè­°åœ¨è¼ƒä½çš„é›£åº¦è§£é–é€™äº›è£å‚™ï¼Œé€™æ¨£ä½ å°±å¯ä»¥åœ¨é›£åº¦ 5 ä½¿ç”¨å®ƒ<br>\n<img src=\"/images/betterItem.jpg\" alt=\"betterItem.jpg\"></p>\n<h2 id=\"S-Tier-Items\">S-Tier Items</h2>\n<p>ç‚ºä»€éº¼è¦ç›¡é‡å–å¾—é€™äº›è£å‚™???</p>\n<ul>\n<li>è®“ä½ éŠæˆ²æ›´é †åˆ©</li>\n<li>å·¨å¤§åƒ¹å€¼ï¼Œä¸”å¹¾ä¹å›æœ¬</li>\n<li>å‚·å®³è¶Šé«˜ï¼Œä½ æ®ºæ•µçš„é€Ÿåº¦å°±è¶Šå¿«ï¼Œæ®ºçš„æ•µäººè¶Šå¤šï¼Œä½ ç²å¾—çš„ææ–™ä¹Ÿå°±è¶Šå¤šã€‚</li>\n<li>è¶Šæ—©ç²å¾—åœ–ç‰‡ä¸­ S ç´šè£å‚™è£¡é‚£äº›æä¾›æ”¶ç©«ï¼ˆHarvestingï¼‰çš„è£å‚™ï¼Œå®ƒå€‘å›æœ¬çš„é€Ÿåº¦å°±è¶Šå¿«ã€‚</li>\n</ul>\n<p><strong>æ³¨æ„!!!</strong><br>\nç‚ºä»€éº¼é‚£äº›å¯ä»¥<code>å¢åŠ æ•µäººæ•¸é‡</code>çš„è£å‚™æ˜¯å¥½æ±è¥¿??<br>\nå› ç‚ºæ¯å›åˆåˆ·æ–°çš„æ•µäººè¶Šå¤šï¼Œæ•´å ´éŠæˆ²ä¸­ç²å¾—çš„ææ–™ä¹Ÿæœƒè¶Šå¤šã€‚å› æ­¤ï¼Œè¨˜å¾—ç•™æ„é€™é¡è£å‚™ã€‚</p>\n<p>ä½†ä¹Ÿè¦ç•™å¿ƒï¼Œæœ‰äº›è£å‚™åœ¨ç¬¬ 15 æ³¢ä¹‹å¾Œå°±ä¸å¤ªå€¼å¾—æ‹¿äº†ï¼Œå…·é«”å–æ±ºæ–¼ä½ ç²å¾—å®ƒå€‘çš„æ™‚é–“ã€‚<br>\nä»¥ä¸‹åˆ—å‡ºçš„è£å‚™å¹¾ä¹é©ç”¨æ–¼éŠæˆ²ä¸­æ¯å€‹è§’è‰²ï¼Œæ‰€ä»¥å®ƒå€‘è¢«æ­¸å…¥äº† S ç´šã€‚<br>\n<img src=\"/images/SRankItems.jpg\" alt=\"SRankItems.jpg\"></p>\n<p><strong>ç‰¹åˆ¥</strong><br>\nç‚ºä»€éº¼é¸æ“‡ Ugly Tooth??<br>\nå¦‚æœä½ è¦ºå¾—ä½ å¸¸å¸¸è¢«èè‹±æ€ªæˆ– BOSS è²¼è‘—æ‰“æˆ–æ˜¯è¦ºå¾—ç§»å‹•é€Ÿåº¦ä¸å¤ èº²æ€ªé‚£å°±é¸å®ƒ<br>\nå®ƒæ˜¯éŠæˆ²ä¸­å½±éŸ¿åŠ›æœ€å¤§çš„è£å‚™ä¹‹ä¸€ï¼Œç‰¹åˆ¥æ˜¯åœ¨ä½ çš„è·‘åœ–ç‹€æ³ä¸ç©©çš„æ™‚å€™ï¼Œèƒ½èµ·åˆ°å¾ˆå¤§çš„ä½œç”¨<br>\nå¦‚æœä½ ç›®å‰å¯ä»¥è¼•é¬†æ¸…å ´ï¼Œé‚£å°±ä¸éœ€è¦å®ƒ<br>\n<img src=\"/images/uglyTooth.jpg\" alt=\"uglyTooth.jpg\"></p>\n<h2 id=\"F-Tier-Items-å¹¾ä¹ä¸é¸\">F-Tier Items(å¹¾ä¹ä¸é¸)</h2>\n<p>ç‚ºä»€éº¼è¦ç›¡é‡é¿å…é¸æ“‡é€™äº›ç‰©å“??<br>\nå› ç‚ºé€™äº›è£å‚™çš„å‰¯ä½œç”¨æœƒéš¨è‘—éŠæˆ²çš„é€²è¡Œè¶Šä¾†è¶Šæ“´å¤§</p>\n<ol>\n<li>æ¸›å°‘æ•µäººæ•¸é‡çš„è£å‚™ï¼Œä»£è¡¨ç¶“æ¿Ÿæ”¶ç›Šæ¸›å°‘</li>\n<li>å¸Œæœ›æ•µäººé€Ÿåº¦æ¯”ä½ æ…¢æ‰ä¸å®¹æ˜“è²¼åˆ°ä½ ï¼Œæ‰€ä»¥çµ¦æ•µäººé€Ÿåº¦åŠ ä¹˜çš„è£å‚™ä¸å»ºè­°é¸æ“‡</li>\n</ol>\n<p><img src=\"/images/FTireItems.jpg\" alt=\"FTireItems.jpg\"></p>\n<h2 id=\"å·¥ç¨‹å­¸\">å·¥ç¨‹å­¸</h2>\n<p>å¯ä»¥æå‡çµæ§‹ç‰©çš„å‚·å®³è·Ÿæ²»ç™‚é‡ï¼Œä¹Ÿæœƒæå‡æ¿æ‰‹è·Ÿèµ·å­çš„å‚·å®³</p>\n<p>å·¥ç¨‹å­¸æœƒä¸æœƒå¤ªå¼·?<br>\nå°æ–¼æŸäº›è§’è‰²æœ‰è² é¢%å‚·å®³åŠ æˆçš„è§’è‰²æ˜¯è »å¼·çš„<br>\nå› ç‚º<code>å·¥ç¨‹å­¸</code>æ˜¯ä¸€å€‹ç¨ç«‹çš„å±¬æ€§ä¸ä¾è³´å…¶ä»–<code>%å‚·å®³</code>ã€<code>ç¯„åœå‚·å®³</code>æˆ–<code>è¿‘è·é›¢å‚·å®³</code><br>\nå› æ­¤ä½ å¯ä»¥å°ˆæ³¨æ–¼æå‡ä½ çš„<code>é–ƒé¿</code>ã€<code>ç”Ÿå‘½</code>ã€<code>ç”Ÿå‘½å†ç”Ÿ</code>ã€<code>è­·ç”²</code>ï¼Œä¸ç”¨é—œå¿ƒå…¶ä»–å‚·å®³åªè¦å‡<code>å·¥ç¨‹å­¸</code>å°±å¥½<br>\n<img src=\"/images/engineering.jpg\" alt=\"engineering.jpg\"></p>\n<p>èˆ‰ä¾‹ï¼Œå‡è¨­ä½ çš„ç‚®å°æ²’æœ‰è²«ç©¿ï¼Œç„¶å¾Œä½ é¸æ“‡ä¸‹é¢çš„é“å…·<br>\n<img src=\"/images/sharpBullet.jpg\" alt=\"sharpBullet.jpg\"><br>\nä½ çš„çµæ§‹ç‰©ä¸æœƒè¢«-%å‚·å®³å½±éŸ¿ï¼Œå› ç‚ºçµæ§‹ç‰©ä¸å—å…¶å½±éŸ¿ï¼Œæ‰€ä»¥å°çµæ§‹ç‰©é€™å€‹é“å…·æ˜¯å¾ˆæœ‰ç”¨çš„</p>\n<p>é‚„åœ¨æ–½å·¥ä¸­â€¦</p>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://steamcommunity.com/sharedfiles/filedetails/?id=3018964960\">https://steamcommunity.com/sharedfiles/filedetails/?id=3018964960</a></li>\n<li><a href=\"https://brotato.wiki.spellsandguns.com/Brotato_Wiki\">https://brotato.wiki.spellsandguns.com/Brotato_Wiki</a></li>\n<li><a href=\"https://docs.google.com/document/d/1-c33h4oZwmWj3ZOz4xp0HN4vIyMXxOwGK8Rm8e4mfKE/edit?tab=t.0#heading=h.dvp9r7tx7asm\">https://docs.google.com/document/d/1-c33h4oZwmWj3ZOz4xp0HN4vIyMXxOwGK8Rm8e4mfKE/edit?tab=t.0#heading=h.dvp9r7tx7asm</a></li>\n</ul>\n","categories":["éŠæˆ²"],"tags":["éŠæˆ²"]},{"title":"C# ä½¿ç”¨ curl.exe å‘¼å«api","url":"/2024/11/19/curl/","content":"<h2 id=\"æ¦‚è¿°\">æ¦‚è¿°</h2>\n<p>æœ‰æ™‚å€™é–‹ç™¼è»Ÿé«”çš„ç‰ˆæœ¬éèˆŠï¼Œå°è‡´ä»‹æ¥ API æœƒç•°å¸¸å›°é›£<br>\nå­¸é•·èªªå¯ä»¥ç”¨ curl ä¾†å‘¼å« apiï¼Œæ‰€ä»¥å°±ä¾†çœ‹çœ‹æ€éº¼ç”¨</p>\n<h2 id=\"DownLoad-curl-exe\">DownLoad curl.exe</h2>\n<p><a href=\"https://curl.se/download.html#Win64\">https://curl.se/download.html#Win64</a></p>\n<h2 id=\"CurlHelper-cs\">CurlHelper.cs</h2>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">CurlHelper</span>\n    &#123;\n        <span class=\"comment\">// curl.exe è·¯å¾‘</span>\n        <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">string</span> CurlPath = <span class=\"string\">$&quot;C:\\\\CURLDEMO\\\\EXE\\\\CURL.EXE&quot;</span>;\n\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> Get è«‹æ±‚</span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;url&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;headers&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span>\n        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"built_in\">string</span> <span class=\"title\">GetRequest</span>(<span class=\"params\"><span class=\"built_in\">string</span> url, Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt; headers = <span class=\"literal\">null</span></span>)</span>\n        &#123;\n            <span class=\"built_in\">string</span> arugments = <span class=\"string\">$&quot;-X GET \\&quot;<span class=\"subst\">&#123;url&#125;</span>\\&quot;&quot;</span>;\n            <span class=\"keyword\">if</span> (headers != <span class=\"literal\">null</span>)\n            &#123;\n                <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> header <span class=\"keyword\">in</span> headers)\n                &#123;\n                    arugments += <span class=\"string\">$&quot; -H \\&quot;<span class=\"subst\">&#123;header.Key&#125;</span>: <span class=\"subst\">&#123;header.Value&#125;</span>\\&quot;&quot;</span>;\n                &#125;\n            &#125;\n            <span class=\"keyword\">return</span> ExecuteCurlCommand(arugments);\n        &#125;\n\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> POST è«‹æ±‚(JSONè³‡æ–™)</span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;url&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;jsonData&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;headers&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span>\n        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"built_in\">string</span> <span class=\"title\">PostRequest</span>(<span class=\"params\"><span class=\"built_in\">string</span> url, <span class=\"built_in\">string</span> jsonData, Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt; headers = <span class=\"literal\">null</span></span>)</span>\n        &#123;\n            <span class=\"built_in\">string</span> arguments = <span class=\"string\">$&quot;-X POST -H \\&quot;Content-Type: application/json\\&quot; -d \\&quot;<span class=\"subst\">&#123;jsonData&#125;</span>\\&quot; \\&quot;<span class=\"subst\">&#123;url&#125;</span>\\&quot;&quot;</span>;\n            <span class=\"keyword\">if</span> (headers != <span class=\"literal\">null</span>)\n            &#123;\n                <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> header <span class=\"keyword\">in</span> headers)\n                &#123;\n                    arguments += <span class=\"string\">$&quot; -H \\&quot;<span class=\"subst\">&#123;header.Key&#125;</span>: <span class=\"subst\">&#123;header.Value&#125;</span>\\&quot;&quot;</span>;\n                &#125;\n            &#125;\n            <span class=\"keyword\">return</span> ExecuteCurlCommand(arguments);\n        &#125;\n\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> POST è«‹æ±‚(è¡¨å–®è³‡æ–™)</span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;url&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;formData&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;headers&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span>\n        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"built_in\">string</span> <span class=\"title\">PostFormRequest</span>(<span class=\"params\"><span class=\"built_in\">string</span> url, Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt; formData, Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt; headers = <span class=\"literal\">null</span></span>)</span>\n        &#123;\n            <span class=\"built_in\">string</span> arguments = <span class=\"string\">&quot;-X POST&quot;</span>;\n            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> item <span class=\"keyword\">in</span> formData)\n            &#123;\n                arguments += <span class=\"string\">$&quot; -F \\&quot;<span class=\"subst\">&#123;item.Key&#125;</span>=<span class=\"subst\">&#123;item.Value&#125;</span>\\&quot;&quot;</span>;\n            &#125;\n            arguments += <span class=\"string\">$&quot; \\&quot;<span class=\"subst\">&#123;url&#125;</span>\\&quot;&quot;</span>;\n            <span class=\"keyword\">if</span> (headers != <span class=\"literal\">null</span>)\n            &#123;\n                <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> header <span class=\"keyword\">in</span> headers)\n                &#123;\n                    arguments += <span class=\"string\">$&quot; -H \\&quot;<span class=\"subst\">&#123;header.Key&#125;</span>: <span class=\"subst\">&#123;header.Value&#125;</span>\\&quot;&quot;</span>;\n                &#125;\n            &#125;\n            <span class=\"keyword\">return</span> ExecuteCurlCommand(arguments);\n        &#125;\n\n\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> åŸ·è¡Œcurlå‘½ä»¤è¿”å›è¼¸å‡º</span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;arguments&quot;&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span>\n        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span>\n        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"built_in\">string</span> <span class=\"title\">ExecuteCurlCommand</span>(<span class=\"params\"><span class=\"built_in\">string</span> arguments</span>)</span>\n        &#123;\n            <span class=\"keyword\">var</span> startInfo = <span class=\"keyword\">new</span> ProcessStartInfo\n            &#123;\n                FileName = CurlPath,\n                Arguments = arguments,\n                RedirectStandardOutput = <span class=\"literal\">true</span>,\n                UseShellExecute = <span class=\"literal\">false</span>,\n                CreateNoWindow = <span class=\"literal\">true</span>,\n            &#125;;\n            <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> p = Process.Start(startInfo))\n            &#123;\n                <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> reader = p.StandardOutput)\n                &#123;\n                    <span class=\"keyword\">return</span> reader.ReadToEnd();\n                &#125;\n            &#125;\n        &#125;\n    &#125;</code></pre>\n<h2 id=\"Usage\">Usage</h2>\n<pre><code class=\"highlight C#\"><span class=\"built_in\">string</span> url = <span class=\"string\">&quot;apiurl...&quot;</span>;\n<span class=\"keyword\">var</span> headers = <span class=\"keyword\">new</span> Dictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">string</span>&gt;\n&#123;\n      &#123;<span class=\"string\">&quot;Authorization&quot;</span>, <span class=\"string\">&quot;Bearer your_api_key&quot;</span>&#125;\n&#125;;\n<span class=\"built_in\">string</span> response = CurlHelper.GetRequest(url, headers);\nConsole.WriteLine(<span class=\"string\">&quot;Get Response: &quot;</span> + response);</code></pre>\n","categories":["å¾Œç«¯"],"tags":["C#","Curl"]},{"title":"DI ç”Ÿå‘½é€±æœŸï¼ˆLifeTimeï¼‰ç­†è¨˜","url":"/2025/06/30/di-lifecycle/","content":"<p>åœ¨é€²å…¥ LifeTime å‰ï¼Œæˆ‘å€‘å…ˆç°¡å–®ä»‹ç´¹ä»€éº¼æ˜¯ <strong>IoCï¼ˆæ§åˆ¶åè½‰ï¼‰</strong> å’Œ <strong>DIï¼ˆä¾è³´æ³¨å…¥ï¼‰</strong></p>\n<h2 id=\"ğŸ”„-IoCï¼ˆInversion-of-Controlï¼‰\">ğŸ”„ IoCï¼ˆInversion of Controlï¼‰</h2>\n<blockquote>\n<p>æŠŠã€Œèª°ä¾†æ±ºå®šå»ºç«‹ç‰©ä»¶ã€é€™ä»¶äº‹ï¼Œ<strong>å¾è‡ªå·±æ‰‹ä¸Šäº¤çµ¦åˆ¥äººï¼ˆæ¡†æ¶ï¼‰è™•ç†</strong>ã€‚</p>\n</blockquote>\n<p>ä»¥å‰æˆ‘å€‘å¸¸æœƒè‡ªå·±ç”¨ <code>new</code> å»å»ºç«‹ç‰©ä»¶ï¼š</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">var</span> service = <span class=\"keyword\">new</span> MyService();</code></pre>\n<p><img src=\"/images/di-lifecycle/0_3DIWQ4HsdSzFlYe9.webp\" alt=\"selfnew.webp\"></p>\n<p>é€™ç¨®åšæ³•æœƒå°è‡´é«˜è€¦åˆï¼Œæ¸¬è©¦èˆ‡æ“´å……éƒ½ä¸æ˜“ã€‚<br>\né€é <strong>IoC</strong>ï¼Œå¯ä»¥æŠŠç‰©ä»¶çš„æ§åˆ¶æ¬Šäº¤çµ¦ã€Œå®¹å™¨ã€è™•ç†ï¼Œé”åˆ°è§£è€¦èˆ‡å½ˆæ€§æ³¨å…¥çš„ç›®çš„ã€‚</p>\n<p><img src=\"/images/di-lifecycle/0_TaUixB5JQ0uP10O8.webp\" alt=\"ioc_container.webp\"></p>\n<p>ğŸ¯ å¯¦éš›æ¯”å–»</p>\n<ul>\n<li>å‚³çµ±æ–¹å¼ï¼šåº—å®¶æ”¶åˆ°è¨‚å–®å¾Œï¼Œè‡ªè¡Œæ‰¾å¤–é€å“¡é€é¤</li>\n<li>IoC å®¹å™¨ï¼šåº—å®¶é€é å¤–é€å¹³å°ï¼ˆIoC å®¹å™¨ï¼‰ è™•ç†è¨‚å–®èˆ‡å®‰æ’å¤–é€</li>\n</ul>\n<h2 id=\"NET-Core-ä¸­çš„-DI-æ©Ÿåˆ¶\">.NET Core ä¸­çš„ DI æ©Ÿåˆ¶</h2>\n<p>.NET Core å…§å»ºæ”¯æ´ DIï¼Œä½¿ç”¨<code>Microsoft.Extensions.DependencyInjection</code> å‘½åç©ºé–“ã€‚<br>\nè¨»å†Šæœå‹™æ™‚ï¼ŒæœƒæŒ‡å®šæœå‹™çš„ç”Ÿå‘½é€±æœŸï¼ˆLifeTimeï¼‰ï¼Œå¸¸è¦‹çš„æœ‰ä»¥ä¸‹ä¸‰ç¨®ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>LifeTime é¡å‹</th>\n<th>èªªæ˜</th>\n<th>å»ºç«‹æ™‚æ©Ÿ</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Transient</strong></td>\n<td>æ¯æ¬¡è«‹æ±‚éƒ½ç”¢ç”Ÿæ–°å¯¦ä¾‹</td>\n<td>æ¯æ¬¡å‘¼å«æ™‚</td>\n</tr>\n<tr>\n<td><strong>Scoped</strong></td>\n<td>æ¯å€‹ HTTP Request å…±äº«å¯¦ä¾‹</td>\n<td>æ¯å€‹è«‹æ±‚</td>\n</tr>\n<tr>\n<td><strong>Singleton</strong></td>\n<td>æ‡‰ç”¨ç¨‹å¼å…¨åŸŸå”¯ä¸€å¯¦ä¾‹</td>\n<td>æ‡‰ç”¨å•Ÿå‹•æ™‚</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"ğŸ§¬-Singletonï¼šå–®ä¾‹ç”Ÿå‘½é€±æœŸ\">ğŸ§¬ Singletonï¼šå–®ä¾‹ç”Ÿå‘½é€±æœŸ</h2>\n<h3 id=\"âœ…-é©ç”¨æƒ…å¢ƒï¼š\">âœ… é©ç”¨æƒ…å¢ƒï¼š</h3>\n<ul>\n<li>å…¨åŸŸè¨­å®š</li>\n<li>è³‡æ–™åº«é€£ç·š</li>\n<li>å¿«å–æœå‹™</li>\n<li>éš¨æ©Ÿæ•¸ç”Ÿæˆå™¨ã€é›œæ¹Šå‡½å¼</li>\n</ul>\n<h3 id=\"ğŸ§ -ä½¿ç”¨æ–¹å¼ï¼š\">ğŸ§  ä½¿ç”¨æ–¹å¼ï¼š</h3>\n<pre><code class=\"highlight C#\">services.AddSingleton&lt;IMyService, MyService&gt;();</code></pre>\n<h3 id=\"ğŸ‘-å„ªé»ï¼š\">ğŸ‘ å„ªé»ï¼š</h3>\n<ul>\n<li>åªå»ºç«‹ä¸€æ¬¡ï¼Œæ•ˆèƒ½ä½³ã€è¨˜æ†¶é«”ä½¿ç”¨å°‘</li>\n<li>é©ç”¨æ–¼ç„¡ç‹€æ…‹æˆ–å…¨åŸŸç‹€æ…‹ä¸€è‡´çš„æœå‹™</li>\n</ul>\n<h3 id=\"âš ï¸-æ³¨æ„äº‹é …\">âš ï¸ æ³¨æ„äº‹é … :</h3>\n<ul>\n<li>å¯¦ä¾‹ä¸èƒ½è¢«æ›¿æ›</li>\n<li>ä¸é©ç”¨æ–¼æ¯æ¬¡è«‹æ±‚éœ€ä¸åŒç‹€æ…‹çš„æœå‹™</li>\n</ul>\n<h2 id=\"ğŸ“¦-Scopedï¼šä½œç”¨åŸŸç”Ÿå‘½é€±æœŸ\">ğŸ“¦ Scopedï¼šä½œç”¨åŸŸç”Ÿå‘½é€±æœŸ</h2>\n<h3 id=\"âœ…-é©ç”¨æƒ…å¢ƒï¼š-t2\">âœ… é©ç”¨æƒ…å¢ƒï¼š</h3>\n<ul>\n<li>é©—è­‰èˆ‡æˆæ¬Šæœå‹™</li>\n<li>èˆ‡ HTTP Request ç¶å®šçš„æœå‹™ï¼ˆå¦‚ä½¿ç”¨è€…ä¸Šä¸‹æ–‡ï¼‰</li>\n</ul>\n<h3 id=\"ğŸ§ -ä½¿ç”¨æ–¹å¼ï¼š-t2\">ğŸ§  ä½¿ç”¨æ–¹å¼ï¼š</h3>\n<pre><code class=\"highlight C#\">services.AddScoped&lt;IMyService, MyService&gt;();</code></pre>\n<h3 id=\"ğŸ‘-å„ªé»ï¼š-t2\">ğŸ‘ å„ªé»ï¼š</h3>\n<ul>\n<li>æ¯å€‹ HTTP Request éƒ½æœƒä½¿ç”¨åŒä¸€å¯¦ä¾‹</li>\n<li>å¯å®‰å…¨æ“ä½œèˆ‡ Request ç¶å®šçš„ç‹€æ…‹</li>\n</ul>\n<h3 id=\"âš ï¸-æ³¨æ„äº‹é …-t2\">âš ï¸ æ³¨æ„äº‹é … :</h3>\n<ul>\n<li>æ•ˆèƒ½å¯èƒ½ç•¥ä½æ–¼ Singleton</li>\n<li>é¿å…è·¨ä½œç”¨åŸŸå­˜å–ï¼ˆä¾‹å¦‚æ³¨å…¥åˆ° Singleton è£¡ï¼‰</li>\n</ul>\n<h2 id=\"âœ¨-Transientï¼šç¬æ™‚ç”Ÿå‘½é€±æœŸ\">âœ¨ Transientï¼šç¬æ™‚ç”Ÿå‘½é€±æœŸ</h2>\n<h3 id=\"âœ…-é©ç”¨æƒ…å¢ƒï¼š-t3\">âœ… é©ç”¨æƒ…å¢ƒï¼š</h3>\n<ul>\n<li>æ¯æ¬¡éƒ½è¦ç²å¾—æ–°è³‡æ–™çš„æœå‹™</li>\n<li>ç„¡éœ€ç¶­æŒç‹€æ…‹çš„å…ƒä»¶</li>\n</ul>\n<h3 id=\"ğŸ§ -ä½¿ç”¨æ–¹å¼ï¼š-t3\">ğŸ§  ä½¿ç”¨æ–¹å¼ï¼š</h3>\n<pre><code class=\"highlight C#\">services.AddTransient&lt;IMyService, MyService&gt;();</code></pre>\n<h3 id=\"ğŸ‘-å„ªé»ï¼š-t3\">ğŸ‘ å„ªé»ï¼š</h3>\n<ul>\n<li>æ¯æ¬¡ä½¿ç”¨éƒ½æœƒå»ºç«‹æ–°å¯¦ä¾‹ï¼Œè³‡æ–™æœ€æ–°</li>\n<li>ä¸æœƒç”¢ç”Ÿè·¨è«‹æ±‚æ±¡æŸ“å•é¡Œ</li>\n</ul>\n<h3 id=\"âš ï¸-ä¸å»ºè­°ç”¨æ–¼\">âš ï¸ ä¸å»ºè­°ç”¨æ–¼ :</h3>\n<ul>\n<li>è³‡æ–™åº«é€£ç·šã€è¨­å®šã€å¿«å–ç­‰éœ€è¦é•·æ™‚é–“å…±ç”¨è³‡æºçš„æœå‹™</li>\n</ul>\n<h2 id=\"ğŸ’¡-å¯¦ä¾‹ç¯„ä¾‹ï¼šæ¯”è¼ƒä¸‰ç¨®ç”Ÿå‘½é€±æœŸ\">ğŸ’¡ å¯¦ä¾‹ç¯„ä¾‹ï¼šæ¯”è¼ƒä¸‰ç¨®ç”Ÿå‘½é€±æœŸ</h2>\n<p><code>ISampleService.cs</code></p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">ISampleService</span>\n&#123;\n    <span class=\"function\"><span class=\"built_in\">string</span> <span class=\"title\">GetId</span>()</span>;\n&#125;</code></pre>\n<p><code>SampleService</code></p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SampleService</span> : <span class=\"title\">ISampleService</span>\n&#123;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">string</span> _Id;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SampleService</span>()</span>\n    &#123;\n       _Id = Guid.NewGuid().ToString();\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">string</span> <span class=\"title\">GetId</span>()</span>\n    &#123;\n        <span class=\"keyword\">return</span> _Id;\n    &#125;\n&#125;</code></pre>\n<p><code>SampleController.cs</code></p>\n<pre><code class=\"highlight C#\">[<span class=\"meta\">Route(<span class=\"string\">&quot;api/[controller]&quot;</span>)</span>]\n[<span class=\"meta\">ApiController</span>]\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SampleController</span> : <span class=\"title\">ControllerBase</span>\n&#123;\n    <span class=\"comment\">// æ³¨å…¥ä¸‰ç¨®ä¸åŒç”Ÿå‘½é€±æœŸçš„æœå‹™</span>\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> ISampleService _singletonService;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> ISampleService _scopedService;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> ISampleService _transientService;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SampleController</span>(<span class=\"params\">[FromServices] ISampleService singletonService,</span></span>\n<span class=\"params\"><span class=\"function\">                            [FromServices] ISampleService scopedService,</span></span>\n<span class=\"params\"><span class=\"function\">                            [FromServices] ISampleService transientService</span>)</span>\n    &#123;\n        <span class=\"comment\">// è³¦å€¼çµ¦ç§æœ‰å­—æ®µ</span>\n        _singletonService = singletonService;\n        _scopedService = scopedService;\n        _transientService = transientService;\n    &#125;\n\n    [<span class=\"meta\">HttpGet</span>]\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">Get</span>()</span>\n    &#123;\n        <span class=\"comment\">// ç²å–æœå‹™çš„æ¨™è­˜ç¬¦</span>\n        <span class=\"keyword\">var</span> singletonId = _singletonService.GetId();\n        <span class=\"keyword\">var</span> scopedId = _scopedService.GetId();\n        <span class=\"keyword\">var</span> transientId = _transientService.GetId();\n\n        <span class=\"comment\">// è¿”å›çµæœ</span>\n        <span class=\"keyword\">return</span> Ok(<span class=\"keyword\">new</span>\n        &#123;\n            Singleton = singletonId,\n            Scoped = scopedId,\n            Transient = transientId\n        &#125;);\n    &#125;\n&#125;</code></pre>\n<p><code>å›å‚³ç¯„ä¾‹</code></p>\n<pre><code class=\"highlight json\"><span class=\"punctuation\">&#123;</span>\n  <span class=\"attr\">&quot;singleton&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;c17f2227-53b6-4689-8c4a-79b7955a6ff9&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;scoped&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;e95824da-a8f1-4bdf-9d73-d1036290cc44&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;transient&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;98e79f60-a51c-4142-906e-756200e3f6fe&quot;</span>\n<span class=\"punctuation\">&#125;</span></code></pre>\n<h2 id=\"ğŸ“š-åƒè€ƒåŠå»¶ä¼¸\">ğŸ“š åƒè€ƒåŠå»¶ä¼¸</h2>\n<p><a href=\"https://medium.com/@atailin.work/%E9%90%B5%E4%BA%BA%E8%B3%BD-asp-net-core-3-day04-%E4%BE%9D%E8%B3%B4%E6%B3%A8%E5%85%A5-dependency-injection-10cf9651b544\">éµäººè³½ ASP.NET Core 3 Day04 ä¾è³´æ³¨å…¥ (Dependency Injection)</a><br>\n<a href=\"https://marcus116.blogspot.com/2019/04/netcore-aspnet-core-di-lifetime.html\">ASP.NET Core DI ç”Ÿå‘½é€±æœŸ LifeTime</a><br>\n<a href=\"https://hackmd.io/@rgnkud/ByL9DP5op\">ä¾è³´æ³¨å…¥(DI)åœ¨å®¹å™¨ä¸­æœå‹™çš„ç”Ÿå‘½é€±æœŸ</a></p>\n","categories":["å¾Œç«¯"],"tags":["C#"]},{"title":"Dijkstra æ¼”ç®—æ³•","url":"/2025/05/07/dijstra/","content":"<h2 id=\"ğŸ§ -ç°¡è¿°\">ğŸ§  ç°¡è¿°</h2>\n<p>ç”±è·è˜­è¨ˆç®—æ©Ÿç§‘å­¸å®¶ Edsger W. Dijkstra æ–¼ 1956 å¹´æå‡º</p>\n<ul>\n<li>ç”¨ä¾†å°‹æ‰¾å–®ä¸€æºé»åˆ°å…¶ä»–ç¯€é»çš„æœ€çŸ­è·¯å¾‘</li>\n<li>é©ç”¨æ–¼åŠ æ¬Šåœ–(æ‰€ä»¥é‚Šçš„æ¬Šé‡ç‚ºæ­£)</li>\n<li>å¸¸ç”¨çš„è³‡æ–™çµæ§‹ : å„ªå…ˆä½‡åˆ—(Priority Queue) æˆ– æœ€å°å †(Min-Heap)</li>\n</ul>\n<h2 id=\"ğŸ§­-æ­¥é©Ÿ\">ğŸ§­ æ­¥é©Ÿ</h2>\n<ol>\n<li>å°‡æ‰€æœ‰ç¯€é»åˆ†ç‚ºå…©çµ„ï¼šå·²ç¢ºå®šæœ€çŸ­è·¯å¾‘ï¼ˆSï¼‰èˆ‡æœªç¢ºå®šï¼ˆUï¼‰</li>\n<li>åˆå§‹æ™‚ï¼Œèµ·é»åœ¨ Sï¼Œå…¶é¤˜åœ¨ Uï¼Œè·é›¢è¨­ç‚º âˆï¼Œèµ·é»è¨­ç‚º 0</li>\n<li>å¾ U ä¸­é¸æ“‡ç›®å‰èˆ‡èµ·é»è·é›¢æœ€çŸ­çš„ç¯€é»åŠ å…¥ S</li>\n<li>æ›´æ–°è©²ç¯€é»é„°æ¥é»çš„è·é›¢ï¼ˆé¬†å¼›ï¼‰</li>\n<li>é‡è¤‡æ­¥é©Ÿ 3~4ï¼Œç›´åˆ°æ‰€æœ‰ç¯€é»éƒ½åŠ å…¥ S æˆ–ç„¡æ³•å†æ›´æ–°</li>\n</ol>\n<h2 id=\"ğŸ§‘â€ğŸ’»-C-å¯¦ä½œï¼ˆå«ç¯„ä¾‹åœ–ï¼‰\">ğŸ§‘â€ğŸ’» C# å¯¦ä½œï¼ˆå«ç¯„ä¾‹åœ–ï¼‰</h2>\n<p><img src=\"/images/dijkstra/samplegraph.png\" alt=\"sampleGraph.png\"></p>\n<p>ä»¥ä¸‹ç‚ºå°æ‡‰åœ–å½¢çš„ C# ç¨‹å¼å¯¦ä½œ</p>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>()</span>\n&#123;\n    <span class=\"built_in\">int</span> n = <span class=\"number\">7</span>; <span class=\"comment\">// ç¯€é»æ•¸</span>\n    List&lt;Edge&gt;[] graph = <span class=\"keyword\">new</span> List&lt;Edge&gt;[n];\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) graph[i] = <span class=\"keyword\">new</span> List&lt;Edge&gt;();\n\n    <span class=\"comment\">// å»ºç«‹åœ–çš„é„°æ¥è¡¨ï¼ˆæ ¹æ“šåœ–åƒï¼‰</span>\n    AddEdge(graph, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>);\n    AddEdge(graph, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">6</span>);\n    AddEdge(graph, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>);\n    AddEdge(graph, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">8</span>);\n    AddEdge(graph, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">10</span>);\n    AddEdge(graph, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">15</span>);\n    AddEdge(graph, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>);\n    AddEdge(graph, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">2</span>);\n    AddEdge(graph, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">6</span>);\n\n    <span class=\"built_in\">int</span> start = <span class=\"number\">0</span>;\n    <span class=\"built_in\">int</span>[] dist = Dijkstra(graph, start);\n\n    Console.WriteLine(<span class=\"string\">&quot;èµ·é»åˆ°å„ç¯€é»çš„æœ€çŸ­è·é›¢&quot;</span>);\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)\n    &#123;\n        Console.WriteLine(<span class=\"string\">$&quot;åˆ°ç¯€é»<span class=\"subst\">&#123;i&#125;</span>çš„æœ€çŸ­è·é›¢ : <span class=\"subst\">&#123;dist[i]&#125;</span>&quot;</span>);\n    &#125;\n&#125;\n\n<span class=\"keyword\">class</span> <span class=\"title\">Edge</span>\n&#123;\n    <span class=\"keyword\">public</span> <span class=\"built_in\">int</span> To, Weight;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Edge</span>(<span class=\"params\"><span class=\"built_in\">int</span> to, <span class=\"built_in\">int</span> weight</span>)</span>\n    &#123;\n        To = to; Weight = weight;\n    &#125;\n&#125;\n\n<span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">AddEdge</span>(<span class=\"params\">List&lt;Edge&gt;[] graph, <span class=\"built_in\">int</span> <span class=\"keyword\">from</span>, <span class=\"built_in\">int</span> to, <span class=\"built_in\">int</span> weight</span>)</span>\n&#123;\n    graph[<span class=\"keyword\">from</span>].Add(<span class=\"keyword\">new</span> Edge(to, weight));\n    graph[to].Add(<span class=\"keyword\">new</span> Edge(<span class=\"keyword\">from</span>, weight)); <span class=\"comment\">// ç„¡å‘åœ–éœ€è¦é›™å‘é‚Š</span>\n&#125;\n\n<span class=\"function\"><span class=\"keyword\">static</span> <span class=\"built_in\">int</span>[] <span class=\"title\">Dijkstra</span>(<span class=\"params\">List&lt;Edge&gt;[] graph, <span class=\"built_in\">int</span> start</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> n = graph.Length;\n    <span class=\"built_in\">int</span>[] dist = <span class=\"keyword\">new</span> <span class=\"built_in\">int</span>[n];\n    <span class=\"built_in\">bool</span>[] visited = <span class=\"keyword\">new</span> <span class=\"built_in\">bool</span>[n];\n\n    <span class=\"comment\">// åˆå§‹åŒ–è·é›¢èˆ‡è¨ªå•ç‹€æ…‹</span>\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) dist[i] = <span class=\"built_in\">int</span>.MaxValue;\n    dist[start] = <span class=\"number\">0</span>;\n\n    <span class=\"comment\">// ä½¿ç”¨NET6+ çš„ PriorityQueue&lt;TElement, TPriority&gt;</span>\n    <span class=\"comment\">// èˆŠç‰ˆè¦è‡ªå·±å¯¦ä½œ MinHeap</span>\n    <span class=\"comment\">// ä½¿ç”¨å„ªå…ˆä½‡åˆ—è™•ç†ç¯€é»ï¼Œä¾è·é›¢æœ€å°å„ªå…ˆè™•ç†</span>\n    <span class=\"keyword\">var</span> pq = <span class=\"keyword\">new</span> PriorityQueue&lt;<span class=\"built_in\">int</span>, <span class=\"built_in\">int</span>&gt;();\n    pq.Enqueue(start, <span class=\"number\">0</span>);\n\n    <span class=\"keyword\">while</span> (pq.Count &gt; <span class=\"number\">0</span>)\n    &#123;\n        <span class=\"built_in\">int</span> u = pq.Dequeue();\n\n        <span class=\"comment\">// ç¢ºèªæ˜¯å¦è™•ç†éç¯€é»ï¼Œä¸¦æ›´æ–°è¨»è¨˜</span>\n        <span class=\"keyword\">if</span> (visited[u]) <span class=\"keyword\">continue</span>;\n        visited[u] = <span class=\"literal\">true</span>;\n\n        <span class=\"comment\">// éæ­·æ‰€æœ‰ç›¸é„°é‚Š</span>\n        <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> edge <span class=\"keyword\">in</span> graph[u])\n        &#123;\n            <span class=\"built_in\">int</span> v = edge.To;\n            <span class=\"built_in\">int</span> weight = edge.Weight;\n\n           <span class=\"comment\">// è‹¥å¾ u åˆ° v çš„æ–°è·é›¢æ›´çŸ­ï¼Œå‰‡æ›´æ–° dist ä¸¦æ”¾å…¥å„ªå…ˆä½‡åˆ—</span>\n            <span class=\"keyword\">if</span> (dist[u] + weight &lt; dist[v])\n            &#123;\n                dist[v] = dist[u] + weight;\n                pq.Enqueue(v, dist[v]);\n            &#125;\n        &#125;\n    &#125;\n\n    <span class=\"keyword\">return</span> dist;\n&#125;</code></pre>\n<p>è¼¸å‡ºçµæœ</p>\n<pre><code class=\"highlight ada\">èµ·é»åˆ°å„ç¯€é»çš„æœ€çŸ­è·é›¢\nåˆ°ç¯€é»<span class=\"number\">0</span>çš„æœ€çŸ­è·é›¢ : 0\nåˆ°ç¯€é»<span class=\"number\">1</span>çš„æœ€çŸ­è·é›¢ : 2\nåˆ°ç¯€é»<span class=\"number\">2</span>çš„æœ€çŸ­è·é›¢ : 6\nåˆ°ç¯€é»<span class=\"number\">3</span>çš„æœ€çŸ­è·é›¢ : 7\nåˆ°ç¯€é»<span class=\"number\">4</span>çš„æœ€çŸ­è·é›¢ : 17\nåˆ°ç¯€é»<span class=\"number\">5</span>çš„æœ€çŸ­è·é›¢ : 22\nåˆ°ç¯€é»<span class=\"number\">6</span>çš„æœ€çŸ­è·é›¢ : 19</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/chinese/news/dijkstras-shortest-path-algorithm-visual-introduction/\">https://www.freecodecamp.org/chinese/news/dijkstras-shortest-path-algorithm-visual-introduction/</a></li>\n<li><a href=\"https://medium.com/@amber.fragments/%E6%BC%94%E7%AE%97%E6%B3%95-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98-14-dijkstra-algorithm-%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%91%E6%BC%94%E7%AE%97%E6%B3%95-745983dd4332\">https://medium.com/@amber.fragments/æ¼”ç®—æ³•-å­¸ç¿’ç­†è¨˜-14-dijkstra-algorithm-æœ€çŸ­è·¯å¾‘æ¼”ç®—æ³•-745983dd4332</a></li>\n<li>chatgpt</li>\n</ul>\n","categories":["åŸºç¤"],"tags":["æ¼”ç®—æ³•"]},{"title":"Hello World","url":"/2024/11/19/hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\">Quick Start</h2>\n<h3 id=\"Create-a-new-post\">Create a new post</h3>\n<pre><code class=\"highlight bash\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\">Run server</h3>\n<pre><code class=\"highlight bash\">$ hexo server</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\">Generate static files</h3>\n<pre><code class=\"highlight bash\">$ hexo generate</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\">Deploy to remote sites</h3>\n<pre><code class=\"highlight bash\">$ hexo deploy</code></pre>\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"å‰ç«¯ç”ŸæˆPDF","url":"/2025/04/25/htmlpdf/","content":"<h2 id=\"å‰è¨€\">å‰è¨€</h2>\n<p>å› ç‚ºæ¥­å‹™éœ€æ±‚çš„é—œä¿‚ï¼Œéœ€è¦å°‡å¡«å¯«çš„è¡¨å–®è½‰æ›æˆ PDFï¼Œé€²è¡Œè³‡æ–™å„²å­˜ä¾›å¾ŒçºŒä½¿ç”¨<br>\næœ€ä¾¿æ·çš„æ–¹æ³•ç‚ºæ˜¯ä½¿ç”¨å‰ç«¯å¥—ä»¶<a href=\"https://html2canvas.hertzen.com/\">html2canvas</a>æ­é…<a href=\"https://github.com/parallax/jsPDF\">jspdf</a><br>\nåˆ©ç”¨<code>html2canvas</code>é€²è¡Œæˆªåœ–ï¼Œç„¶å¾Œè²¼åˆ°<code>jspdf</code>ç”¢ç”Ÿçš„ PDF æª”<br>\nä½†æœ€ç©©å¦¥çš„æ–¹æ³•å»ºè­°æ˜¯ä½¿ç”¨å¾Œç«¯æœå‹™å™¨å»å°ˆé–€ç”¢ç”Ÿ PDF æ¯”è¼ƒåˆé©(ex. <a href=\"https://wkhtmltopdf.org/\">wkhtmltopdf</a> æˆ–æ˜¯ <a href=\"https://pptr.dev/\">Puppeteer</a> )</p>\n<h2 id=\"Install\">Install</h2>\n<pre><code class=\"highlight cmake\">npm <span class=\"keyword\">install</span> html2canvas jspdf</code></pre>\n<h2 id=\"Usage\">Usage</h2>\n<p>pdfHelper.ts</p>\n<pre><code class=\"highlight ts\"><span class=\"keyword\">import</span> jsPDF <span class=\"keyword\">from</span> <span class=\"string\">&quot;jspdf&quot;</span>;\n<span class=\"keyword\">import</span> html2canvas <span class=\"keyword\">from</span> <span class=\"string\">&quot;html2canvas&quot;</span>;\n\n<span class=\"keyword\">export</span> <span class=\"keyword\">const</span> <span class=\"title function_\">generatePDF</span> = <span class=\"keyword\">async</span> (<span class=\"params\"><span class=\"attr\">id</span>: <span class=\"built_in\">string</span></span>) =&gt; &#123;\n  <span class=\"keyword\">try</span> &#123;\n    <span class=\"comment\">// å–å¾—è¦æ“·å–çš„éƒ¨åˆ†</span>\n    <span class=\"keyword\">const</span> el = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id) <span class=\"keyword\">as</span> <span class=\"title class_\">HTMLElement</span>;\n    <span class=\"keyword\">if</span> (!el) <span class=\"keyword\">return</span> <span class=\"string\">&quot;&quot;</span>;\n\n    <span class=\"comment\">// æˆªåœ–</span>\n    <span class=\"keyword\">const</span> canvas = <span class=\"keyword\">await</span> <span class=\"title function_\">html2canvas</span>(el, &#123;\n      <span class=\"attr\">useCORS</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// å…è¨±è·¨åŸŸåœ–ç‰‡</span>\n      <span class=\"attr\">scale</span>: <span class=\"number\">2</span>, <span class=\"comment\">// æé«˜æ¸…æ™°åº¦</span>\n    &#125;);\n\n    <span class=\"comment\">// è½‰æ›åœ–ç‰‡</span>\n    <span class=\"comment\">// toDataURL(&#123;è½‰æ›æ ¼å¼&#125;, &#123;å“è³ª&#125;)</span>\n    <span class=\"keyword\">const</span> imgData = canvas.<span class=\"title function_\">toDataURL</span>(<span class=\"string\">&quot;image/jpeg&quot;</span>, <span class=\"number\">0.7</span>);\n\n    <span class=\"comment\">// å‰µå»ºPDFæ–‡æª”</span>\n    <span class=\"keyword\">const</span> pdf = <span class=\"keyword\">new</span> <span class=\"title function_\">jsPDF</span>(&#123;\n      <span class=\"attr\">orientation</span>: <span class=\"string\">&quot;portrait&quot;</span>, <span class=\"comment\">// é é¢æ–¹å‘</span>\n      <span class=\"attr\">unit</span>: <span class=\"string\">&quot;pt&quot;</span>, <span class=\"comment\">// å–®ä½</span>\n      <span class=\"attr\">format</span>: <span class=\"string\">&quot;a4&quot;</span>, <span class=\"comment\">// ç´™å¼µå¤§å°</span>\n    &#125;);\n\n    <span class=\"comment\">// å–å¾—PDFå°ºå¯¸</span>\n    <span class=\"keyword\">const</span> pageWidth = pdf.<span class=\"property\">internal</span>.<span class=\"property\">pageSize</span>.<span class=\"title function_\">getWidth</span>();\n    <span class=\"keyword\">const</span> pageHeight = pdf.<span class=\"property\">internal</span>.<span class=\"property\">pageSize</span>.<span class=\"title function_\">getHeight</span>();\n\n    <span class=\"comment\">// èª¿æ•´ç‚ºA4å¯¬åº¦ä¸”ç¶­æŒåŸæœ¬å¯¬é«˜æ¯”</span>\n    <span class=\"keyword\">const</span> imgWidth = pageWidth;\n    <span class=\"keyword\">const</span> imgHeight = (canvas.<span class=\"property\">height</span> * imgWidth) / canvas.<span class=\"property\">width</span>;\n\n    <span class=\"comment\">// è‹¥åœ–åƒé«˜åº¦è¶…å‡ºé é¢é«˜åº¦ï¼Œå‰‡ç¸®å°</span>\n    <span class=\"keyword\">const</span> finalHeight = imgHeight &gt; pageHeight ? pageHeight : imgHeight;\n    <span class=\"keyword\">const</span> finalWidth = (canvas.<span class=\"property\">width</span> * finalHeight) / canvas.<span class=\"property\">height</span>;\n\n    <span class=\"comment\">// å¯é¸ï¼šè®“åœ–ç‰‡ç½®ä¸­</span>\n    <span class=\"keyword\">const</span> marginX = (pageWidth - finalWidth) / <span class=\"number\">2</span>;\n    <span class=\"keyword\">const</span> marginY = (pageHeight - finalHeight) / <span class=\"number\">2</span>;\n\n    <span class=\"comment\">// æ·»åŠ åœ–ç‰‡åˆ°PDF</span>\n    pdf.<span class=\"title function_\">addImage</span>(\n      imgData, <span class=\"comment\">// åœ–ç‰‡è³‡æ–™</span>\n      <span class=\"string\">&quot;JPEG&quot;</span>, <span class=\"comment\">// åœ–ç‰‡æ ¼å¼</span>\n      marginX, <span class=\"comment\">// Xåº§æ¨™</span>\n      marginY, <span class=\"comment\">// Yåº§æ¨™</span>\n      finalWidth, <span class=\"comment\">//åœ–ç‰‡å¯¬åº¦</span>\n      finalHeight, <span class=\"comment\">//åœ–ç‰‡é«˜åº¦</span>\n      <span class=\"literal\">undefined</span>, <span class=\"comment\">// åˆ¥å</span>\n      <span class=\"string\">&quot;FAST&quot;</span> <span class=\"comment\">// å£“ç¸®æ–¹æ³•</span>\n    );\n\n    <span class=\"comment\">// å–å¾—åŒ…å« Base64 çš„ Data URL</span>\n    <span class=\"keyword\">const</span> pdfDataUrl = pdf.<span class=\"title function_\">output</span>(<span class=\"string\">&quot;datauristring&quot;</span>);\n\n    <span class=\"comment\">// Data URL çš„æ ¼å¼é€šå¸¸æ˜¯ &quot;data:application/pdf;base64,BASE64_STRING&quot;</span>\n    <span class=\"comment\">// æˆ‘å€‘éœ€è¦æå–é€—è™Ÿå¾Œé¢çš„ Base64 éƒ¨åˆ†</span>\n    <span class=\"keyword\">const</span> base64String = pdfDataUrl.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;,&quot;</span>)[<span class=\"number\">1</span>];\n\n    <span class=\"keyword\">return</span> base64String;\n  &#125; <span class=\"keyword\">catch</span> (e) &#123;\n    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(e);\n    <span class=\"keyword\">throw</span> e;\n  &#125;\n&#125;;</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://html2canvas.hertzen.com/\">html2canvas</a></li>\n<li><a href=\"https://github.com/parallax/jsPDF\">jspdf</a></li>\n<li><a href=\"https://wkhtmltopdf.org/\">wkhtmltopdf</a></li>\n<li><a href=\"https://pptr.dev/\">Puppeteer</a></li>\n<li>ChatGpt</li>\n</ul>\n","categories":["å‰ç«¯"],"tags":["Vue"]},{"title":"ç°¡å–®è£½ä½œå¯äº’å‹•åœ–ç‰‡","url":"/2024/12/30/image-map/","content":"<h2 id=\"æ¦‚è¿°\">æ¦‚è¿°</h2>\n<p>åœ¨æ¥­å‹™ä¸Šéœ€è¦å°åœ–ç‰‡é€²è¡Œäº’å‹•æ“ä½œå»è¨ˆç®—åˆ†æ•¸ï¼Œç°¡å–®ç´€éŒ„ä¸€ä¸‹å¯¦ä½œéç¨‹</p>\n<h3 id=\"Step1\">Step1</h3>\n<p>å–å¾—åº•åœ–ï¼Œç„¶å¾Œåˆ©ç”¨ç›¸é—œå·¥å…·ï¼Œå°‡éœ€è¦é€²è¡Œäº’å‹•çš„å€å¡Šåˆ†å‡ºä¾†<br>\n<img src=\"/images/image_split.png\" alt=\"image_split.png\"></p>\n<h3 id=\"Step2\">Step2</h3>\n<p>å°‡äº’å‹•å€å¡Šè½‰æ›æˆ svgï¼Œ<a href=\"https://convertio.co/zh/png-svg/\">å·¥å…·</a>è½‰æ›å¾Œæ ¼å¼æ‡‰å¦‚ä¸‹</p>\n<pre><code class=\"highlight svg\"><span class=\"tag\">&lt;<span class=\"name\">svg</span> <span class=\"attr\">version</span>=<span class=\"string\">&quot;1.0&quot;</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://www.w3.org/2000/svg&quot;</span></span>\n<span class=\"tag\"> <span class=\"attr\">width</span>=<span class=\"string\">&quot;373.000000pt&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;567.000000pt&quot;</span> <span class=\"attr\">viewBox</span>=<span class=\"string\">&quot;0 0 373.000000 567.000000&quot;</span></span>\n<span class=\"tag\"> <span class=\"attr\">preserveAspectRatio</span>=<span class=\"string\">&quot;xMidYMid meet&quot;</span>&gt;</span>\n\n<span class=\"tag\">&lt;<span class=\"name\">g</span> <span class=\"attr\">transform</span>=<span class=\"string\">&quot;translate(0.000000,567.000000) scale(0.100000,-0.100000)&quot;</span></span>\n<span class=\"tag\"><span class=\"attr\">fill</span>=<span class=\"string\">&quot;#000000&quot;</span> <span class=\"attr\">stroke</span>=<span class=\"string\">&quot;none&quot;</span>&gt;</span>\n<span class=\"tag\">&lt;<span class=\"name\">path</span> <span class=\"attr\">d</span>=<span class=\"string\">&quot;M933 4763 c-28 -5 -78 -52 -87 -80 -20 -64 52 -155 108 -134 13 6 26</span></span>\n<span class=\"string\"><span class=\"tag\">7 29 4 11 -10 66 31 71 53 10 39 -5 112 -28 133 -23 22 -59 31 -93 24z&quot;</span>/&gt;</span>\n<span class=\"tag\">&lt;<span class=\"name\">path</span> <span class=\"attr\">d</span>=<span class=\"string\">&quot;M1213 4763 c-12 -2 -35 -16 -51 -31 -31 -30 -41 -88 -22 -137 11 -28</span></span>\n<span class=\"string\"><span class=\"tag\">67 -57 97 -51 61 11 86 29 101 68 32 84 -36 167 -125 151z&quot;</span>/&gt;</span>\n<span class=\"tag\">&lt;<span class=\"name\">path</span> <span class=\"attr\">d</span>=<span class=\"string\">&quot;M2628 4670 c-22 -6 -23 -10 -26 -123 l-3 -117 196 0 195 0 0 120 c0</span></span>\n<span class=\"string\"><span class=\"tag\">107 -2 120 -17 120 -137 4 -327 4 -345 0z&quot;</span>/&gt;</span>\n...\n<span class=\"tag\">&lt;/<span class=\"name\">svg</span>&gt;</span></code></pre>\n<p>å…¶ä¸­ path å°±æ˜¯å„å€‹äº’å‹•å€å¡Š</p>\n<h3 id=\"Step3\">Step3</h3>\n<p>è¨­å®š svg åº•åœ–èˆ‡å€å¡Šäº‹ä»¶ç¶å®š(ä½¿ç”¨è½‰æ›å‡ºä¾†çš„å€å¡Š Path)<br>\nå†æ ¹æ“šéœ€æ±‚å¾®èª¿ XY è»¸ translate è·Ÿç¸®æ”¾ scale å°é½Šåº•åœ–<br>\nä»¥ä¸‹ç‚ºé»æ“Šå€å¡Šå°±æœƒè®Šè‰²çš„ç°¡æ˜“å¯¦ä½œ(Vue Typescript)</p>\n<pre><code class=\"highlight ts\">&lt;template&gt;\n  <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">svg</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;500&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;500&quot;</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span>\n<span class=\"language-xml\">    <span class=\"comment\">&lt;!-- åº•åœ– --&gt;</span></span>\n<span class=\"language-xml\">    <span class=\"tag\">&lt;<span class=\"name\">image</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;src/assets/images/bg.png&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;500&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;500&quot;</span> /&gt;</span></span>\n<span class=\"language-xml\"></span>\n<span class=\"language-xml\">    <span class=\"comment\">&lt;!-- åœ–åƒäº’å‹•å€å¡Š --&gt;</span></span>\n<span class=\"language-xml\">    <span class=\"tag\">&lt;<span class=\"name\">g</span> <span class=\"attr\">transform</span>=<span class=\"string\">&quot;translate(55,528) scale(0.1,-0.1)&quot;</span>&gt;</span></span>\n<span class=\"language-xml\">      <span class=\"tag\">&lt;<span class=\"name\">path</span></span></span>\n<span class=\"tag\"><span class=\"language-xml\">        <span class=\"attr\">v-for</span>=<span class=\"string\">&quot;region in wpi_regions&quot;</span></span></span>\n<span class=\"tag\"><span class=\"language-xml\">        <span class=\"attr\">:key</span>=<span class=\"string\">&quot;region.id&quot;</span></span></span>\n<span class=\"tag\"><span class=\"language-xml\">        <span class=\"attr\">:d</span>=<span class=\"string\">&quot;region.path&quot;</span></span></span>\n<span class=\"tag\"><span class=\"language-xml\">        <span class=\"attr\">:fill</span>=<span class=\"string\">&quot;region.click ? &#x27;#F72C5B&#x27; : &#x27;#F4E0AF&#x27;&quot;</span></span></span>\n<span class=\"tag\"><span class=\"language-xml\">        @<span class=\"attr\">click</span>=<span class=\"string\">&quot;region.click = !region.click&quot;</span></span></span>\n<span class=\"tag\"><span class=\"language-xml\">      /&gt;</span></span>\n<span class=\"language-xml\">    <span class=\"tag\">&lt;/<span class=\"name\">g</span>&gt;</span></span>\n<span class=\"language-xml\">  <span class=\"tag\">&lt;/<span class=\"name\">svg</span>&gt;</span></span>\n&lt;/template&gt;\n\n<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">setup</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;ts&quot;</span>&gt;</span><span class=\"language-javascript\"></span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">  <span class=\"keyword\">const</span> wpi_regions = <span class=\"title function_\">ref</span>([</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">    &#123;</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">id</span>: <span class=\"string\">&quot;01&quot;</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">name</span>: <span class=\"string\">&quot;å³é¡³é¡é—œç¯€&quot;</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">click</span>: <span class=\"literal\">false</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">path</span>: <span class=\"string\">&quot;M933 4763 c-28 -5 -78 -52 -87 -80 -20 -64 52 -155 108 -134 13 6 26 7 29 4 11 -10 66 31 71 53 10 39 -5 112 -28 133 -23 22 -59 31 -93 24z&quot;</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">    &#125;,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">    &#123;</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">id</span>: <span class=\"string\">&quot;02&quot;</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">name</span>: <span class=\"string\">&quot;å·¦é¡³é¡é—œç¯€&quot;</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">click</span>: <span class=\"literal\">false</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">      <span class=\"attr\">path</span>: <span class=\"string\">&quot;M1213 4763 c-12 -2 -35 -16 -51 -31 -31 -30 -41 -88 -22 -137 11 -28 67 -57 97 -51 61 11 86 29 101 68 32 84 -36 167 -125 151z&quot;</span>,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">    &#125;,</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">    ...</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\">  ]);</span></span>\n<span class=\"language-javascript\"><span class=\"language-xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://chatgpt.com/\">ChatGpt</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Element/path\">https://developer.mozilla.org/en-US/docs/Web/SVG/Element/path</a></li>\n</ul>\n","categories":["å‰ç«¯"],"tags":["Vue"]},{"title":"C# è³‡æ–™å¿«å–","url":"/2024/11/20/imemorycahce/","content":"<h2 id=\"æ¦‚è¿°\">æ¦‚è¿°</h2>\n<p>æœ‰æ™‚å€™ä¸€äº›å¤§å‹è³‡æ–™ä¸”ç•°å‹•å°‘çš„è³‡æ–™<br>\næ¯æ¬¡ä½¿ç”¨å°±è¦å¾è³‡æ–™é‡æ–°æ’ˆå–å°±å¾ˆæµªè²»æ•ˆèƒ½è³‡æº<br>\né€™å€‹æ™‚å€™å°±æ˜¯å¿«å–å‡ºå ´çš„æ™‚å€™</p>\n<h2 id=\"Install\">Install</h2>\n<pre><code class=\"highlight powershell\">dotnet add package Microsoft.Extensions.Caching.Memory</code></pre>\n<h2 id=\"Extensions-cs\">Extensions.cs</h2>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">AddExtension</span>(<span class=\"params\"><span class=\"keyword\">this</span> IServiceCollection services</span>)</span>\n&#123;\n    services.AddMemoryCache();\n    <span class=\"comment\">// services.AddScoped&lt;CacheHelper&gt;(); //å¦‚æœæœ‰ä½¿ç”¨æ•´åˆå·¥å…·é¡</span>\n&#125;</code></pre>\n<h2 id=\"Usage\">Usage</h2>\n<pre><code class=\"highlight C#\">[<span class=\"meta\">Route(<span class=\"string\">&quot;api/[controller]&quot;</span>)</span>]\n [<span class=\"meta\">ApiController</span>]\n <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">DataController</span> : <span class=\"title\">ControllerBase</span>\n &#123;\n     <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> DataBaseService dataBaseService;\n     <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IMemoryCache memoryCache;\n\n     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">DataController</span>(<span class=\"params\">DataBaseService dataBaseService, IMemoryCache memoryCache</span>)</span>\n     &#123;\n         <span class=\"keyword\">this</span>.memoryCache = memoryCache;\n         <span class=\"keyword\">this</span>.dataBaseService = dataBaseService;\n     &#125;\n\n     [<span class=\"meta\">HttpGet(<span class=\"string\">&quot;/search&quot;</span>)</span>]\n     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">Search</span>(<span class=\"params\"><span class=\"built_in\">string</span> keyword</span>)</span>\n     &#123;\n        <span class=\"comment\">// å¾è¨˜æ†¶é«”å¿«å–æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ï¼Œæ²’å†å»è³‡æ–™åº«æ’ˆè³‡æ–™ä¸¦å„²å­˜å¿«å–</span>\n         <span class=\"keyword\">if</span> (memoryCache.TryGetValue(<span class=\"string\">&quot;MainDataCache&quot;</span>, <span class=\"keyword\">out</span> List&lt;Prs006&gt; dataList))\n         &#123;\n             <span class=\"keyword\">var</span> result = dataList?\n                 .Where(data =&gt; data.Ordnme?.Contains(keyword, StringComparison.OrdinalIgnoreCase) == <span class=\"literal\">true</span>\n                                || data.Scitn?.Contains(keyword, StringComparison.OrdinalIgnoreCase) == <span class=\"literal\">true</span>\n                                || data.Keyword?.Contains(keyword, StringComparison.OrdinalIgnoreCase) == <span class=\"literal\">true</span>)\n                 .ToList() ?? <span class=\"keyword\">new</span> List&lt;Prs006&gt;();\n\n             <span class=\"keyword\">return</span> Ok(result);\n         &#125;\n         <span class=\"keyword\">else</span>\n         &#123;\n             <span class=\"keyword\">var</span> dbData = <span class=\"keyword\">await</span> dataBaseService.GetDatas();\n             <span class=\"comment\">//å¯«å…¥è¨˜æ†¶é«”å„²å­˜ï¼Œä¸€å¤©å¾Œè‡ªå‹•éæœŸ</span>\n             memoryCache.Set(<span class=\"string\">&quot;MainDataCache&quot;</span>, dbData, TimeSpan.FromDays(<span class=\"number\">1</span>));\n\n             <span class=\"keyword\">var</span> result = dbData?\n                 .Where(data =&gt; data.Ordnme?.Contains(keyword, StringComparison.OrdinalIgnoreCase) == <span class=\"literal\">true</span>\n                                || data.Scitn?.Contains(keyword, StringComparison.OrdinalIgnoreCase) == <span class=\"literal\">true</span>\n                                || data.Keyword?.Contains(keyword, StringComparison.OrdinalIgnoreCase) == <span class=\"literal\">true</span>)\n                 .ToList() ?? <span class=\"keyword\">new</span> List&lt;Prs006&gt;();\n\n             <span class=\"keyword\">return</span> Ok(result);\n         &#125;\n     &#125;</code></pre>\n<h2 id=\"CacheHelper-cs-Optional\">CacheHelper.cs(Optional)</h2>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">CacheHelper</span>\n&#123;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IMemoryCache cache;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CacheHelper</span>(<span class=\"params\">IMemoryCache cache</span>)</span>\n    &#123;\n        <span class=\"keyword\">this</span>.cache = cache;\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Set</span>&lt;<span class=\"title\">T</span>&gt;(<span class=\"params\"><span class=\"built_in\">string</span> key, T <span class=\"keyword\">value</span>, <span class=\"built_in\">int</span> expire = <span class=\"number\">300</span></span>)</span>\n    &#123;\n        <span class=\"keyword\">var</span> options = <span class=\"keyword\">new</span> MemoryCacheEntryOptions\n        &#123;\n            AbsoluteExpirationRelativeToNow = TimeSpan.FromSeconds(expire),\n        &#125;;\n        cache.Set(key, <span class=\"keyword\">value</span>, options);\n    &#125;\n\n    <span class=\"keyword\">public</span> T? Get&lt;T&gt;(<span class=\"built_in\">string</span> key)\n    &#123;\n        cache.TryGetValue&lt;T&gt;(key, <span class=\"keyword\">out</span> <span class=\"keyword\">var</span> <span class=\"keyword\">value</span>);\n        <span class=\"keyword\">return</span> <span class=\"keyword\">value</span>;\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Remove</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span>\n    &#123;\n        cache.Remove(key);\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Update</span>&lt;<span class=\"title\">T</span>&gt;(<span class=\"params\"><span class=\"built_in\">string</span> key, T <span class=\"keyword\">value</span>, <span class=\"built_in\">int</span> expire</span>)</span>\n    &#123;\n        cache.Remove(key);\n        Set&lt;T&gt;(key, <span class=\"keyword\">value</span>, expire);\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">bool</span> <span class=\"title\">Contains</span>(<span class=\"params\"><span class=\"built_in\">string</span> key</span>)</span>\n    &#123;\n        <span class=\"keyword\">return</span> cache.TryGetValue(key, <span class=\"keyword\">out</span> _);\n    &#125;\n&#125;</code></pre>\n","categories":["å¾Œç«¯"],"tags":["C#","Cache"]},{"title":"è¿­ä»£èˆ‡éè¿´","url":"/2024/11/27/iteration-and-recursion/","content":"<p><code>è¿­ä»£(iteration)</code>æ˜¯ä¸€ç¨®é‡è¤‡åŸ·è¡Œä»»å‹™çš„æ§åˆ¶çµæ§‹<br>\nåœ¨ä¸€å®šçš„<code>æ¢ä»¶</code>ä¸‹é‡è¤‡åŸ·è¡Œï¼Œç›´åˆ°<code>æ¢ä»¶</code>ä¸å†æ»¿è¶³</p>\n<ul>\n<li>for<br>\næœ€å¸¸è¦‹çš„è¿­ä»£å½¢å¼</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">ForLoop</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> result = <span class=\"number\">0</span>;\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i--)\n    &#123;\n        result += i;\n    &#125;\n    <span class=\"keyword\">return</span> result;\n&#125;</code></pre>\n<ul>\n<li>while<br>\nwhile è·Ÿ for é¡ä¼¼ï¼Œä½†æ˜¯ while æœƒæ¯”è¼ƒå¥½æ§åˆ¶æ¢ä»¶çš„è¨­å®šèˆ‡è®ŠåŒ–<br>\nfor çš„ç¨‹å¼ç¢¼è¼ƒç°¡æ½”ã€while çš„è¿´åœˆæ§åˆ¶è¼ƒéˆæ´»</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">WhileLoop</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> result = <span class=\"number\">0</span>;\n    <span class=\"built_in\">int</span> i = <span class=\"number\">1</span>; <span class=\"comment\">//åˆå§‹æ¢ä»¶</span>\n    <span class=\"keyword\">while</span> (i &lt;= n)\n    &#123;\n        result += i;\n        <span class=\"comment\">//æ›´æ–°æ¢ä»¶</span>\n        i +=<span class=\"number\">1</span>;\n        i *=<span class=\"number\">2</span>;\n    &#125;\n    <span class=\"keyword\">return</span> result;\n&#125;</code></pre>\n<ul>\n<li>å·¢ç‹€<br>\nè¿´åœˆåŒ…è¿´åœˆ</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">string</span> <span class=\"title\">NestForLoop</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"keyword\">var</span> result = <span class=\"keyword\">new</span> StringBuilder();\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">1</span>; i &lt;= n; i++)\n    &#123;\n        <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> j = <span class=\"number\">1</span>; j &lt;= n; j++)\n        &#123;\n            result.Append(<span class=\"string\">$&quot;(<span class=\"subst\">&#123;i&#125;</span>,<span class=\"subst\">&#123;j&#125;</span>)&quot;</span>);\n        &#125;\n    &#125;\n    <span class=\"keyword\">return</span> result.ToString();\n&#125;</code></pre>\n<h2 id=\"éè¿´\">éè¿´</h2>\n<p><code>éè¿´(recursion)</code>å‡½å¼å‘¼å«è‡ªå·±æœ¬èº«<br>\n<strong>ä¸»è¦ä¸‰è¦ç´ </strong></p>\n<ol>\n<li>çµ‚æ­¢æ¢ä»¶ : ä»€éº¼æ™‚å€™çµæŸå¾€ä¸‹å±¤å‚³é</li>\n<li>éè¿´å‘¼å« : å°‡åƒæ•¸å¾€ä¸‹å±¤å‚³éçµ¦è‡ªå·±</li>\n<li>çµæœè¿”å› : å›å‚³çµæœçµ¦ä¸Šå±¤</li>\n</ol>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">Recur</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"comment\">// çµ‚æ­¢æ¢ä»¶</span>\n    <span class=\"keyword\">if</span> (n == <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;\n    <span class=\"comment\">// éè¿´å‘¼å«</span>\n    <span class=\"built_in\">int</span> res = Recur(n - <span class=\"number\">1</span>);\n    <span class=\"comment\">// è¿”å›çµæœ</span>\n    <span class=\"keyword\">return</span> n + res;\n&#125;</code></pre>\n<p><img src=\"/images/recursion_sum_depth.png\" alt=\"recursion_sum_depth.png\"></p>\n<p>ç”±æ–¼éè¿´æ¯æ¬¡éƒ½è¦å‘¼å«é‡æ–°ç”¢ç”Ÿæœ¬èº«å‡½å¼ï¼Œæœƒæœ‰é¡å¤–çš„è³‡æºé–‹éŠ·<br>\næ‰€ä»¥éè¿´çš„æ¬¡æ•¸æ˜¯æœ‰é™çš„ï¼Œå¤ªå¤šè¨˜æ†¶é«”æœƒçˆ†ç‚¸ï¼Œæ•ˆç‡ä¹Ÿæœƒæ¯”è¿­ä»£ä¾†çš„ä½</p>\n<h2 id=\"æ¯”è¼ƒ\">æ¯”è¼ƒ</h2>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>è¿­ä»£</th>\n<th>éè¿´</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>æ•ˆç‡</td>\n<td>è¼ƒé«˜ï¼Œæ²’æœ‰å‡½å¼ç”¢ç”Ÿé–‹éŠ·</td>\n<td>æ¯æ¬¡éè¿´å‘¼å«éƒ½æœ‰ç”¢ç”Ÿé–‹éŠ·</td>\n</tr>\n<tr>\n<td>è¨˜æ†¶é«”</td>\n<td>é€šå¸¸å›ºå®šå¤§å°</td>\n<td>æ ¹æ“šéè¿´å‡½å¼ç”¢ç”Ÿå ç”¨å¤§é‡è¨˜æ†¶é«”</td>\n</tr>\n<tr>\n<td>é©ç”¨</td>\n<td>ç°¡å–®ä»»å‹™ã€ç›´è§€ã€å¯è®€ä½³</td>\n<td>è¤‡é›œä»»å‹™åˆ†è§£(æ¨¹ã€åœ–ã€åˆ†æ²»ã€å›æº¯ç­‰)ã€çµæ§‹æ˜ç¢º</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://www.hello-algo.com/zh-hant/chapter_computational_complexity/iteration_and_recursion/\">https://www.hello-algo.com/zh-hant/chapter_computational_complexity/iteration_and_recursion/</a></li>\n<li><a href=\"https://hackmd.io/@PythonTutor/By9P6avKd#%E9%81%9E%E8%BF%B4VS%E8%BF%AD%E4%BB%A3-%E5%8F%AF%E8%AE%80%E6%80%A7%E8%88%87%E5%8F%AF%E6%94%B9%E6%80%A7\">https://hackmd.io/@PythonTutor/By9P6avKd#éè¿´VSè¿­ä»£-å¯è®€æ€§èˆ‡å¯æ”¹æ€§</a></li>\n</ul>\n","categories":["åŸºç¤"],"tags":["è¿­ä»£"]},{"title":"LINQ","url":"/2024/12/11/linq-search/","content":"<h3 id=\"LINQ-Language-Integrated-Query\">LINQ ( Language Integrated Query)</h3>\n<p>å¾®è»Ÿé–‹ç™¼çš„æŠ€è¡“<code>å…·æœ‰æŸ¥è©¢è³‡æ–™çš„ç¨‹å¼èªè¨€</code><br>\nè®“å·¥ç¨‹å¸«èƒ½å¤ ä½¿ç”¨åŸç”Ÿ C#å°è³‡æ–™é€²è¡Œè™•ç†<br>\nä¸”ç›¸åŒèªæ³•å¯ä»¥æŸ¥è©¢ä¸åŒé¡å‹çš„è³‡æ–™ï¼Œé™ä½å­¸ç¿’æˆæœ¬<br>\næ“´å……é¡å‹ :</p>\n<ul>\n<li>LINQ to Objects</li>\n<li>LINQ to SQL</li>\n<li>LINQ to XML</li>\n<li>â€¦etc</li>\n</ul>\n<h2 id=\"LINQ-æŸ¥è©¢çš„å…©ç¨®èªæ³•\">LINQ æŸ¥è©¢çš„å…©ç¨®èªæ³•</h2>\n<ol>\n<li>æŸ¥è©¢è¡¨é”å¼ ( Query Expression Syntax )</li>\n</ol>\n<ul>\n<li>é¡ä¼¼ SQL çš„èªæ³• : ä½¿ç”¨ select ã€ from ã€where ç­‰é—œéµå­—</li>\n<li>è¼ƒå®¹æ˜“ç†è§£</li>\n<li>çµæ§‹å›ºå®š : å¿…é ˆ from èµ·å§‹ï¼Œselect æˆ– group by çµå°¾</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>()</span>\n&#123;\n    <span class=\"comment\">// Data source.</span>\n    <span class=\"built_in\">int</span>[] scores = <span class=\"keyword\">new</span> <span class=\"built_in\">int</span>[] &#123; <span class=\"number\">90</span>, <span class=\"number\">71</span>, <span class=\"number\">82</span>, <span class=\"number\">93</span>, <span class=\"number\">75</span>, <span class=\"number\">82</span> &#125;;\n\n    <span class=\"comment\">// Query Expression.</span>\n    IEnumerable&lt;<span class=\"built_in\">int</span>&gt; scoreQuery = <span class=\"comment\">//query variable</span>\n        <span class=\"keyword\">from</span> score <span class=\"keyword\">in</span> scores <span class=\"comment\">//required</span>\n        <span class=\"keyword\">where</span> score &gt; <span class=\"number\">80</span> <span class=\"comment\">// optional</span>\n        <span class=\"keyword\">orderby</span> score <span class=\"keyword\">descending</span> <span class=\"comment\">// optional</span>\n        <span class=\"keyword\">select</span> score; <span class=\"comment\">//must end with select or group</span>\n\n    <span class=\"comment\">// Execute the query to produce the results</span>\n    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> testScore <span class=\"keyword\">in</span> scoreQuery)\n    &#123;\n        Console.WriteLine(testScore);\n    &#125;\n\n    <span class=\"comment\">// Output: 93 90 82 82</span>\n&#125;</code></pre>\n<ol start=\"2\">\n<li>æµåˆ©èªæ³•ï¼ˆFluent Syntaxï¼‰</li>\n</ol>\n<ul>\n<li>éˆæ´»æ€§é«˜ : å¯ä»¥æ–¹ä¾¿åœ°éˆçµèª¿ç”¨å¤šå€‹æ–¹æ³•</li>\n<li>Lambda è¡¨é”å¼ : ä»£ç¢¼ç°¡æ½”</li>\n<li>æ²’æœ‰å›ºå®šçµæ§‹ : æ²’æœ‰ç‰¹å®šçš„é–‹å§‹æˆ–çµæŸèªå¥</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>()</span>\n&#123;\n    <span class=\"comment\">// Data source.</span>\n    <span class=\"built_in\">int</span>[] scores = <span class=\"keyword\">new</span> <span class=\"built_in\">int</span>[] &#123; <span class=\"number\">90</span>, <span class=\"number\">71</span>, <span class=\"number\">82</span>, <span class=\"number\">93</span>, <span class=\"number\">75</span>, <span class=\"number\">82</span> &#125;;\n\n    <span class=\"comment\">// Query Expression.</span>\n    <span class=\"keyword\">var</span> scoreQuery = scores\n        .Where(score =&gt; score &gt; <span class=\"number\">80</span>)\n        .OrderByDescending(score =&gt; score);\n\n    <span class=\"comment\">// Execute the query to produce the results</span>\n    <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> testScore <span class=\"keyword\">in</span> scoreQuery)\n    &#123;\n        Console.WriteLine(testScore);\n    &#125;\n\n    <span class=\"comment\">// Output: 93 90 82 82</span>\n&#125;</code></pre>\n<table>\n<thead>\n<tr>\n<th>ç‰¹å¾µ</th>\n<th>æŸ¥è©¢è¡¨é”å¼</th>\n<th>æµåˆ©èªæ³•</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>é¢¨æ ¼</td>\n<td>é¡ä¼¼ sql</td>\n<td>æ–¹æ³•éˆçµ</td>\n</tr>\n<tr>\n<td>å¯è®€æ€§</td>\n<td>é«˜</td>\n<td>ä¸­</td>\n</tr>\n<tr>\n<td>çµæ§‹è¦æ±‚</td>\n<td>from é–‹é ­ã€select æˆ– group by çµå°¾</td>\n<td>ç„¡ç‰¹å®šè¦æ±‚</td>\n</tr>\n<tr>\n<td>éˆæ´»æ€§</td>\n<td>æŸäº›æƒ…æ³ä¸‹è¼ƒä½</td>\n<td>æ›´é«˜çš„éˆæ´»æ€§ï¼Œå°¤å…¶æ˜¯å‹•æ…‹</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h3>\n<ul>\n<li><a href=\"https://zh.wikipedia.org/zh-tw/%E8%AF%AD%E8%A8%80%E9%9B%86%E6%88%90%E6%9F%A5%E8%AF%A2\">https://zh.wikipedia.org/zh-tw/è¯­è¨€é›†æˆæŸ¥è¯¢</a></li>\n<li><a href=\"https://www.perplexity.ai/\">https://www.perplexity.ai/</a></li>\n<li><a href=\"https://ithelp.ithome.com.tw/articles/10194251\">https://ithelp.ithome.com.tw/articles/10194251</a></li>\n</ul>\n","categories":["å¾Œç«¯"],"tags":["C#","linq"]},{"title":"ç³»çµ±æ¶æ§‹","url":"/2025/02/13/linuxSysArc/","content":"<h2 id=\"BIOS\">BIOS</h2>\n<h3 id=\"åŸºæœ¬è¼¸å…¥è¼¸å‡ºç³»çµ±-Basic-Input-Output-System\">åŸºæœ¬è¼¸å…¥è¼¸å‡ºç³»çµ±(Basic Input/Output System)</h3>\n<p>ä¸»è¦ä½œç”¨ç‚º<code>å°‡ç³»çµ±ç¡¬é«”å¸¶åˆ°å¯ä»¥æº–å‚™äº¤çµ¦ä½œæ¥­ç³»çµ±çš„ç‹€æ…‹</code>ï¼Œé€šå¸¸åŒ…å«ä¸‹åˆ—æ­¥é©Ÿ:</p>\n<ul>\n<li>ç³»çµ±åˆå§‹åŒ–</li>\n<li>æ¸¬è©¦è¨˜æ†¶é«”èˆ‡å…¶ä»–å‘¨é‚Š</li>\n<li>æª¢æ¸¬å„²å­˜è£ç½®</li>\n<li>åœ¨æ•¸å€‹å„²å­˜è£ç½®ä¹‹é–“æ‰¾å‡ºä½œæ¥­ç³»çµ±çš„èµ·å§‹é»</li>\n</ul>\n<p>ä¸”æä¾›æ“ä½œä»‹é¢ï¼Œä¾›ä½¿ç”¨è€…è¨­å®šç³»çµ±çš„ä½éšåƒæ•¸ã€é¸æ“‡é–‹æ©Ÿè£ç½®ã€é…ç½®ç³»çµ±è³‡æºç­‰ç­‰ã€‚</p>\n<h3 id=\"æ—¥æœŸèˆ‡æ™‚é–“\">æ—¥æœŸèˆ‡æ™‚é–“</h3>\n<p>BIOS çš„ä¸»è¦åŠŸèƒ½ä¹‹ä¸€æ˜¯<code>ç®¡ç†ä¸»æ©Ÿæ¿å…§å»ºçš„ç¡¬é«”æ™‚é˜</code>ã€‚<br>\n<code>ä½œæ¥­ç³»çµ±æœ¬èº«ä¹Ÿæœ‰è¨­å®šç¡¬é«”æ™‚é˜çš„èƒ½åŠ›</code>ï¼Œå¯ä»¥ä¾é ç²¾æº–çš„å¤–éƒ¨è¼ƒæ™‚åƒè€ƒä¾†æº(ex: NTPD ä¼ºæœå™¨)ä¾†ä¿æŒç¡¬é«”æ™‚é˜çš„ç²¾æº–ã€‚</p>\n<h3 id=\"ç£ç¢Ÿèˆ‡é–‹æ©Ÿè£ç½®\">ç£ç¢Ÿèˆ‡é–‹æ©Ÿè£ç½®</h3>\n<p>BIOS è¨­å®šå·¥å…·ä¸­å…¶ä¸­ä¸€é …é‡è¦åŠŸèƒ½å°±æ˜¯<code>é–‹æ©Ÿè£ç½®çš„é¸æ“‡</code>ã€‚<br>\nå¤§å¤šæ•¸ PC è‡³å°‘æ”¯æ´ä¸‰ç¨®é–‹æ©Ÿåª’é«”</p>\n<ul>\n<li>å…§æ¥å¼ç¡¬ç¢Ÿ(IDE æˆ– SCSI æˆ– SATAï¼Œæˆ–ä¸‰è€…çš†æ˜¯)</li>\n<li>å…‰ç¢Ÿæ©Ÿ(åŒä¸Š)</li>\n<li>è»Ÿç¢Ÿæ©Ÿ</li>\n</ul>\n<h3 id=\"é‹ç”¨-proc-æª”æ¡ˆç³»çµ±\">é‹ç”¨/proc æª”æ¡ˆç³»çµ±</h3>\n<p>/proc æª”æ¡ˆç³»çµ± (æ ¸å¿ƒçš„é‹ä½œç‹€æ…‹åº«)ç›®éŒ„ä¸‹çš„ interruptsã€dmaã€ioports ä¸‰å€‹æª”æ¡ˆï¼Œæä¾›ç›®å‰ç³»çµ±è³‡æºçš„ä½¿ç”¨ç‹€æ³</p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /proc/interrupts</code></pre>\n<p><img src=\"/images/linuxSysArc/proc_interrupts.png\" alt=\"interrupts.png\"></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /proc/dma</code></pre>\n<p><img src=\"/images/linuxSysArc/proc_dma.png\" alt=\"interrupts.png\"></p>\n<pre><code class=\"highlight bash\"><span class=\"built_in\">cat</span> /proc/ioports</code></pre>\n<p><img src=\"/images/linuxSysArc/proc_ioports.png\" alt=\"interrupts.png\"></p>\n<h2 id=\"USB\">USB</h2>\n<h3 id=\"USB-æ‹“æ¨¸é‚è¼¯\">USB æ‹“æ¨¸é‚è¼¯</h3>\n<p>é›»è…¦ä¸»æ©Ÿèˆ‡ USB è£ç½®ä¹‹é–“ï¼Œæ˜¯é€é<code>é›†ç·šå™¨(HUB)</code>é€£æ¥ä¸€èµ·ï¼Œæ§‹æˆä¸€å€‹æ¨¹ç‹€çµæ§‹ã€‚<br>\nä½¿ç”¨<code>lsusb</code>æŒ‡ä»¤å¯é¡¯ç¤º Linux ç³»çµ±ä¸Šæ‰€æœ‰ USB è£ç½®çš„å¯¦éš›é€£æ¥æ–¹å¼ã€‚</p>\n<p><img src=\"/images/linuxSysArc/lsusb.png\" alt=\"lsusb.png\"></p>\n<h3 id=\"USB-æ§åˆ¶å™¨\">USB æ§åˆ¶å™¨</h3>\n<p>ä¸»è¦åˆ†æˆ 4 ç¨®é¡å‹</p>\n<ul>\n<li>é–‹æ”¾å‹ä¸»æ§ç•Œé¢ ( Open Host Controller Interface , OHCI )</li>\n<li>é€šç”¨å‹ä¸»æ§ç•Œé¢ ( Universal Host Controller Interface , UJCI )</li>\n<li>å¼·åŒ–å‹ä¸»æ§ç•Œé¢ ( Enhanced Host Controller Interface , EHCI )</li>\n<li>æ“´å……å‹ä¸»æ§ç•Œé¢ ( eXtented Host Controller Interface , xHCI )</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>è¦æ ¼</th>\n<th>æ§åˆ¶å™¨</th>\n<th>å‚³è¼¸é€Ÿç‡</th>\n<th>å‘ä¸‹ç›¸å®¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>USB1.1</td>\n<td>OHCIã€UHCI</td>\n<td>12Mbps</td>\n<td>å¦</td>\n</tr>\n<tr>\n<td>USB2.0</td>\n<td>EHCI</td>\n<td>480Mbps</td>\n<td>å¦</td>\n</tr>\n<tr>\n<td>USB3.0</td>\n<td>xHCI</td>\n<td>5Gbps</td>\n<td>æ˜¯</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"USB-è£ç½®\">USB è£ç½®</h3>\n<ul>\n<li>äººæ©Ÿç•Œé¢è£ç½® ( Human Interface Device , HID)<br>\nè¼¸å…¥è£ç½® (æ»‘é¼ ã€éµç›¤â€¦ç­‰ç­‰)</li>\n<li>é€šè¨Šè£ç½®<br>\næ•¸æ“šæ©Ÿ</li>\n<li>å¤§é‡å„²å­˜è£ç½®<br>\nç£ç¢Ÿæ©Ÿã€è®€å¡æ©Ÿâ€¦ç­‰</li>\n<li>éŸ³è¨Š<br>\næšè²å™¨ã€éŸ³æ•ˆè£ç½®</li>\n<li>IrDA<br>\nç´…å¤–ç·šè£ç½®</li>\n<li>å°è¡¨æ©Ÿ<br>\nå°è¡¨æ©Ÿä»¥åŠ USB-to-parallel è½‰æ›å™¨</li>\n</ul>\n<h3 id=\"USB-é©…å‹•ç¨‹å¼\">USB é©…å‹•ç¨‹å¼</h3>\n<p><code>Linux æ ¸å¿ƒ 2.0.x ä»¥åŠæ›´æ—©ç‰ˆæœ¬ï¼Œä¸æ”¯æ´ USB</code></p>\n<p>ä¸»è¦åˆ†æˆä¸‰å¤§é¡</p>\n<ol>\n<li>ä¸»æ§å™¨é©…å‹•ç¨‹å¼</li>\n<li>é€šé¡é©…å‹•ç¨‹å¼</li>\n<li>é›œé …è£ç½®é©…å‹•ç¨‹å¼</li>\n</ol>\n<h3 id=\"USB-ç†±æ’æ‹”\">USB ç†±æ’æ‹”</h3>\n<p>æ¨¡çµ„åŒ–çš„ USB é©…å‹•ç¨‹å¼ï¼Œæ˜¯è—‰ç”±æ ¸å¿ƒå°æ–¼/sbin/hotplug çš„é€šç”¨æ”¯æ´æ©Ÿåˆ¶ä¾†è¼‰å…¥</p>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://www.books.com.tw/products/0010517791?srsltid=AfmBOoqFrQZp9GsdBk5fTNGzq01OkJ2O4TBNwF0sK7VWkoij1MlNaG1X\">LPI Linux ç¬¬ä¸€ç´šè³‡æ ¼æª¢å®š ç¬¬ä¸‰ç‰ˆ</a></li>\n</ul>\n","categories":["åŸºç¤"],"tags":["linux"]},{"title":"C# Web apiä½¿ç”¨Quartzé€²è¡Œä¸€æ¬¡æ€§æ’ç¨‹","url":"/2024/11/19/quartz/","content":"<h2 id=\"Install\">Install</h2>\n<pre><code class=\"highlight powershell\"><span class=\"built_in\">Install-Package</span> Quartz.AspNetCore\n<span class=\"built_in\">Install-Package</span> Quartz.Extensions.DependencyInjection\n<span class=\"built_in\">Install-Package</span> Quartz.Serialization.Json</code></pre>\n<h2 id=\"appsetting-json\">appsetting.json</h2>\n<p>é€™é‚Šä½¿ç”¨ Oracle è³‡æ–™åº«åšç‚ºæŒä¹…åŒ–å„²å­˜<a href=\"https://github.com/quartznet/quartznet/tree/main/database/tables\">å„é¡è³‡æ–™åº«è…³æœ¬</a></p>\n<pre><code class=\"highlight json\"><span class=\"attr\">&quot;Quartz&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span>\n  <span class=\"attr\">&quot;quartz.scheduler.instanceName&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;QuartzOracleScheduler&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.scheduler.instanceId&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;AUTO&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.jobStore.type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Quartz.Impl.AdoJobStore.JobStoreTX, Quartz&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.jobStore.useProperties&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;true&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.jobStore.dataSource&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;default&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.jobStore.tablePrefix&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;QRTZ_&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.jobStore.driverDelegateType&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Quartz.Impl.AdoJobStore.OracleDelegate, Quartz&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.dataSource.default.provider&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;OracleODPManaged&quot;</span><span class=\"punctuation\">,</span>\n  <span class=\"attr\">&quot;quartz.dataSource.default.connectionString&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Your Connection String&quot;</span>\n<span class=\"punctuation\">&#125;</span></code></pre>\n<h2 id=\"Job-cs\">Job.cs</h2>\n<pre><code class=\"highlight C#\"> <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">SendTasJob</span> : <span class=\"title\">IJob</span>\n &#123;\n     <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task <span class=\"title\">Execute</span>(<span class=\"params\">IJobExecutionContext context</span>)</span>\n     &#123;\n         <span class=\"comment\">//Jobè¦å¯¦ä½œçš„å…§å®¹</span>\n          <span class=\"keyword\">var</span> tasid = context.MergedJobDataMap.GetString(<span class=\"string\">&quot;tasid&quot;</span>);\n          <span class=\"keyword\">var</span> welcomeText = context.MergedJobDataMap.GetString(<span class=\"string\">&quot;welcomeText&quot;</span>);\n          Console.WriteLine(tasid + welcomeText);\n          <span class=\"keyword\">return</span> Task.CompletedTask;\n     &#125;\n&#125;</code></pre>\n<h2 id=\"Controller-cs\">Controller.cs</h2>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">TasController</span> : <span class=\"title\">ControllerBase</span>\n&#123;\n\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> ISchedulerFactory schedulerFactory;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IdGenerator idGenerator;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TasController</span>(<span class=\"params\">ISchedulerFactory schedulerFactory,</span></span>\n<span class=\"params\"><span class=\"function\">                         IdGenerator idGenerator</span>)</span>\n    &#123;\n        <span class=\"keyword\">this</span>.schedulerFactory = schedulerFactory;\n        <span class=\"keyword\">this</span>.idGenerator = idGenerator;\n    &#125;\n\n    [<span class=\"meta\">HttpPost(<span class=\"string\">&quot;[action]&quot;</span>)</span>]\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">ScheduleTasJob</span>(<span class=\"params\">TasJobRequest request</span>)</span>\n    &#123;\n        <span class=\"comment\">// ä½¿ç”¨ SchedulerFactory å–å¾— Scheduler</span>\n        <span class=\"keyword\">var</span> sch = <span class=\"keyword\">await</span> schedulerFactory.GetScheduler();\n       <span class=\"comment\">// é›ªèŠ±ç®—æ³•ç”¢Id</span>\n        <span class=\"keyword\">var</span> jobid = idGenerator.CreateId();\n        <span class=\"keyword\">var</span> jobKey = <span class=\"keyword\">new</span> JobKey(<span class=\"string\">$&quot;TasJob-<span class=\"subst\">&#123;jobid&#125;</span>&quot;</span>, <span class=\"string\">&quot;TasJobs&quot;</span>);\n        <span class=\"keyword\">var</span> triggerKey = <span class=\"keyword\">new</span> TriggerKey(<span class=\"string\">$&quot;TasJobTrigger-<span class=\"subst\">&#123;jobid&#125;</span>&quot;</span>, <span class=\"string\">&quot;TasJobs&quot;</span>);\n\n        <span class=\"comment\">// å»ºç«‹Job</span>\n        <span class=\"keyword\">var</span> job = JobBuilder.Create&lt;SendTasJob&gt;()\n            .WithIdentity(jobKey)\n             <span class=\"comment\">//key value å¦‚æœæœ‰é–‹å•ŸUseProperties åªèƒ½æœ‰stringå‹åˆ¥</span>\n            .UsingJobData(<span class=\"string\">&quot;tasid&quot;</span>, request.TasId)\n            .UsingJobData(<span class=\"string\">&quot;welcomeText&quot;</span>, request.WelcomeText)\n            .StoreDurably() <span class=\"comment\">// ä½¿ä»»å‹™æŒä¹…åŒ–</span>\n            .Build();\n\n        <span class=\"comment\">// è¨­å®šTrigger</span>\n        ITrigger trigger = TriggerBuilder.Create()\n            .WithIdentity(triggerKey)\n            .StartAt(request.ExecuteAt ?? DateTime.UtcNow) <span class=\"comment\">// æŒ‡å®šåŸ·è¡Œæ™‚é–“</span>\n            .WithSimpleSchedule(x =&gt; x\n                .WithMisfireHandlingInstructionFireNow() <span class=\"comment\">// ç•¶æ’ç¨‹éŒ¯éåŸ·è¡Œæ™‚é–“æ™‚ç«‹å³åŸ·è¡Œ</span>\n                .WithRepeatCount(<span class=\"number\">0</span>) <span class=\"comment\">//åªåŸ·è¡Œä¸€æ¬¡</span>\n                )\n            .Build();\n\n        <span class=\"keyword\">try</span>\n        &#123;\n           <span class=\"keyword\">await</span> sch.ScheduleJob(job, trigger);\n           Console.WriteLine(<span class=\"string\">$&quot;Scheduled job successfully with JobKey: <span class=\"subst\">&#123;jobKey.Name&#125;</span> and TriggerKey: <span class=\"subst\">&#123;triggerKey.Name&#125;</span>&quot;</span>);\n        &#125;\n        <span class=\"keyword\">catch</span> (Exception ex)\n        &#123;\n            Console.WriteLine(<span class=\"string\">$&quot;Failed to schedule job with JobKey: <span class=\"subst\">&#123;jobKey.Name&#125;</span> and TriggerKey: <span class=\"subst\">&#123;triggerKey.Name&#125;</span>&quot;</span>, ex);\n            <span class=\"keyword\">return</span> StatusCode(<span class=\"number\">500</span>, <span class=\"string\">&quot;Failed to schedule job&quot;</span>);\n        &#125;\n\n        <span class=\"keyword\">return</span> Ok(<span class=\"string\">$&quot;Scheduled job successfully with Job: <span class=\"subst\">&#123;jobKey.Name&#125;</span> and Trigger: <span class=\"subst\">&#123;triggerKey.Name&#125;</span>&quot;</span>);\n    &#125;\n&#125;</code></pre>\n<h2 id=\"Program-cs\">Program.cs</h2>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// å¾ appsettings.json è¼‰å…¥ Quartz é…ç½®</span>\nbuilder.Services.Configure&lt;QuartzOptions&gt;(builder.Configuration.GetSection(<span class=\"string\">&quot;Quartz&quot;</span>));\n\n<span class=\"comment\">// åŠ å…¥ Quartz æœå‹™</span>\nbuilder.Services.AddQuartz(q =&gt;\n&#123;\n    q.UseJobFactory&lt;MicrosoftDependencyInjectionJobFactory&gt;();\n\n    <span class=\"comment\">// æŒä¹…åŒ–</span>\n    q.UsePersistentStore(opt =&gt;\n    &#123;\n        opt.UseProperties = <span class=\"literal\">false</span>;\n        opt.UseOracle(configuration =&gt;\n        &#123;\n            configuration.ConnectionString = builder.Configuration[<span class=\"string\">&quot;Quartz:quartz.dataSource.default.connectionString&quot;</span>];\n        &#125;);\n        opt.UseNewtonsoftJsonSerializer();\n    &#125;);\n&#125;);\nbuilder.Services.AddQuartzServer(q =&gt; q.WaitForJobsToComplete = <span class=\"literal\">true</span>); <span class=\"comment\">//hosting server</span>\n<span class=\"comment\">//builder.Services.AddQuartzHostedService(options =&gt;</span>\n<span class=\"comment\">//&#123;</span>\n<span class=\"comment\">//    // when shutting down we want jobs to complete gracefully</span>\n<span class=\"comment\">//    options.WaitForJobsToComplete = true;</span>\n<span class=\"comment\">//&#125;);</span>\nbuilder.Services.AddTransient&lt;SendTasJob&gt;(); <span class=\"comment\">// Jobè¨»å†Š</span>\n</code></pre>\n<h2 id=\"AddQuartzServer-vs-AddQuartzHostedService\">AddQuartzServer vs AddQuartzHostedService</h2>\n<p>AddQuartzServer æœƒå¤šä¸€å€‹ Health Check æª¢æŸ¥ scheduler<br>\nSource Code å¦‚ä¸‹</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">using</span> System;\n\n<span class=\"keyword\">using</span> Microsoft.Extensions.DependencyInjection;\n\n<span class=\"meta\">#<span class=\"keyword\">if</span> SUPPORTS_HEALTH_CHECKS</span>\n<span class=\"keyword\">using</span> Quartz.AspNetCore.HealthChecks;\n<span class=\"meta\">#<span class=\"keyword\">endif</span></span>\n\n<span class=\"keyword\">namespace</span> <span class=\"title\">Quartz</span>\n&#123;\n    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title\">QuartzServiceCollectionExtensions</span>\n    &#123;\n        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> IServiceCollection <span class=\"title\">AddQuartzServer</span>(<span class=\"params\"></span></span>\n<span class=\"params\"><span class=\"function\">            <span class=\"keyword\">this</span> IServiceCollection services,</span></span>\n<span class=\"params\"><span class=\"function\">            Action&lt;QuartzHostedServiceOptions&gt;? configure = <span class=\"literal\">null</span></span>)</span>\n        &#123;\n            <span class=\"meta\">#<span class=\"keyword\">if</span> SUPPORTS_HEALTH_CHECKS</span>\n            services\n                .AddHealthChecks()\n                .AddTypeActivatedCheck&lt;QuartzHealthCheck&gt;(<span class=\"string\">&quot;quartz-scheduler&quot;</span>);\n            <span class=\"meta\">#<span class=\"keyword\">endif</span></span>\n\n            <span class=\"keyword\">return</span> services.AddQuartzHostedService(configure);\n        &#125;\n    &#125;\n&#125;</code></pre>\n<h2 id=\"IIS-å›æ”¶æ©Ÿåˆ¶ï¼Œæ’ç¨‹å¤±æ•ˆ\">IIS å›æ”¶æ©Ÿåˆ¶ï¼Œæ’ç¨‹å¤±æ•ˆ</h2>\n<ul>\n<li>é—œé–‰å›æ”¶æ©Ÿåˆ¶(ç¨‹å¼æ‡‰ç”¨é›†å€ =&gt; é€²éšè¨­å®š)<br>\n<img src=\"/images/InetMgr_ndjANFedAK.png\" alt=\"InetMgr_ndjANFedAK.png\"><br>\n<img src=\"/images/InetMgr_8EXFtPapjN.png\" alt=\"InetMgr_8EXFtPapjN.png\"></li>\n<li>å®šæœŸå‘¼å« api ç¶­æŒ server keep alive (ex.ä½¿ç”¨ window æ’ç¨‹)</li>\n</ul>\n<pre><code class=\"highlight powershell\"><span class=\"comment\"># File: InvokeApi.ps1</span>\n\n<span class=\"comment\"># è¨­å®š URL</span>\n<span class=\"variable\">$url</span> = <span class=\"string\">&quot;your api url&quot;</span>\n<span class=\"comment\"># è¨­å®š Log Path</span>\n<span class=\"variable\">$logFile</span> = <span class=\"string\">&quot;C:\\Scripts\\InvokeApi.log&quot;</span>\n\n<span class=\"comment\"># èª¿ç”¨ API</span>\n<span class=\"keyword\">try</span> &#123;\n    <span class=\"variable\">$response</span> = <span class=\"built_in\">Invoke-WebRequest</span> <span class=\"literal\">-Uri</span> <span class=\"variable\">$url</span> <span class=\"literal\">-Method</span> Get <span class=\"literal\">-TimeoutSec</span> <span class=\"number\">10</span>\n    <span class=\"variable\">$logEntry</span> = <span class=\"string\">&quot;<span class=\"variable\">$</span>(Get-Date) - API call successfully: <span class=\"variable\">$</span>(<span class=\"variable\">$response</span>.StatusCode)&quot;</span>\n&#125; <span class=\"keyword\">catch</span> &#123;\n    <span class=\"variable\">$logEntry</span> = <span class=\"string\">&quot;<span class=\"variable\">$</span>(Get-Date) - API call failed: <span class=\"variable\">$</span>(<span class=\"variable\">$_</span>.Exception.Message)&quot;</span>\n&#125;\n\n<span class=\"comment\"># å¯«å…¥æ—¥èªŒ</span>\n<span class=\"variable\">$logEntry</span> | <span class=\"built_in\">Out-File</span> <span class=\"literal\">-FilePath</span> <span class=\"variable\">$logFile</span> <span class=\"literal\">-Append</span>\n</code></pre>\n<ul>\n<li>å›æ”¶å¾Œï¼Œæ‡‰ç”¨é—œé–‰äº‹ä»¶æ·»åŠ æ‡‰ç”¨é‡å•Ÿ<br>\n<img src=\"/images/aplstart.png\" alt=\"aplstart.png\"></li>\n</ul>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<p><a href=\"https://www.quartz-scheduler.net/\">https://www.quartz-scheduler.net/</a><br>\n<a href=\"https://stackoverflow.com/questions/75443765/quartz-aspnetcore-and-hosting-in-asp-net-core\">https://stackoverflow.com/questions/75443765/quartz-aspnetcore-and-hosting-in-asp-net-core</a><br>\n<a href=\"https://blog.csdn.net/qq_18932003/article/details/139672249\">https://blog.csdn.net/qq_18932003/article/details/139672249</a></p>\n","categories":["å¾Œç«¯"],"tags":["C#","Quartz"]},{"title":"SignalR","url":"/2024/12/11/signalr/","content":"<h3 id=\"æ¦‚è¿°\">æ¦‚è¿°</h3>\n<p>ç°¡å–®åˆ©ç”¨ SignalR å»æ™‚åšä¸€å€‹ç°¡æ˜“çš„ Webhook Api</p>\n<h3 id=\"Installed\">Installed</h3>\n<pre><code class=\"highlight ada\">dotnet add <span class=\"keyword\">package</span> <span class=\"title\">Microsoft.AspNet.SignalR.Core</span></code></pre>\n<h3 id=\"Program-cs\">Program.cs</h3>\n<p>è¨»å†Š SignalR æœå‹™ï¼Œä¸”è¨­å®šè·¯ç”±</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span>\n&#123;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] args</span>)</span>\n    &#123;\n        <span class=\"keyword\">var</span> builder = WebApplication.CreateBuilder(args);\n        <span class=\"comment\">// Add services to the container.</span>\n        builder.Services.AddSignalR();   <span class=\"comment\">// è¨»å†Š SignalR æœå‹™</span>\n        <span class=\"comment\">//....</span>\n        <span class=\"keyword\">var</span> app = builder.Build();\n        app.UseHttpsRedirection();\n        app.UseAuthorization();\n        app.MapControllers();\n        app.MapHub&lt;MessageHub&gt;(<span class=\"string\">&quot;/hub&quot;</span>); <span class=\"comment\">//SignalRè·¯ç”±</span>\n        app.Run();\n    &#125;\n&#125;</code></pre>\n<h3 id=\"MessageHub-cs\">MessageHub.cs</h3>\n<p>å¯¦ä½œ Hub é¡åˆ¥<br>\né€™é‚Šä½¿ç”¨å–®ä¸€ä½¿ç”¨è€…ç¾¤çµ„åšç°¡å–®çš„é€£ç·šç®¡ç†<br>\nå› ç‚ºæ˜¯æš«å­˜åœ¨è¨˜æ†¶é«”ï¼Œé—œé–‰å¾Œè³‡æ–™å°±æ¶ˆå¤±ã„Œ<br>\nå¦‚æœéœ€è¦æŒä¹…åŒ–ï¼Œè¦å†é…åˆ DB å»é€²è¡ŒæŒä¹…åŒ–</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">MessageHub</span> : <span class=\"title\">Hub</span>\n&#123;\n    <span class=\"comment\">// ç´€éŒ„ç”¨æˆ¶çš„é€£ç·š(å–®ä¸€ä½¿ç”¨è€…ç¾¤çµ„)</span>\n    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">readonly</span> Dictionary&lt;<span class=\"built_in\">string</span>, List&lt;<span class=\"built_in\">string</span>&gt;&gt; _userConnections = <span class=\"keyword\">new</span>();\n\n    <span class=\"comment\">// é€£ç·šæ™‚è¦åšçš„äº‹</span>\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> <span class=\"keyword\">async</span> Task <span class=\"title\">OnConnectedAsync</span>()</span>\n    &#123;\n        <span class=\"keyword\">var</span> userName = Context.GetHttpContext()?.Request.Query[<span class=\"string\">&quot;user&quot;</span>]\n          ?? <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentNullException(<span class=\"string\">&quot;æœªçŸ¥ä½¿ç”¨è€…&quot;</span>);\n\n        <span class=\"keyword\">if</span> (_userConnections.TryGetValue(userName,<span class=\"keyword\">out</span> <span class=\"keyword\">var</span> connectionIds))\n        &#123;\n            <span class=\"keyword\">if</span> (!connectionIds.Contains(Context.ConnectionId))\n            &#123;\n                connectionIds.Add(Context.ConnectionId);\n            &#125;\n        &#125;\n        <span class=\"keyword\">else</span>\n        &#123;\n            _userConnections.Add(userName, <span class=\"keyword\">new</span> List&lt;<span class=\"built_in\">string</span>&gt; &#123; Context.ConnectionId &#125;);\n        &#125;\n\n        <span class=\"keyword\">await</span> Groups.AddToGroupAsync(Context.ConnectionId, userName);\n        <span class=\"keyword\">await</span> <span class=\"keyword\">base</span>.OnConnectedAsync();\n    &#125;\n\n    <span class=\"comment\">// æ–·ç·šæ™‚è¦åšçš„äº‹</span>\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">override</span> <span class=\"keyword\">async</span> Task <span class=\"title\">OnDisconnectedAsync</span>(<span class=\"params\">Exception? exception</span>)</span>\n    &#123;\n\n        <span class=\"keyword\">var</span> user = _userConnections.FirstOrDefault(x =&gt; x.Value.Contains(Context.ConnectionId)).Key;\n\n        <span class=\"keyword\">if</span> (user <span class=\"keyword\">is</span> <span class=\"keyword\">not</span> <span class=\"literal\">null</span>)\n        &#123;\n            <span class=\"comment\">// ç§»é™¤è©²ç”¨æˆ¶çš„é€£ç·š</span>\n            _userConnections[user].Remove(Context.ConnectionId);\n\n            <span class=\"comment\">// å¦‚æœè©²ç”¨æˆ¶å·²ç¶“æ²’æœ‰ä»»ä½•é€£ç·š</span>\n            <span class=\"keyword\">if</span> (!_userConnections[user].Any())\n            &#123;\n                <span class=\"comment\">// ç§»é™¤ç”¨æˆ¶</span>\n                _userConnections.Remove(user);\n            &#125;\n\n            <span class=\"keyword\">await</span> Groups.RemoveFromGroupAsync(Context.ConnectionId, user);\n        &#125;\n\n        <span class=\"keyword\">await</span> <span class=\"keyword\">base</span>.OnDisconnectedAsync(exception);\n    &#125;\n&#125;</code></pre>\n<h3 id=\"WebhookController-cs\">WebhookController.cs</h3>\n<p>ç°¡æ˜“æä¾›å…¨åŸŸã€ä½¿ç”¨è€…ç¾¤çµ„ã€ç¾æœ‰é€£ç·š api ç«¯é»</p>\n<pre><code class=\"highlight C#\">[<span class=\"meta\">Route(<span class=\"string\">&quot;api/[controller]&quot;</span>)</span>]\n[<span class=\"meta\">ApiController</span>]\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">WebhookController</span> : <span class=\"title\">ControllerBase</span>\n&#123;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IHubContext&lt;MessageHub&gt; hub;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">WebhookController</span>(<span class=\"params\">IHubContext&lt;MessageHub&gt; hub</span>)</span>\n    &#123;\n        <span class=\"keyword\">this</span>.hub = hub;\n    &#125;\n\n    <span class=\"comment\">//å…¨åŸŸæ¨æ’­</span>\n    [<span class=\"meta\">HttpPost(<span class=\"string\">&quot;all&quot;</span>)</span>]\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">SendAll</span>(<span class=\"params\">[FromBody]MessageDto message</span>)</span>\n    &#123;\n        <span class=\"keyword\">await</span> hub.Clients.All.SendAsync(<span class=\"string\">&quot;ReceiveMessage&quot;</span>, message);\n        <span class=\"keyword\">return</span> Ok();\n    &#125;\n\n    <span class=\"comment\">//ç¾¤çµ„æ¨æ’­(ä½¿ç”¨è€…ç¾¤çµ„)</span>\n    [<span class=\"meta\">HttpPost(<span class=\"string\">&quot;group&quot;</span>)</span>]\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">SendGroup</span>(<span class=\"params\">[FromBody] WebhookPayload payload</span>)</span>\n    &#123;\n        <span class=\"keyword\">var</span> message = <span class=\"keyword\">new</span> MessageDto\n        &#123;\n            Sender = payload.Sender,\n            Content = payload.Message,\n            TimeSpan = DateTime.Now\n        &#125;;\n        <span class=\"keyword\">await</span> hub.Clients.Groups(payload.Receiver).SendAsync(<span class=\"string\">&quot;ReceiveGroupMessage&quot;</span>, message);\n        <span class=\"keyword\">return</span> Ok();\n    &#125;\n\n    <span class=\"comment\">// ç¾æœ‰é€£ç·šæ¸…å–®</span>\n    [<span class=\"meta\">HttpGet</span>]\n    <span class=\"function\"><span class=\"keyword\">public</span> IActionResult <span class=\"title\">GetUsers</span>()</span>\n    &#123;\n        <span class=\"keyword\">var</span> users = MessageHub._userConnections;\n        <span class=\"keyword\">return</span> Ok(users);\n    &#125;\n\n    <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">WebhookPayload</span>\n    &#123;\n        <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> Message &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;\n        <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> Sender &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;\n        <span class=\"keyword\">public</span> <span class=\"built_in\">string</span> Receiver &#123; <span class=\"keyword\">get</span>; <span class=\"keyword\">set</span>; &#125;\n    &#125;\n&#125;</code></pre>\n<h3 id=\"webhook-api-curl\">webhook api curl</h3>\n<pre><code class=\"highlight ada\">curl -X <span class=\"symbol\">&#x27;POST</span>&#x27; \\\n  <span class=\"symbol\">&#x27;https</span>://localhost:<span class=\"number\">7244</span>/api/Webhook/<span class=\"keyword\">all</span>&#x27; \\\n  -H <span class=\"symbol\">&#x27;accept</span>: */*&#x27; \\\n  -H <span class=\"symbol\">&#x27;Content</span>-<span class=\"keyword\">Type</span>: application/json&#x27; \\\n  -d &#x27;&#123;\n  <span class=\"string\">&quot;sender&quot;</span>: <span class=\"string\">&quot;user&quot;</span>,\n  <span class=\"string\">&quot;content&quot;</span>: <span class=\"string\">&quot;test&quot;</span>\n&#125;&#x27;</code></pre>\n<h3 id=\"å‰ç«¯æ¥æ”¶-webhook\">å‰ç«¯æ¥æ”¶ webhook</h3>\n<p>å‰ç«¯ä½¿ç”¨ quasar vue typescript</p>\n<pre><code class=\"highlight ts\">&lt;script setup lang=<span class=\"string\">&quot;ts&quot;</span>&gt;\n<span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> signalR <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@microsoft/signalr&#x27;</span>;\n<span class=\"keyword\">import</span> &#123; ref, onMounted &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span>;\n\n<span class=\"keyword\">type</span> <span class=\"title class_\">MessageDto</span> = &#123;\n  <span class=\"attr\">sender</span>: <span class=\"built_in\">string</span>;\n  <span class=\"attr\">content</span>: <span class=\"built_in\">string</span>;\n  <span class=\"attr\">timeSpan</span>: <span class=\"title class_\">Date</span>;\n&#125;;\n<span class=\"keyword\">const</span> user = <span class=\"string\">&#x27;admin&#x27;</span>;\n<span class=\"keyword\">const</span> receiveMsgs = ref&lt;<span class=\"title class_\">MessageDto</span>[]&gt;([]);\n\n<span class=\"keyword\">const</span> connection = <span class=\"keyword\">new</span> signalR.<span class=\"title class_\">HubConnectionBuilder</span>()\n  .<span class=\"title function_\">withUrl</span>(<span class=\"string\">`https://localhost:7244/hub?user=<span class=\"subst\">$&#123;user&#125;</span>`</span>)\n  .<span class=\"title function_\">withAutomaticReconnect</span>()\n  .<span class=\"title function_\">build</span>();\n\n<span class=\"comment\">//ç›£è½å…¨é »æ¨æ’­</span>\nconnection.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;ReceiveMessage&#x27;</span>, <span class=\"function\">(<span class=\"params\"><span class=\"attr\">res</span>: <span class=\"title class_\">MessageDto</span></span>) =&gt;</span> &#123;\n  receiveMsgs.<span class=\"property\">value</span>.<span class=\"title function_\">push</span>(res);\n&#125;);\n\n<span class=\"comment\">//ç›£è½ç¾¤çµ„æ¨æ’­</span>\nconnection.<span class=\"title function_\">on</span>(<span class=\"string\">&#x27;ReceiveGroupMessage&#x27;</span>, <span class=\"function\">(<span class=\"params\"><span class=\"attr\">res</span>: <span class=\"title class_\">MessageDto</span></span>) =&gt;</span> &#123;\n  receiveMsgs.<span class=\"property\">value</span>.<span class=\"title function_\">push</span>(res);\n&#125;);\n\n<span class=\"comment\">//é‡æ–°é€£ç·š</span>\nconnection.<span class=\"title function_\">onreconnected</span>(<span class=\"function\">() =&gt;</span> &#123;\n  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Reconnected successfully.&#x27;</span>);\n&#125;);\n\nconnection.<span class=\"title function_\">onclose</span>(<span class=\"title function_\">async</span> () =&gt; &#123;\n  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Disconnected. Retrying connection...&#x27;</span>);\n  <span class=\"keyword\">await</span> <span class=\"title function_\">reconnect</span>();\n&#125;);\n\n<span class=\"keyword\">const</span> <span class=\"title function_\">reconnect</span> = <span class=\"keyword\">async</span> (<span class=\"params\"></span>) =&gt; &#123;\n  <span class=\"keyword\">let</span> attempts = <span class=\"number\">0</span>;\n  <span class=\"keyword\">const</span> maxAttempts = <span class=\"number\">100</span>; <span class=\"comment\">// æœ€å¤§å˜—è©¦æ¬¡æ•¸</span>\n  <span class=\"keyword\">const</span> retryDelay = <span class=\"number\">30000</span>; <span class=\"comment\">// å˜—è©¦é–“éš”(ms)</span>\n\n  <span class=\"keyword\">while</span> (attempts &lt; maxAttempts) &#123;\n    <span class=\"keyword\">try</span> &#123;\n      <span class=\"keyword\">await</span> connection.<span class=\"title function_\">start</span>();\n      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Reconnected successfully.&#x27;</span>);\n      <span class=\"keyword\">return</span>; <span class=\"comment\">// é€£ç·šæˆåŠŸ,é€€å‡ºå¾ªç’°</span>\n    &#125; <span class=\"keyword\">catch</span> (err) &#123;\n      attempts++;\n      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`Reconnection attempt <span class=\"subst\">$&#123;attempts&#125;</span> failed.`</span>, err);\n      <span class=\"keyword\">if</span> (attempts &lt; maxAttempts) &#123;\n        <span class=\"keyword\">await</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve</span>) =&gt;</span> <span class=\"built_in\">setTimeout</span>(resolve, retryDelay)); <span class=\"comment\">// ç­‰å¾…åé‡è¯•</span>\n      &#125; <span class=\"keyword\">else</span> &#123;\n        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Failed to reconnect after several attempts.&#x27;</span>)\n      &#125;\n    &#125;\n  &#125;\n&#125;;\n\n<span class=\"title function_\">onMounted</span>(<span class=\"title function_\">async</span> () =&gt; &#123;\n  <span class=\"keyword\">try</span> &#123;\n    <span class=\"keyword\">await</span> connection.<span class=\"title function_\">start</span>();\n    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">`<span class=\"subst\">$&#123;user&#125;</span> has connected`</span>)\n  &#125; <span class=\"keyword\">catch</span> (err) &#123;\n    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);\n  &#125;\n&#125;);\n&lt;/script&gt;</code></pre>\n<h3 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h3>\n<ul>\n<li><a href=\"https://learn.microsoft.com/zh-tw/aspnet/core/tutorials/signalr?view=aspnetcore-9.0&amp;WT.mc_id=dotnet-35129-website&amp;tabs=visual-studio\">https://learn.microsoft.com/zh-tw/aspnet/core/tutorials/signalr?view=aspnetcore-9.0&amp;WT.mc_id=dotnet-35129-website&amp;tabs=visual-studio</a></li>\n<li><a href=\"https://www.perplexity.ai/\">https://www.perplexity.ai/</a></li>\n<li><a href=\"https://www.npmjs.com/package/@microsoft/signalr\">https://www.npmjs.com/package/@microsoft/signalr</a></li>\n</ul>\n","categories":["å¾Œç«¯"],"tags":["C#","SignalR"]},{"title":"IIS å®‰è£æ†‘è­‰","url":"/2025/02/14/server-certificate/","content":"<p>ç°¡æ˜“ç´€éŒ„ IIS ç«™å°å¦‚ä½•å®‰è£æ†‘è­‰</p>\n<ol>\n<li>å–å¾—æ†‘è­‰æª”æ¡ˆ<br>\n<img src=\"/images/server-certificate/ssl.png\" alt=\"iis_file.png\"></li>\n<li>é–‹å•Ÿ IIS ç®¡ç†å“¡</li>\n<li>é¸æ“‡ä¼ºæœå™¨</li>\n<li>é€²å…¥ä¼ºæœå™¨æ†‘è­‰</li>\n<li>åŒ¯å…¥æ†‘è­‰æª”æ¡ˆ<br>\n<img src=\"/images/server-certificate/import_certificate.png\" alt=\"import_certificate.png\"></li>\n<li>é¸æ“‡ç«™å°</li>\n<li>æ–°å¢ç¹«çµ<br>\n<img src=\"/images/server-certificate/add_link.png\" alt=\"add_link.png\"></li>\n<li>é‡æ–°å•Ÿå‹•ä¸¦æ¸¬è©¦</li>\n</ol>\n","categories":["IIS"],"tags":["IIS"]},{"title":"æ»‘å‹•è¦–çª—(Sliding Window)","url":"/2025/01/20/sliding-window/","content":"<h3 id=\"æ¦‚è¿°\">æ¦‚è¿°</h3>\n<p>ä¸»è¦å°±æ˜¯æ“ä½œä¸€å€‹è¦–çª—çš„å·¦å³é‚Šç•Œï¼Œå»æª¢æŸ¥ç¯„åœå…§çš„æ•¸æ“šï¼Œé©åˆç”¨æ–¼ Array æˆ–æ˜¯ String<br>\nå¯ä»¥é¿å…é‡è¤‡å·²ç¶“æª¢æŸ¥éçš„æ•¸æ“šï¼Œ<code>å„ªåŒ–æ™‚é–“è¤‡é›œåº¦</code>ï¼Œä½†åªé©ç”¨æ–¼<code>é€£çºŒ</code>æ•¸æ“š</p>\n<h3 id=\"ç°¡æ˜“ç¯„ä¾‹\">ç°¡æ˜“ç¯„ä¾‹</h3>\n<p>å†çµ¦å®šçš„æ•¸çµ„[2, 5, 8 ,6 ,1]ä¸­ï¼Œæ‰¾å‡ºé€£çºŒ 3 å€‹æ•¸å­—æœ€å¤§ç¸½å’Œ</p>\n<p><img src=\"/images/SlidingWindowExample.png\" alt=\"slidingWindow.png\"></p>\n<pre><code class=\"highlight js\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">2</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>, <span class=\"number\">6</span>, <span class=\"number\">1</span>];\n<span class=\"keyword\">var</span> findThreeLargest = <span class=\"keyword\">function</span> (<span class=\"params\">arr</span>) &#123;\n  <span class=\"keyword\">let</span> curSum = <span class=\"number\">0</span>;\n  <span class=\"comment\">// åˆå§‹è¦–çª—ç¸½å’Œ(å‰3å€‹æ•¸ç¸½å’Œ)</span>\n  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++) &#123;\n    curSum += arr[i];\n  &#125;\n\n  <span class=\"keyword\">let</span> maxSum = curSum; <span class=\"comment\">// æœ€å¤§ç¸½å’Œ</span>\n  <span class=\"keyword\">let</span> maxSumIndex = <span class=\"number\">0</span>; <span class=\"comment\">// æœ€å¤§ç¸½å’Œçš„èµ·å§‹ä½ç½®</span>\n  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">3</span>; i &lt; arr.<span class=\"property\">length</span>; i++) &#123;\n    curSum = curSum - arr[i - <span class=\"number\">3</span>] + arr[i];\n    <span class=\"comment\">// æ›´æ–°æœ€å¤§ç¸½å’Œçš„èµ·å§‹ä½ç½®</span>\n    <span class=\"keyword\">if</span> (curSum &gt; maxSum) &#123;\n      maxSum = curSum;\n      maxSumIndex = i - <span class=\"number\">3</span>;\n    &#125;\n  &#125;\n  <span class=\"keyword\">return</span> &#123; maxSum, maxSumIndex &#125;;\n&#125;;</code></pre>\n<h3 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h3>\n<ul>\n<li><a href=\"https://ithelp.ithome.com.tw/articles/10364268\">https://ithelp.ithome.com.tw/articles/10364268</a></li>\n<li><a href=\"https://medium.com/%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/%E6%BC%94%E7%AE%97%E6%B3%95%E7%AD%86%E8%A8%98%E7%B3%BB%E5%88%97-two-pointer-%E8%88%87sliding-window-8742f45f3f55\">https://medium.com/æŠ€è¡“ç­†è¨˜/æ¼”ç®—æ³•ç­†è¨˜ç³»åˆ—-two-pointer-èˆ‡sliding-window-8742f45f3f55</a></li>\n</ul>\n","categories":["åŸºç¤"]},{"title":"C# ä½¿ç”¨IdGenç”¢ç”ŸId(é›ªèŠ±ç®—æ³•)","url":"/2024/11/19/snowflake/","content":"<h1>é›ªèŠ±ç®—æ³•</h1>\n<h2 id=\"æ¦‚è¿°\">æ¦‚è¿°</h2>\n<p>å…¬å¸çš„è³‡æ–™è¡¨å¸¸å¸¸ä½¿ç”¨å¾ˆå¥‡æ€ªçš„æ¬„ä½ä¾†å»ç•¶è­˜åˆ¥éµ(ä¾‹å¦‚æ™‚é–“æˆ³)ï¼Œæ—¢ç„¶éƒ½ç”¨æ™‚é–“æˆ³äº†ä¸å¦‚ç”¨é›ªèŠ±ç®—æ³•ç”¢ ID ç•¶ PK<br>\né›ªèŠ±ç®—æ³•æ˜¯ Twitter é–‹æºçš„ç”Ÿæˆåˆ†æ•£å¼å…¨åŸŸç”¢ç”Ÿ ID çš„æ¼”ç®—æ³•</p>\n<h2 id=\"æ ¼å¼\">æ ¼å¼</h2>\n<p>é›ªèŠ± ID æœ‰ 64 ä½å…ƒ</p>\n<ul>\n<li>1 ä½ç‚ºç¬¦è™Ÿä½å§‹çµ‚æ˜¯ 0</li>\n<li>41 ä½ç‚ºæ™‚é–“æˆ³ï¼Œç²¾åº¦æ¯«ç§’</li>\n<li>10 ä½å¯ç‚º(10 ä½æ©Ÿå™¨ ID) æˆ– (5 ä½æ•¸æ“šä¸­å¿ƒ ID + 5 ä½æ©Ÿå™¨ ID)ï¼Œå¯è­˜åˆ¥ 1024 å°æ©Ÿå™¨</li>\n<li>12 ä½ç‚ºåºåˆ—è™Ÿ =&gt; ä»£è¡¨æ¯æ¯«ç§’å¯ä»¥æœ‰ 4096 å€‹ ID</li>\n</ul>\n<p><img src=\"/images/snowflake.png\" alt=\"snowflake_structure.image\"></p>\n<h2 id=\"å„ªç¼ºé»\">å„ªç¼ºé»</h2>\n<h3 id=\"å„ªé»\">å„ªé»</h3>\n<ol>\n<li>ID åŒ…å«æ™‚é–“æˆ³ï¼Œæœ‰åºå¯æ’åº</li>\n<li>ç°¡å–®é€Ÿåº¦å¿«</li>\n</ol>\n<h3 id=\"ç¼ºé»\">ç¼ºé»</h3>\n<ol>\n<li>ä¾è³´ç³»çµ±æ™‚é–“ï¼Œå¦‚æœç³»çµ±æ™‚é–“å›é€€æˆ–è·³èºï¼Œæœƒç”¢ç”Ÿä¸å”¯ä¸€ ID</li>\n<li>è‡ªå·±æ‰‹å‹•åˆ†é…æ©Ÿå™¨ IDï¼Œåˆ†é…ä¸ç•¶ï¼Œç”¢ç”Ÿä¸å”¯ä¸€ ID</li>\n</ol>\n<h2 id=\"Install\">Install</h2>\n<pre><code class=\"highlight ada\">dotnet add <span class=\"keyword\">package</span> <span class=\"title\">IdGen</span></code></pre>\n<h2 id=\"DI-æ³¨å…¥-Optionl\">DI æ³¨å…¥(Optionl)</h2>\n<pre><code class=\"highlight ada\">dotnet add <span class=\"keyword\">package</span> <span class=\"title\">IdGen.DependencyInjection</span></code></pre>\n<h2 id=\"Usage\">Usage</h2>\n<h3 id=\"ä¸€èˆ¬\">ä¸€èˆ¬</h3>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">var</span> generator = <span class=\"keyword\">new</span> IdGenerator(<span class=\"number\">0</span>);\n<span class=\"keyword\">var</span> id = generator.CreateId();</code></pre>\n<h3 id=\"ä¾è³´æ³¨å…¥\">ä¾è³´æ³¨å…¥</h3>\n<p>Program.cs</p>\n<pre><code class=\"highlight C#\">builder.Services.AddIdGen(<span class=\"number\">0</span>);</code></pre>\n<p>Example.cs</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">Example</span>\n&#123;\n    <span class=\"comment\">//private readonly IIdGenerator&lt;long&gt; idGenerator;</span>\n    <span class=\"comment\">//public Example (IIdGenerator&lt;long&gt; idGenerator)</span>\n    <span class=\"comment\">//&#123;</span>\n    <span class=\"comment\">//    this.idGenerator = idGenerator;</span>\n    <span class=\"comment\">//&#125;</span>\n\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IdGenerator idGenerator;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Example</span>(<span class=\"params\">IdGenerator idGenerator</span>)</span>\n    &#123;\n        <span class=\"keyword\">this</span>.idGenerator = idGenerator;\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"built_in\">long</span> <span class=\"title\">GetId</span>()</span>\n    &#123;\n        <span class=\"keyword\">var</span> id = idGenerator.CreateId();\n        <span class=\"keyword\">return</span> id;\n    &#125;\n&#125;</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<p><a href=\"https://github.com/RobThree/IdGen?tab=readme-ov-file\">https://github.com/RobThree/IdGen?tab=readme-ov-file</a></p>\n","categories":["å¾Œç«¯"],"tags":["C#"]},{"title":"sqlkata","url":"/2025/04/03/sqlkata/","content":"<h2 id=\"ç°¡ä»‹\">ç°¡ä»‹</h2>\n<p>SqlKata æŸ¥è©¢ç”Ÿæˆå™¨æ˜¯ä¸€å€‹ç”¨ C#ç·¨å¯«çš„åŠŸèƒ½å¼·å¤§ SQL ç”Ÿæˆå™¨ï¼Œå®ƒå®‰å…¨ã€ä¸å—æ¡†æ¶å½±éŸ¿ï¼Œéˆæ„Ÿä¾†æºæ–¼ Laravel Query Builder å’Œ Knex ç­‰é ‚ç´šæŸ¥è©¢å»ºç«‹å·¥å…·</p>\n<ul>\n<li>ä¹¾æ·¨çš„å‘½åï¼Œèˆ‡ SQL èªæ³•ç›¸ä¼¼</li>\n<li>å…è¨±çµ±ä¸€ API è™•ç†å¤šå€‹æ•¸æ“šåº«ï¼Œä¸”å¯æ­é… Dapper ä½¿ç”¨ï¼Œæœ‰æ•ˆæ›¿ä»£æ•¸æ“šåº«çš„å­˜å„²éç¨‹</li>\n<li>æ”¯æŒè¤‡é›œæŸ¥è©¢ï¼Œå¦‚:åµŒå¥—æ¢ä»¶ã€å­æŸ¥è©¢â€¦ç­‰</li>\n<li>ç›®å‰æœ‰æ”¯æ´çš„è³‡æ–™åº« SqlServerã€MySqlã€PostgreSqlã€Oracle â€¦ç­‰</li>\n<li><a href=\"https://github.com/fairking/FluentSqlKata\">æ“´å……é …ç›®</a>ï¼Œæ­é… EntityFramework Core 6 ä½¿ç”¨</li>\n<li><a href=\"https://sqlkata.com/docs\">è©³ç´°æ–‡æª”</a></li>\n<li><a href=\"https://sqlkata.com/playground\">PlayGround</a></li>\n</ul>\n<h2 id=\"å®‰è£\">å®‰è£</h2>\n<pre><code class=\"highlight ada\">$ dotnet add <span class=\"keyword\">package</span> <span class=\"title\">SqlKata</span>\n$ dotnet add <span class=\"keyword\">package</span> <span class=\"title\">SqlKata.Execution # (é¸ç”¨) å¦‚æœæ‚¨å¸Œæœ›åŸ·è¡Œæ”¯æ´</span></code></pre>\n<h2 id=\"ç¯„ä¾‹\">ç¯„ä¾‹</h2>\n<h3 id=\"ç°¡æ˜“å¯¦ä½œ-ä»¥-Oracle-ç‚ºä¾‹\">ç°¡æ˜“å¯¦ä½œ(ä»¥ Oracle ç‚ºä¾‹)</h3>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">var</span> connection = <span class=\"keyword\">new</span> OracleConnection(connectionString);\n<span class=\"keyword\">var</span> compiler = <span class=\"keyword\">new</span> OracleCompiler();\n<span class=\"keyword\">var</span> db = <span class=\"keyword\">new</span> QueryFactory(conn, compiler);\n<span class=\"comment\">// QueryFactory ç”± SqlKata.Execution å¥—ä»¶æä¾›</span>\n<span class=\"keyword\">var</span> books = db.Query(<span class=\"string\">&quot;Books&quot;</span>).Get();</code></pre>\n<h3 id=\"Dependency-injection-æ³¨å…¥å¯¦ä½œ-For-NET-6\">Dependency injection æ³¨å…¥å¯¦ä½œ(For .NET 6)</h3>\n<p>QueryFactoryFactory.cs</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">QueryFactoryFactory</span> : <span class=\"title\">IQueryFactoryFactory</span>\n&#123;\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IConfiguration _configuration;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">QueryFactoryFactory</span>(<span class=\"params\">IConfiguration configuration</span>)</span>\n    &#123;\n        _configuration = configuration;\n    &#125;\n    <span class=\"function\"><span class=\"keyword\">public</span> QueryFactory <span class=\"title\">CreateQueryFactory</span>(<span class=\"params\"><span class=\"built_in\">string</span> dbKey</span>)</span>\n    &#123;\n        <span class=\"keyword\">var</span> cs = _configuration.GetConnectionString(dbKey);\n        <span class=\"keyword\">if</span> (<span class=\"built_in\">string</span>.IsNullOrEmpty(cs))\n        &#123;\n            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ArgumentException(<span class=\"string\">$&quot;Connection string for <span class=\"subst\">&#123;dbKey&#125;</span> is not found.&quot;</span>);\n        &#125;\n        <span class=\"keyword\">var</span> conn = <span class=\"keyword\">new</span> OracleConnection(cs);\n        <span class=\"keyword\">var</span> compiler = <span class=\"keyword\">new</span> OracleCompiler();\n        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> QueryFactory(conn, compiler);\n    &#125;\n&#125;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title\">IQueryFactoryFactory</span>\n&#123;\n    <span class=\"function\">QueryFactory <span class=\"title\">CreateQueryFactory</span>(<span class=\"params\"><span class=\"built_in\">string</span> dbKey</span>)</span>;\n&#125;\n</code></pre>\n<p>Program.cs</p>\n<pre><code class=\"highlight C#\">builder.Services.AddTransient&lt;IQueryFactoryFactory, QueryFactoryFactory&gt;();</code></pre>\n<p>HomeController.cs</p>\n<pre><code class=\"highlight C#\"><span class=\"keyword\">using</span> SqlKata;\n<span class=\"keyword\">using</span> SqlKata.Execution;\n\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">HomeController</span> &#123;\n\n    <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> IQueryFactoryFactory factory;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">HomeController</span>(<span class=\"params\">IQueryFactoryFactory factory</span>)</span>\n    &#123;\n       <span class=\"keyword\">this</span>.factory = factory;\n    &#125;\n\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">async</span> Task&lt;IActionResult&gt; <span class=\"title\">Get</span>()</span>\n    &#123;\n       <span class=\"keyword\">using</span> <span class=\"keyword\">var</span> db = factory.CreateQueryFactory(dbKey);\n\n       <span class=\"comment\">// é€™è£¡ books çš„é¡å‹æ˜¯ `IEnumerable&lt;dynamic&gt;`</span>\n       <span class=\"keyword\">var</span> books = <span class=\"keyword\">await</span> db.Query(<span class=\"string\">&quot;Books&quot;</span>)\n           .Where(<span class=\"string\">&quot;IsPublished&quot;</span>, <span class=\"literal\">true</span>)\n           .GetAsync();\n\n       <span class=\"comment\">// or `IEnumerable&lt;Book&gt;` if using the Generic overload</span>\n       <span class=\"keyword\">var</span> books = <span class=\"keyword\">await</span> db.Query(<span class=\"string\">&quot;Books&quot;</span>)\n           .Where(<span class=\"string\">&quot;IsPublished&quot;</span>, <span class=\"literal\">true</span>)\n           .GetAsync&lt;Book&gt;();\n\n       <span class=\"keyword\">return</span> Ok(books);\n    &#125;\n&#125;\n</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://sqlkata.com/\">https://sqlkata.com/</a></li>\n<li><a href=\"https://github.com/sqlkata/querybuilder\">https://github.com/sqlkata/querybuilder</a></li>\n<li><a href=\"https://www.cnblogs.com/shanyou/p/16756669.html\">https://www.cnblogs.com/shanyou/p/16756669.html</a></li>\n</ul>\n","categories":["å¾Œç«¯"],"tags":["C#","SQL","SqlKata"]},{"title":"æ–‡å­—ç‰‡æ®µ","url":"/2024/12/13/text-fragments/","content":"<h3 id=\"ä»€éº¼æ˜¯æ–‡å­—ç‰‡æ®µ-Text-Fragments\">ä»€éº¼æ˜¯æ–‡å­—ç‰‡æ®µ(Text Fragments)</h3>\n<p>Text Fragments æ˜¯ä¸€ç¨®æ–°çš„ç¶²é åŠŸèƒ½<br>\nä¸éœ€ä½¿ç”¨éŒ¨é»æ¨™è¨˜ï¼ˆanchor tagsï¼‰å°±å¯ä»¥è®“ä½¿ç”¨è€…é€£çµè‡³ç‰¹å®šæ–‡å­—<br>\nä¸”æœƒè‡ªå‹•é«˜äº®é¡¯ç¤ºä¸¦æ»¾å‹•è‡³è©²æ–‡æœ¬ä½ç½®<br>\n<a href=\"https://caniuse.com/mdn-html_elements_a_text_fragments\">ç›®å‰æ”¯æ´çš„ç‰ˆæœ¬èˆ‡ç€è¦½å™¨</a></p>\n<h3 id=\"ä½¿ç”¨æ–¹æ³•\">ä½¿ç”¨æ–¹æ³•</h3>\n<p>åŸºæœ¬çµæ§‹ :</p>\n<pre><code class=\"highlight asciidoc\"><span class=\"link\">https://example.com/page.html#:~:text=</span>[<span class=\"string\">å‰ç¶´æ–‡å­—-,</span>]é–‹å§‹æ–‡å­—[,çµæŸæ–‡å­—][,-å¾Œç¶´æ–‡å­—]</code></pre>\n<p>ä¸»è¦çµ„æˆ :</p>\n<ul>\n<li>:~: æŒ‡ä»¤ä»£è¡¨é€™æ˜¯æ–‡å­—ç‰‡æ®µ</li>\n<li>text= è¦æœå°‹çš„æ–‡å­—</li>\n<li>[] é¸ç”¨çµ„ä»¶</li>\n</ul>\n<p>çµ„ä»¶èªªæ˜ :</p>\n<ul>\n<li>å‰ç¶´æ–‡å­— : æ‡‰å‡ºç¾åœ¨é–‹å§‹æ–‡å­—å‰é¢çš„æ–‡å­—</li>\n<li>é–‹å§‹æ–‡å­— : ç›®æ¨™ç‰‡æ®µé–‹é ­æ–‡å­—</li>\n<li>çµæŸæ–‡å­— : ç›®æ¨™ç‰‡æ®µçµå°¾æ–‡å­—</li>\n<li>å¾Œç¶´æ–‡å­— : æ‡‰å‡ºç¾åœ¨çµå°¾æ–‡å­—å¾Œé¢çš„æ–‡å­—</li>\n</ul>\n<p>æ¨£å¼èª¿æ•´å¯é€é<code>::target-text</code>é€²è¡Œèª¿æ•´</p>\n<pre><code class=\"highlight css\">::target-text &#123;\n  <span class=\"attribute\">background-color</span>: yellow;\n&#125;</code></pre>\n<h3 id=\"ä½¿ç”¨ç¯„ä¾‹\">ä½¿ç”¨ç¯„ä¾‹</h3>\n<pre><code class=\"highlight dts\"><span class=\"symbol\">http:</span><span class=\"comment\">//127.0.0.1:5500/index.html</span></code></pre>\n<p><img src=\"/images/txtfrag1.png\" alt=\"txtfrag1.png\"></p>\n<pre><code class=\"highlight avrasm\"><span class=\"symbol\">http:</span>//<span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span>:<span class=\"number\">5500</span>/index.html<span class=\"meta\">#:~:text=å¿ƒæ”¾åœ°,å­¸çš„æœ‰</span></code></pre>\n<p><img src=\"/images/txtfrag2.png\" alt=\"txtfrag2.png\"></p>\n<pre><code class=\"highlight pgsql\">http://<span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span>:<span class=\"number\">5500</span>/<span class=\"keyword\">index</span>.html#:~:<span class=\"type\">text</span>=å¦‚åŠé–“æ²’äººèªªåˆ©é©—æ–¼æ°‘ç‰©æ™‚äºº&amp;<span class=\"type\">text</span>=æ²’æ‰é›¨å«è¨´</code></pre>\n<p><img src=\"/images/txtfrag3.png\" alt=\"txtfrag3.png\"></p>\n<h3 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h3>\n<ul>\n<li><a href=\"https://alfy.blog/2024/10/19/linking-directly-to-web-page-content.html\">https://alfy.blog/2024/10/19/linking-directly-to-web-page-content.html</a></li>\n<li><a href=\"https://claude.ai/new\">https://claude.ai/new</a></li>\n</ul>\n","categories":["å‰ç«¯"]},{"title":"æ™‚é–“è¤‡é›œåº¦","url":"/2024/11/27/time-complexity/","content":"<h2 id=\"æ¦‚è¿°\">æ¦‚è¿°</h2>\n<p>æ™‚é–“è¤‡é›œåº¦ä»£è¡¨çš„æ˜¯æ¼”ç®—æ³•éš¨è‘—è³‡æ–™é‡è®Šå¤§æ™‚çš„å¢é•·è¶¨å‹¢<br>\næ•¸å­¸ç¬¦è™Ÿ<code>å¤§Oè¨˜è™Ÿ(big-O notation)</code></p>\n<h2 id=\"å¸¸è¦‹å‹åˆ¥\">å¸¸è¦‹å‹åˆ¥</h2>\n<ul>\n<li>å¸¸æ•¸éš O(1)</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">Constant</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> count = <span class=\"number\">0</span>;\n    <span class=\"comment\">// è¿´åœˆæ¬¡æ•¸èˆ‡ n ç„¡é—œ</span>\n    <span class=\"built_in\">int</span> size = <span class=\"number\">10000</span>;\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; size; i++)\n    &#123;\n        count++;\n    &#125;\n    <span class=\"keyword\">return</span> count;\n&#125;</code></pre>\n<ul>\n<li>ç·šæ€§éš O(n)</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">Linear</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> count = <span class=\"number\">0</span>;\n    <span class=\"comment\">// è¿´åœˆæ¬¡æ•¸ n æ¬¡</span>\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)\n    &#123;\n        count++;\n    &#125;\n    <span class=\"keyword\">return</span> count;\n&#125;</code></pre>\n<ul>\n<li>å¹³æ–¹éš O(<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">n^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>)</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">Quadratic</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> count = <span class=\"number\">0</span>;\n    <span class=\"comment\">// è¿´åœˆæ¬¡æ•¸ n*n æ¬¡</span>\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)\n    &#123;\n        <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> j = <span class=\"number\">0</span>; j &lt; n; j++)\n        &#123;\n            count++;\n        &#125;\n    &#125;\n    <span class=\"keyword\">return</span> count;\n&#125;</code></pre>\n<ul>\n<li>æŒ‡æ•¸éš O(<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>)</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">Exponential</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> count = <span class=\"number\">0</span>;\n    <span class=\"built_in\">int</span> bas = <span class=\"number\">1</span>;\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)\n    &#123;\n        <span class=\"comment\">//è¿´åœˆæ¬¡æ•¸ç‚º2^næ¬¡</span>\n        <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> j = <span class=\"number\">0</span>; j &lt; bas; j++)\n        &#123;\n            count++;\n        &#125;\n        bas *= <span class=\"number\">2</span>;\n    &#125;\n    <span class=\"keyword\">return</span> count;\n&#125;</code></pre>\n<ul>\n<li>å°æ•¸éš O(logn)</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">Logarithmic</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"built_in\">int</span> count = <span class=\"number\">0</span>;\n    <span class=\"keyword\">while</span> (n &gt; <span class=\"number\">1</span>) &#123;\n        n /= <span class=\"number\">2</span>;\n        count++;\n    &#125;\n    <span class=\"keyword\">return</span> count;\n&#125;</code></pre>\n<ul>\n<li>ç·šæ€§å°æ•¸éš O(nlogn)</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">LinearLogRecur</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"keyword\">if</span> (n &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;\n    <span class=\"built_in\">int</span> count = LinearLogRecur(n / <span class=\"number\">2</span>);\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)\n    &#123;\n        count++;\n    &#125;\n    <span class=\"keyword\">return</span> count;\n&#125;</code></pre>\n<ul>\n<li>éšä¹˜éš O(n!)</li>\n</ul>\n<pre><code class=\"highlight C#\"><span class=\"function\"><span class=\"built_in\">int</span> <span class=\"title\">FactorialRecur</span>(<span class=\"params\"><span class=\"built_in\">int</span> n</span>)</span>\n&#123;\n    <span class=\"keyword\">if</span> (n == <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;\n    <span class=\"built_in\">int</span> count = <span class=\"number\">0</span>;\n    <span class=\"comment\">// n * (n - 1) * (n - 2) * ... * 2 * 1</span>\n    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++)\n    &#123;\n        count += FactorialRecur(n - <span class=\"number\">1</span>);\n    &#125;\n    <span class=\"keyword\">return</span> count;\n&#125;</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://www.hello-algo.com/zh-hant/chapter_computational_complexity/time_complexity/\">https://www.hello-algo.com/zh-hant/chapter_computational_complexity/time_complexity/</a></li>\n</ul>\n","categories":["åŸºç¤"]},{"title":"æ¨¹ç‹€è³‡æ–™","url":"/2025/02/05/tree/","content":"<p><img src=\"/images/tree_data_structure.jpg\" alt=\"tree_data_structure.jpg\"></p>\n<h2 id=\"æ¨¹ç‹€çµæ§‹ä»‹ç´¹\">æ¨¹ç‹€çµæ§‹ä»‹ç´¹</h2>\n<ul>\n<li>Node : æ¨¹çš„åŸºæœ¬å–®ä½ï¼Œç´€éŒ„ç¯€é»è³‡æ–™èˆ‡å­ç¯€é»æœ‰å“ªäº›</li>\n<li>Root Node : æ ¹ç¯€é»ï¼Œæ¨¹çš„æœ€é«˜ç¯€é»</li>\n<li>Leaf Node : è‘‰ç¯€é»ï¼Œæ²’æœ‰å­ç¯€é»çš„ç¯€é»</li>\n<li>Edge : é€£æ¥å…©å€‹ç¯€é»çš„ç·šï¼Œè¡¨ç¤ºç¯€é»ä¹‹é–“çš„é—œä¿‚</li>\n<li>Parent Node : çˆ¶ç¯€é»(ä¸Šå±¤ç¯€é»)ï¼Œä¸€å€‹ç¯€é»åªæœƒæœ‰ä¸€å€‹çˆ¶ç¯€é»</li>\n<li>Child Node : å­ç¯€é»ï¼Œä¸€å€‹ç¯€é»å¯ä»¥é€£çµå¤šå€‹å­ç¯€é»</li>\n<li>Sibling Node : å…„å¼Ÿç¯€é»ï¼Œæœ‰ç›¸åŒçˆ¶ç¯€é»çš„ç¯€é»</li>\n<li>Depth : å¾æ ¹ç¯€é»åˆ°è©²ç¯€é»çš„è·¯å¾‘é•·åº¦</li>\n<li>Height : è©²ç¯€é»åˆ°æœ€é è‘‰ç¯€é»çš„è·¯å¾‘é•·åº¦</li>\n<li>Level : ç¯€é»å±¤æ¬¡</li>\n<li>Subtree : æŸç¯€é»çš„æ‰€æœ‰å­ç¯€é»å¾Œä»£</li>\n</ul>\n<h2 id=\"æ¨¹çš„ç¨®é¡\">æ¨¹çš„ç¨®é¡</h2>\n<ol>\n<li>äºŒå…ƒæ¨¹ (Binary Tree)\n<ul>\n<li>ä¸€å€‹ç¯€é»æœ€å¤šå…©å€‹å­ç¯€é»</li>\n</ul>\n</li>\n<li>äºŒå…ƒæœå°‹æ¨¹ (Binary Search Tree, BST)\n<ul>\n<li>å·¦å­æ¨¹æ‰€æœ‰ç¯€é»å€¼å°æ–¼æ ¹ç¯€é»å€¼</li>\n<li>å³å­æ¨¹æ‰€æœ‰ç¯€é»å€¼å¤§æ–¼æ ¹ç¯€é»å€¼</li>\n</ul>\n</li>\n<li>å¹³è¡¡æ¨¹ (Balanced Tree)</li>\n<li>æ»¿äºŒå…ƒæ¨¹ (Full Binary Tree)</li>\n<li>å®Œå…¨äºŒå…ƒæ¨¹ (Complete Binary Tree)</li>\n<li>B æ¨¹ (B-Tree)</li>\n<li>å †ç© (Heap)</li>\n<li>å­—å…¸æ¨¹ (Trie)</li>\n</ol>\n<h2 id=\"æ¨¹çš„éæ­·-Traversal\">æ¨¹çš„éæ­·(Traversal)</h2>\n<ol>\n<li>æ·±åº¦å„ªå…ˆéæ­· (Depth-First Search, DFS)\n<ul>\n<li>å…ˆè¨ªå•å­ç¯€é»ï¼Œå†è¨ªå•å…„å¼Ÿç¯€é»</li>\n<li>3 ç¨®éæ­·æ–¹æ³•\n<ul>\n<li>å‰åºéæ­· (Pre-order)</li>\n<li>ä¸­åºéæ­· (In-order)</li>\n<li>å¾ŒçºŒéæ­· (Post-order)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å»£åº¦å„ªå…ˆéæ­· (Breadth-First Search, BFS)\n<ul>\n<li>éšå±¤éæ­·ï¼Œä¸€å±¤ä¸€å±¤å¾å·¦åˆ°å³</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"ç›¸é—œå¯¦ä½œ-C\">ç›¸é—œå¯¦ä½œ(C#)</h2>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// ç¯€é»</span>\n<span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">TreeNode</span>\n&#123;\n    <span class=\"keyword\">public</span> <span class=\"built_in\">int</span> val;\n    <span class=\"keyword\">public</span> TreeNode left;\n    <span class=\"keyword\">public</span> TreeNode right;\n    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TreeNode</span>(<span class=\"params\"><span class=\"built_in\">int</span> val = <span class=\"number\">0</span>, TreeNode left = <span class=\"literal\">null</span>, TreeNode right = <span class=\"literal\">null</span></span>)</span>\n    &#123;\n        <span class=\"keyword\">this</span>.val = val;\n        <span class=\"keyword\">this</span>.left = left;\n        <span class=\"keyword\">this</span>.right = right;\n    &#125;\n&#125;\n\n<span class=\"comment\">// æ·±åº¦å„ªå…ˆéæ­· (Depth-First Search, DFS)</span>\n<span class=\"comment\">// å‰åºéæ­·</span>\n<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">PreorderTraversal</span>(<span class=\"params\">TreeNode root</span>)</span>\n&#123;\n    <span class=\"keyword\">if</span> (root == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span>;\n    Console.Write(root.val + <span class=\"string\">&quot; &quot;</span>) <span class=\"comment\">// è¨ªå•ç¯€é»</span>\n    PreorderTraversal(root.left); <span class=\"comment\">// éè¿´è¨ªå•å·¦å­æ¨¹</span>\n    PreorderTraversal(root.right); <span class=\"comment\">// éè¿´è¨ªå•å³å­æ¨¹</span>\n&#125;\n\n<span class=\"comment\">// ä¸­åºéæ­·</span>\n<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">InorderTraversal</span>(<span class=\"params\">TreeNode root</span>)</span>\n&#123;\n    <span class=\"keyword\">if</span> (root == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span>;\n    InorderTraversal(root.left);    <span class=\"comment\">// éè¿´éæ­·å·¦å­æ¨¹</span>\n    Console.Write(root.val + <span class=\"string\">&quot; &quot;</span>);  <span class=\"comment\">// è¨ªå•ç¯€é»</span>\n    InorderTraversal(root.right);   <span class=\"comment\">// éè¿´éæ­·å³å­æ¨¹</span>\n&#125;\n\n<span class=\"comment\">// å¾Œåºéæ­·</span>\n<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">PostorderTraversal</span>(<span class=\"params\">TreeNode root</span>)</span>\n&#123;\n    <span class=\"keyword\">if</span> (root == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span>;\n    PostorderTraversal(root.left);   <span class=\"comment\">// éè¿´éæ­·å·¦å­æ¨¹</span>\n    PostorderTraversal(root.right);  <span class=\"comment\">// éè¿´éæ­·å³å­æ¨¹</span>\n    Console.Write(root.val + <span class=\"string\">&quot; &quot;</span>);   <span class=\"comment\">// è¨ªå•ç¯€é»</span>\n&#125;\n\n<span class=\"comment\">// å»£åº¦å„ªå…ˆéæ­· (Breadth-First Search, BFS)</span>\n<span class=\"comment\">// éšå±¤éæ­·</span>\n<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">LevelOrderTraversal</span>(<span class=\"params\">TreeNode root</span>)</span>\n&#123;\n    <span class=\"keyword\">if</span> (root == <span class=\"literal\">null</span>) <span class=\"keyword\">return</span>;\n\n    Queue&lt;TreeNode&gt; queue = <span class=\"keyword\">new</span> Queue&lt;TreeNode&gt;();\n    queue.Enqueue(root);\n\n    <span class=\"keyword\">while</span> (queue.Count &gt; <span class=\"number\">0</span>)\n    &#123;\n        TreeNode node = queue.Dequeue();\n        Console.Write(node.val + <span class=\"string\">&quot; &quot;</span>);\n\n        <span class=\"keyword\">if</span> (node.left != <span class=\"literal\">null</span>) queue.Enqueue(node.left);\n        <span class=\"keyword\">if</span> (node.right != <span class=\"literal\">null</span>) queue.Enqueue(node.right);\n    &#125;\n&#125;</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://medium.com/%E6%8A%80%E8%A1%93%E7%AD%86%E8%A8%98/%E5%9F%BA%E7%A4%8E%E6%BC%94%E7%AE%97%E6%B3%95%E7%B3%BB%E5%88%97-tree-%E6%A8%B9%E7%8B%80%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B-d10fe8ac1ce2\">åŸºç¤æ¼”ç®—æ³•ç³»åˆ— â€” Tree æ¨¹ç‹€è³‡æ–™çµæ§‹</a></li>\n<li><a href=\"https://chat.deepseek.com/\">Deepseek</a></li>\n<li><a href=\"https://www.tutorialspoint.com/data_structures_algorithms/tree_data_structure.htm\">Tree Data Structure</a></li>\n</ul>\n","categories":["åŸºç¤"],"tags":["è³‡æ–™çµæ§‹"]},{"title":"WebRTC","url":"/2025/05/01/webrtc/","content":"<p>ç°¡æ˜“è¨˜éŒ„ä¸€ä¸‹ WebRTC çš„åŸºæœ¬æ¦‚å¿µ</p>\n<h2 id=\"åŸºæœ¬å»ºç«‹é»å°é»é€£ç·šçš„æµç¨‹\">åŸºæœ¬å»ºç«‹é»å°é»é€£ç·šçš„æµç¨‹</h2>\n<p><img src=\"/images/webrtc/P2PConnFlow.png\" alt=\"p2pConnFlow.png\"></p>\n<h3 id=\"ä¿¡ä»¤-Signaling-ï¼š\">ä¿¡ä»¤ (Signaling)ï¼š</h3>\n<ol>\n<li>å…©å€‹ WebRTC å®¢æˆ·ç«¯ï¼ˆPeer A å’Œ Peer Bï¼‰é€éä¸€å€‹<code>ä¿¡ä»¤ä¼ºæœå™¨</code>é€²è¡Œåˆå§‹çš„è³‡è¨Šäº¤æ›ã€‚é€™å€‹ä¼ºæœå™¨ä¸åƒèˆ‡å¯¦éš›çš„åª’é«”å‚³è¼¸ã€‚</li>\n<li>Peer A (ç™¼èµ·æ–¹ - Offerer) å‰µå»ºä¸€å€‹åŒ…å«å…¶åª’é«”èƒ½åŠ›å’Œç¶²è·¯è³‡è¨Šçš„ SDP Offerã€‚</li>\n<li>Peer A æ”¶é›†å…¶ ICE Candidatesï¼ˆæ½›åœ¨çš„ç¶²è·¯ä½å€ï¼‰ã€‚</li>\n<li>Peer A å°‡ SDP Offer å’Œ ICE Candidates é€éä¿¡ä»¤ä¼ºæœå™¨ç™¼é€çµ¦ Peer Bã€‚</li>\n<li>Peer B (æ¥æ”¶æ–¹ - Answerer) æ”¶åˆ° SDP Offer å’Œ ICE Candidatesã€‚</li>\n<li>Peer B è¨­å®šé ç«¯çš„ SDP Offerï¼Œä¸¦å‰µå»ºåŒ…å«å…¶è‡ªèº«åª’é«”èƒ½åŠ›å’Œç¶²è·¯è³‡è¨Šçš„ SDP Answerã€‚</li>\n<li>Peer B ä¹Ÿæ”¶é›†å…¶ ICE Candidatesã€‚</li>\n<li>Peer B å°‡ SDP Answer å’Œ ICE Candidates é€éä¿¡ä»¤ä¼ºæœå™¨ç™¼é€å› Peer Aã€‚</li>\n<li>Peer A æ”¶åˆ° SDP Answer å’Œ ICE Candidatesï¼Œä¸¦è¨­å®šé ç«¯çš„ SDP Answerã€‚</li>\n<li>é›™æ–¹æŒçºŒé€éä¿¡ä»¤ä¼ºæœå™¨äº¤æ› ICE Candidatesã€‚</li>\n</ol>\n<h3 id=\"ICE-é€£ç·šå»ºç«‹-ICE-Connection-Establishment-ï¼š\">ICE é€£ç·šå»ºç«‹ (ICE Connection Establishment)ï¼š</h3>\n<ol>\n<li>æ¯å€‹ Peer åœ¨æ”¶åˆ°å°æ–¹çš„ ICE Candidates å¾Œï¼Œæœƒå˜—è©¦èˆ‡é€™äº›å€™é¸è€…å»ºç«‹ç¶²è·¯é€£ç·šã€‚</li>\n<li>é€™å€‹éç¨‹æœƒå˜—è©¦å„ç¨®å¯èƒ½çš„è·¯å¾‘ï¼ˆç›´æ¥é€£æ¥ã€é€é STUNã€é€é TURNï¼‰ã€‚</li>\n<li>ç•¶æ‰¾åˆ°ä¸€å€‹å¯ç”¨çš„é€£ç·šè·¯å¾‘æ™‚ï¼ŒICE é€£ç·šå»ºç«‹æˆåŠŸã€‚</li>\n</ol>\n<h3 id=\"åª’é«”å’Œè³‡æ–™å‚³è¼¸ï¼š\">åª’é«”å’Œè³‡æ–™å‚³è¼¸ï¼š</h3>\n<ol>\n<li>ä¸€æ—¦ ICE é€£ç·šå»ºç«‹ï¼Œå…©å€‹ Peer å°±å¯ä»¥ç›´æ¥é€éé€™å€‹é»å°é»é€£ç·šå‚³è¼¸éŸ³è¨Šã€è¦–è¨Šæˆ–ä»»æ„è³‡æ–™ï¼ˆä½¿ç”¨ Data Channelsï¼‰ã€‚</li>\n</ol>\n<h2 id=\"ç›¸é—œåè©ç°¡ä»‹ï¼š\">ç›¸é—œåè©ç°¡ä»‹ï¼š</h2>\n<h3 id=\"WebRTC-Web-Real-Time-Communication-ï¼š\">WebRTC (Web Real-Time Communication)ï¼š</h3>\n<p>ä¸€å€‹é–‹æ”¾åŸå§‹ç¢¼å°ˆæ¡ˆï¼Œæä¾›ç€è¦½å™¨å’Œè¡Œå‹•æ‡‰ç”¨ç¨‹å¼ä¹‹é–“å³æ™‚éŸ³è¨Šã€è¦–è¨Šå’Œè³‡æ–™äº¤æ›çš„èƒ½åŠ›ï¼Œç„¡éœ€å¤–æ›ç¨‹å¼ã€‚(ç›®å‰åªæœ‰ js)</p>\n<h3 id=\"Peer-å°ç­‰æ–¹-ï¼š\">Peer (å°ç­‰æ–¹)ï¼š</h3>\n<p>åœ¨ WebRTC é€šè¨Šä¸­çš„ä¸€å€‹ç«¯é»ï¼Œé€šå¸¸æ˜¯ä¸€å€‹ç€è¦½å™¨æˆ–æ‡‰ç”¨ç¨‹å¼ã€‚</p>\n<h3 id=\"é»å°é»-Peer-to-Peer-P2P-ï¼š\">é»å°é» (Peer-to-Peer, P2P)ï¼š</h3>\n<p>ä¸€ç¨®ç¶²è·¯æ¨¡å‹ï¼Œå…¶ä¸­å…©å€‹æˆ–å¤šå€‹åƒèˆ‡è€…å¯ä»¥ç›´æ¥äº’ç›¸é€šä¿¡ï¼Œè€Œä¸éœ€è¦é€éä¸­å¤®ä¼ºæœå™¨ï¼ˆåœ¨åª’é«”å’Œè³‡æ–™å‚³è¼¸éšæ®µï¼‰ã€‚</p>\n<h3 id=\"ä¿¡ä»¤-Signaling-ï¼š-t2\">ä¿¡ä»¤ (Signaling)ï¼š</h3>\n<p>åœ¨ WebRTC é€£ç·šå»ºç«‹ä¹‹å‰ï¼Œå…©å€‹ Peer ä¹‹é–“äº¤æ›æ§åˆ¶è³‡è¨Šï¼ˆä¾‹å¦‚ SDP å’Œ ICE Candidatesï¼‰çš„éç¨‹ã€‚ä¿¡ä»¤æ©Ÿåˆ¶ä¸æ˜¯ WebRTC æœ¬èº«å®šç¾©çš„ï¼Œéœ€è¦é–‹ç™¼è€…è‡ªè¡Œå¯¦ä½œã€‚</p>\n<h3 id=\"ä¿¡ä»¤ä¼ºæœå™¨-Signaling-Server-ï¼š\">ä¿¡ä»¤ä¼ºæœå™¨ (Signaling Server)ï¼š</h3>\n<p>ä¸€å€‹ä¸­ä»‹ä¼ºæœå™¨ï¼Œç”¨æ–¼åœ¨ WebRTC é€£ç·šå»ºç«‹çš„åˆå§‹éšæ®µå”åŠ© Peer ç™¼ç¾å½¼æ­¤ä¸¦äº¤æ›ä¿¡ä»¤è¨Šæ¯ã€‚</p>\n<h3 id=\"SDP-Session-Description-Protocol-ï¼š\">SDP (Session Description Protocol)ï¼š</h3>\n<p>ä¸€ç¨®æ¨™æº–åŒ–çš„æ–‡å­—æ ¼å¼ï¼Œç”¨æ–¼æè¿°å¤šåª’é«”æœƒè©±çš„å±¬æ€§ï¼Œä¾‹å¦‚æ”¯æ´çš„åª’é«”é¡å‹ã€ç·¨è§£ç¢¼å™¨ã€ç¶²è·¯ä½å€ç­‰ã€‚åœ¨ WebRTC ä¸­ï¼ŒSDP ç”¨æ–¼åœ¨é€£æ¥å»ºç«‹å‰å”å•†åª’é«”æ ¼å¼ã€‚</p>\n<h3 id=\"Offer-Answer-æ¨¡å‹-Offer-Answer-Model-ï¼š\">Offer/Answer æ¨¡å‹ (Offer/Answer Model)ï¼š</h3>\n<p>WebRTC ä½¿ç”¨é€™å€‹æ¨¡å‹ä¾†å”å•†æœƒè©±åƒæ•¸ã€‚ç™¼èµ·æ–¹å‰µå»ºä¸€å€‹ Offer SDPï¼Œæ¥æ”¶æ–¹å›æ‡‰ä¸€å€‹ Answer SDPã€‚</p>\n<h3 id=\"ICE-Interactive-Connectivity-Establishment-ï¼š\">ICE (Interactive Connectivity Establishment)ï¼š</h3>\n<p>ä¸€å€‹ç”¨æ–¼ NAT ç©¿é€çš„å”å®šã€‚ICE çš„ç›®æ¨™æ˜¯æ‰¾åˆ°å…©å€‹ Peer ä¹‹é–“æœ€ä½³çš„ç¶²è·¯è·¯å¾‘ä¾†å»ºç«‹ç›´æ¥é€£ç·šã€‚</p>\n<h3 id=\"ICE-Candidate-ICE-å€™é¸è€…-ï¼š\">ICE Candidate (ICE å€™é¸è€…)ï¼š</h3>\n<p>æè¿°ä¸€å€‹ Peer å¯èƒ½çš„ç¶²è·¯ä½å€å’Œé€£æ¥åŸ çš„è³‡è¨Šï¼Œç”¨æ–¼ ICE é€£ç·šå»ºç«‹éç¨‹ã€‚</p>\n<h3 id=\"STUN-Session-Traversal-Utilities-for-NAT-ä¼ºæœå™¨ï¼š\">STUN (Session Traversal Utilities for NAT) ä¼ºæœå™¨ï¼š</h3>\n<p>ä¸€ç¨®å”åŠ©ä½æ–¼ NAT å¾Œé¢çš„ Peer ç™¼ç¾å…¶å…¬æœ‰ IP ä½å€å’Œé€£æ¥åŸ çš„ä¼ºæœå™¨ã€‚</p>\n<h3 id=\"TURN-Traversal-Using-Relays-around-NAT-ä¼ºæœå™¨ï¼š\">TURN (Traversal Using Relays around NAT) ä¼ºæœå™¨ï¼š</h3>\n<p>ä¸€ç¨®åœ¨ç›´æ¥é€£ç·šå’Œ STUN ç„¡æ³•å·¥ä½œæ™‚ï¼Œä½œç‚ºä¸­ç¹¼ä¼ºæœå™¨è½‰ç™¼ Peer ä¹‹é–“æµé‡çš„ä¼ºæœå™¨ã€‚</p>\n<h3 id=\"NAT-Network-Address-Translator-ï¼š\">NAT (Network Address Translator)ï¼š</h3>\n<p>ä¸€ç¨®ç¶²è·¯è¨­å‚™ï¼Œç”¨æ–¼å°‡ç§æœ‰ç¶²è·¯ä¸­çš„å¤šå€‹è£ç½®çš„ IP ä½å€è½‰æ›ç‚ºä¸€å€‹æˆ–å°‘æ•¸å¹¾å€‹å…¬æœ‰ IP ä½å€ï¼Œä»¥ä¾¿å®ƒå€‘å¯ä»¥å­˜å–ç¶²éš›ç¶²è·¯ã€‚NAT æœƒå°è‡´ç›´æ¥çš„é»å°é»é€£ç·šè®Šå¾—å›°é›£ã€‚</p>\n<h2 id=\"ç¯„ä¾‹\">ç¯„ä¾‹</h2>\n<p>Google çµ¦çš„ç¯„ä¾‹ï¼Œå¯ä»¥åƒè€ƒåƒè€ƒå°ç…§å­¸ç¿’ <a href=\"https://github.com/webrtc/samples\">Samples</a></p>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<ul>\n<li><a href=\"https://clairechang.tw/2023/04/25/webrtc/webrtc-intro/\">https://clairechang.tw/2023/04/25/webrtc/webrtc-intro/</a></li>\n<li><a href=\"https://webrtc.org/?hl=zh-tw\">https://webrtc.org/?hl=zh-tw</a></li>\n<li><a href=\"https://webrtcforthecurious.com/zh/\">https://webrtcforthecurious.com/zh/</a></li>\n</ul>\n","categories":["å¾Œç«¯"],"tags":["js","webrtc"]},{"title":"C# ä½¿ç”¨Winscpä¸Šå‚³æª”æ¡ˆ","url":"/2024/11/19/winscp/","content":"<h2 id=\"æ¦‚è¿°\">æ¦‚è¿°</h2>\n<p>æ¥æ‰‹äº†å‰è¼©çš„å°ˆæ¡ˆï¼Œä»¥å‰éƒ½è¦è‡ªå·±æ‰‹å‹•ä¸Šå‚³æª”æ¡ˆï¼Œå¥½éº»ç…©<br>\nå› æ­¤ä¾†çœ‹çœ‹æ€éº¼ç”¨ Winscp å¥—ä»¶ä¾†ä¸²æ¥ï¼Œé…åˆå¾ŒçºŒè£½ä½œæˆæ’ç¨‹ç¨‹å¼ï¼Œè‡ªå‹•ä¸Šå‚³</p>\n<h2 id=\"Install\">Install</h2>\n<pre><code class=\"highlight powershell\">dotnet add package WinSCP</code></pre>\n<h2 id=\"Example\">Example</h2>\n<pre><code class=\"highlight C#\"><span class=\"comment\">// é€£ç·šè¨­å®š</span>\nSessionOptions sessionOptions = <span class=\"keyword\">new</span> SessionOptions\n&#123;\n    Protocol = Protocol.Sftp,\n    HostName = <span class=\"string\">&quot;hostname&quot;</span>,\n    PortNumber = port,\n    UserName = <span class=\"string\">&quot;xxxx&quot;</span>,\n    SshHostKeyFingerprint = <span class=\"string\">&quot;ssh-rsa 2048 xxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span>,\n    SshPrivateKeyPath = <span class=\"string\">&quot;....&quot;</span> <span class=\"comment\">// ç§é‘°è·¯å¾‘è‡ªè¡Œèª¿æ•´(é¸ç”¨)</span>\n&#125;;\n\n<span class=\"comment\">// é–‹å•Ÿæœƒè©±</span>\n<span class=\"keyword\">using</span> <span class=\"keyword\">var</span> session = <span class=\"keyword\">new</span> Session();\nsession.Open(sessionOptions);\n\n<span class=\"comment\">// å®šç¾©ä¸Šå‚³çš„æ–‡ä»¶è·¯å¾‘å’Œé ç«¯ç›®éŒ„</span>\n<span class=\"built_in\">string</span> localFilePath = <span class=\"string\">&quot;æ–‡ä»¶è·¯å¾‘&quot;</span>;\n<span class=\"built_in\">string</span> remoteDirectory = <span class=\"string\">&quot;ä¼ºæœå™¨ç›®éŒ„&quot;</span>; <span class=\"comment\">// é ç«¯ä¼ºæœå™¨çš„ç›®éŒ„</span>\n\n<span class=\"comment\">// ä¸Šå‚³æ–‡ä»¶</span>\nTransferOperationResult transferResult;\ntransferResult = <span class=\"keyword\">this</span>.session.PutFiles(localFilePath, remoteDirectory);\n\n<span class=\"comment\">// æª¢æŸ¥ä¸Šå‚³æ˜¯å¦æˆåŠŸ</span>\ntransferResult.Check();</code></pre>\n<h2 id=\"åƒè€ƒè³‡æ–™\">åƒè€ƒè³‡æ–™</h2>\n<p><a href=\"https://winscp.net/eng/docs/library#csharp\">https://winscp.net/eng/docs/library#csharp</a></p>\n","categories":["å¾Œç«¯"],"tags":["C#","Winscp"]},{"title":"categories","url":"/categories/index.html","content":""},{"title":"æ¨™ç±¤","url":"/tags/index.html","content":""}]